<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Code Coverage Report</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #f9f9f9;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            line-height: 1.6;
            color: #333;
        }
        
        h1, h2, h3 {
            color: #2c3e50;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }
        
        .stat {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }
        
        .file-section {
            background: white;
            margin: 1.5rem 0;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .file-header {
            background: #34495e;
            color: white;
            padding: 0.75rem 1rem;
            margin: -1rem -1rem 1rem -1rem;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
        }
        
        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: Consolas, Monaco, 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
            margin: 1rem 0;
        }
        
        code {
            white-space: pre;
        }
        
        .line-number {
            color: #858585;
            margin-right: 1rem;
            user-select: none;
        }
        
        .covered {
            color: #4caf50;
        }
        
        .uncovered {
            color: #f44336;
        }
        
        .legend {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0.5rem 0;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 0.5rem;
            border-radius: 3px;
        }
        
        .footer {
            text-align: center;
            margin-top: 2rem;
            padding: 1rem;
            color: #7f8c8d;
            border-top: 1px solid #ecf0f1;
        }
    </style>
</head>
<body>
    <h1>Code Coverage Report</h1>
    <p>Generated on 2025-07-25 15:00:45</p>
<h1>ðŸ“Š Detailed Coverage Report</h1>
<p>This report shows all uncovered code lines with context, highlighting which lines are covered and which are not.</p>
<div class="stats">

    <div class="stat">
        <div class="stat-number">84.34%</div>
        <div class="stat-label">Total Coverage</div>
    </div>

    <div class="stat">
        <div class="stat-number">2,963</div>
        <div class="stat-label">Total Statements</div>
    </div>

    <div class="stat">
        <div class="stat-number">464</div>
        <div class="stat-label">Missing Statements</div>
    </div>

    <div class="stat">
        <div class="stat-number">10</div>
        <div class="stat-label">Files with Issues</div>
    </div>
</div>
<div class="legend">
<h3>Legend</h3>
<div class="legend-item">
<div class="legend-color" style="background-color: #4caf50;"></div>
<span>Covered lines: Code that was executed during testing</span>
</div>
<div class="legend-item">
<div class="legend-color" style="background-color: #f44336;"></div>
<span>Uncovered lines: Code that was not executed during testing</span>
</div>
<div class="legend-item">
<div class="legend-color" style="background-color: #858585;"></div>
<span>Context lines: Code before and after uncovered lines</span>
</div>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/main.py - 53.61% coverage (52/97 lines)
</div>
<h4>Line 38</h4>
<pre>
<span class="line-number"> 33</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> load_config_from_path(config_path: str) -> dict:
<span class="line-number"> 34</span>    path = <span class="function">Path</span>(config_path)
<span class="line-number"> 35</span>    <span class=<span class="string">"keyword"</span>>if</span> path.is_file():
<span class="line-number"> 36</span>        <span class=<span class="string">"keyword"</span>>with</span> open(path, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:
<span class="line-number"> 37</span>            <span class=<span class="string">"keyword"</span>>return</span> json.load(f)
<span class="line-number"> 38</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>elif</span> path.is_dir():</span>
<span class="line-number"> 39</span>        <span class="comment"># Merge all .json files <span class="keyword">in</span> the folder</span>
<span class="line-number"> 40</span>        config = {}
<span class="line-number"> 41</span>        <span class=<span class="string">"keyword"</span>>for</span> file <span class=<span class="string">"keyword"</span>>in</span> path.glob(<span class="string">"*.json"</span>):
<span class="line-number"> 42</span>            <span class=<span class="string">"keyword"</span>>with</span> open(file, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:
<span class="line-number"> 43</span>                data = json.<span class="function">load</span>(f)
</pre>
<h4>Lines 40-45</h4>
<pre>
<span class="line-number"> 35</span>    <span class=<span class="string">"keyword"</span>>if</span> path.is_file():
<span class="line-number"> 36</span>        <span class=<span class="string">"keyword"</span>>with</span> open(path, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:
<span class="line-number"> 37</span>            <span class=<span class="string">"keyword"</span>>return</span> json.load(f)
<span class="line-number"> 38</span>    <span class=<span class="string">"keyword"</span>>elif</span> path.is_dir():
<span class="line-number"> 39</span>        <span class="comment"># Merge all .json files <span class="keyword">in</span> the folder</span>
<span class="line-number"> 40</span><span class="uncovered">        config = {}</span>
<span class="line-number"> 41</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>for</span> file <span class=<span class="string">"keyword"</span>>in</span> path.glob(<span class="string">"*.json"</span>):</span>
<span class="line-number"> 42</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>with</span> open(file, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:</span>
<span class="line-number"> 43</span><span class="uncovered">                data = json.<span class="function">load</span>(f)</span>
<span class="line-number"> 44</span><span class="uncovered">                config.<span class="function">update</span>(data)</span>
<span class="line-number"> 45</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> config</span>
<span class="line-number"> 46</span>    <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number"> 47</span>        <span class=<span class="string">"keyword"</span>>raise</span> FileNotFoundError(f<span class="string">"Config path <span class="</span>keyword<span class="string">">not</span> found: {config_path}"</span>)
<span class="line-number"> 48</span>
<span class="line-number"> 49</span>
<span class="line-number"> 50</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> main() -> int:
</pre>
<h4>Line 47</h4>
<pre>
<span class="line-number"> 42</span>            <span class=<span class="string">"keyword"</span>>with</span> open(file, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:
<span class="line-number"> 43</span>                data = json.<span class="function">load</span>(f)
<span class="line-number"> 44</span>                config.<span class="function">update</span>(data)
<span class="line-number"> 45</span>        <span class=<span class="string">"keyword"</span>>return</span> config
<span class="line-number"> 46</span>    <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number"> 47</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>raise</span> FileNotFoundError(f<span class="string">"Config path <span class="</span>keyword<span class="string">">not</span> found: {config_path}"</span>)</span>
<span class="line-number"> 48</span>
<span class="line-number"> 49</span>
<span class="line-number"> 50</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> main() -> int:
<span class="line-number"> 51</span>    parser = argparse.<span class="function">ArgumentParser</span>(
<span class="line-number"> 52</span>        description=<span class="string">"C to PlantUML Converter (Simplified CLI)"</span>,
</pre>
<h4>Line 85</h4>
<pre>
<span class="line-number"> 80</span>    <span class="function">setup_logging</span>(args.verbose)
<span class="line-number"> 81</span>
<span class="line-number"> 82</span>    <span class="comment"># Determine config path</span>
<span class="line-number"> 83</span>    config_path = args.config
<span class="line-number"> 84</span>    <span class=<span class="string">"keyword"</span>>if</span> config_path <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number"> 85</span><span class="uncovered">        config_path = os.<span class="function">getcwd</span>()</span>
<span class="line-number"> 86</span>
<span class="line-number"> 87</span>    logging.info(<span class="string">"Using config: %s"</span>, config_path)
<span class="line-number"> 88</span>
<span class="line-number"> 89</span>    <span class="comment"># Load config</span>
<span class="line-number"> 90</span>    <span class=<span class="string">"keyword"</span>>try</span>:
</pre>
<h4>Lines 93-95</h4>
<pre>
<span class="line-number"> 88</span>
<span class="line-number"> 89</span>    <span class="comment"># Load config</span>
<span class="line-number"> 90</span>    <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number"> 91</span>        config_data = <span class="function">load_config_from_path</span>(config_path)
<span class="line-number"> 92</span>        config = <span class="function">Config</span>(**config_data)
<span class="line-number"> 93</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>except</span> Exception <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number"> 94</span><span class="uncovered">        logging.error(<span class="string">"Failed to load configuration: %s"</span>, e)</span>
<span class="line-number"> 95</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> 1</span>
<span class="line-number"> 96</span>
<span class="line-number"> 97</span>    <span class="comment"># Determine output folder <span class="keyword">from</span> config, default to ./output</span>
<span class="line-number"> 98</span>    output_folder = getattr(config, <span class="string">"output_dir"</span>, <span class=<span class="string">"keyword"</span>>None</span>) <span class=<span class="string">"keyword"</span>>or</span> os.path.join(
<span class="line-number"> 99</span>        os.getcwd(), <span class="string">"output"</span>
<span class="line-number">100</span>    )
</pre>
<h4>Lines 110-111</h4>
<pre>
<span class="line-number">105</span>    model_file = os.path.join(output_folder, <span class="string">"model.json"</span>)
<span class="line-number">106</span>    transformed_model_file = os.path.join(output_folder, <span class="string">"model_transformed.json"</span>)
<span class="line-number">107</span>
<span class="line-number">108</span>    <span class="comment"># Parse command</span>
<span class="line-number">109</span>    <span class=<span class="string">"keyword"</span>>if</span> args.command == <span class="string">"parse"</span>:
<span class="line-number">110</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>try</span>:</span>
<span class="line-number">111</span><span class="uncovered">            parser_obj = <span class="function">Parser</span>()</span>
<span class="line-number">112</span>            <span class="comment"># Use the refactored parse function that handles both single <span class="keyword">and</span> multiple source folders</span>
<span class="line-number">113</span>            parser_obj.<span class="function">parse</span>(
<span class="line-number">114</span>                project_root=config.source_folders,
<span class="line-number">115</span>                output_file=model_file,
<span class="line-number">116</span>                recursive_search=getattr(config, <span class="string">"recursive_search"</span>, <span class=<span class="string">"keyword"</span>>True</span>),
</pre>
<h4>Line 113</h4>
<pre>
<span class="line-number">108</span>    <span class="comment"># Parse command</span>
<span class="line-number">109</span>    <span class=<span class="string">"keyword"</span>>if</span> args.command == <span class="string">"parse"</span>:
<span class="line-number">110</span>        <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">111</span>            parser_obj = <span class="function">Parser</span>()
<span class="line-number">112</span>            <span class="comment"># Use the refactored parse function that handles both single <span class="keyword">and</span> multiple source folders</span>
<span class="line-number">113</span><span class="uncovered">            parser_obj.<span class="function">parse</span>(</span>
<span class="line-number">114</span>                project_root=config.source_folders,
<span class="line-number">115</span>                output_file=model_file,
<span class="line-number">116</span>                recursive_search=getattr(config, <span class="string">"recursive_search"</span>, <span class=<span class="string">"keyword"</span>>True</span>),
<span class="line-number">117</span>                config=config,
<span class="line-number">118</span>            )
</pre>
<h4>Lines 119-123</h4>
<pre>
<span class="line-number">114</span>                project_root=config.source_folders,
<span class="line-number">115</span>                output_file=model_file,
<span class="line-number">116</span>                recursive_search=getattr(config, <span class="string">"recursive_search"</span>, <span class=<span class="string">"keyword"</span>>True</span>),
<span class="line-number">117</span>                config=config,
<span class="line-number">118</span>            )
<span class="line-number">119</span><span class="uncovered">            logging.info(<span class="string">"Model saved to: %s"</span>, model_file)</span>
<span class="line-number">120</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> 0</span>
<span class="line-number">121</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>except</span> (OSError, ValueError, RuntimeError) <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">122</span><span class="uncovered">            logging.error(<span class="string">"Error during parsing: %s"</span>, e)</span>
<span class="line-number">123</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> 1</span>
<span class="line-number">124</span>
<span class="line-number">125</span>    <span class="comment"># Transform command</span>
<span class="line-number">126</span>    <span class=<span class="string">"keyword"</span>>if</span> args.command == <span class="string">"transform"</span>:
<span class="line-number">127</span>        <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">128</span>            transformer = <span class="function">Transformer</span>()
</pre>
<h4>Lines 127-129</h4>
<pre>
<span class="line-number">122</span>            logging.error(<span class="string">"Error during parsing: %s"</span>, e)
<span class="line-number">123</span>            <span class=<span class="string">"keyword"</span>>return</span> 1
<span class="line-number">124</span>
<span class="line-number">125</span>    <span class="comment"># Transform command</span>
<span class="line-number">126</span>    <span class=<span class="string">"keyword"</span>>if</span> args.command == <span class="string">"transform"</span>:
<span class="line-number">127</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>try</span>:</span>
<span class="line-number">128</span><span class="uncovered">            transformer = <span class="function">Transformer</span>()</span>
<span class="line-number">129</span><span class="uncovered">            transformer.<span class="function">transform</span>(</span>
<span class="line-number">130</span>                model_file=model_file,
<span class="line-number">131</span>                config_file=(
<span class="line-number">132</span>                    config_path
<span class="line-number">133</span>                    <span class=<span class="string">"keyword"</span>>if</span> Path(config_path).is_file()
<span class="line-number">134</span>                    <span class=<span class="string">"keyword"</span>>else</span> str(list(Path(config_path).glob(<span class="string">"*.json"</span>))[0])
</pre>
<h4>Lines 138-142</h4>
<pre>
<span class="line-number">133</span>                    <span class=<span class="string">"keyword"</span>>if</span> Path(config_path).is_file()
<span class="line-number">134</span>                    <span class=<span class="string">"keyword"</span>>else</span> str(list(Path(config_path).glob(<span class="string">"*.json"</span>))[0])
<span class="line-number">135</span>                ),
<span class="line-number">136</span>                output_file=transformed_model_file,
<span class="line-number">137</span>            )
<span class="line-number">138</span><span class="uncovered">            logging.info(<span class="string">"Transformed model saved to: %s"</span>, transformed_model_file)</span>
<span class="line-number">139</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> 0</span>
<span class="line-number">140</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>except</span> (OSError, ValueError, RuntimeError) <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">141</span><span class="uncovered">            logging.error(<span class="string">"Error during transformation: %s"</span>, e)</span>
<span class="line-number">142</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> 1</span>
<span class="line-number">143</span>
<span class="line-number">144</span>    <span class="comment"># Generate command</span>
<span class="line-number">145</span>    <span class=<span class="string">"keyword"</span>>if</span> args.command == <span class="string">"generate"</span>:
<span class="line-number">146</span>        <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">147</span>            generator = <span class="function">Generator</span>()
</pre>
<h4>Lines 146-147</h4>
<pre>
<span class="line-number">141</span>            logging.error(<span class="string">"Error during transformation: %s"</span>, e)
<span class="line-number">142</span>            <span class=<span class="string">"keyword"</span>>return</span> 1
<span class="line-number">143</span>
<span class="line-number">144</span>    <span class="comment"># Generate command</span>
<span class="line-number">145</span>    <span class=<span class="string">"keyword"</span>>if</span> args.command == <span class="string">"generate"</span>:
<span class="line-number">146</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>try</span>:</span>
<span class="line-number">147</span><span class="uncovered">            generator = <span class="function">Generator</span>()</span>
<span class="line-number">148</span>            <span class="comment"># Prefer transformed model, <span class="keyword">else</span> fallback to model.json</span>
<span class="line-number">149</span>            <span class=<span class="string">"keyword"</span>>if</span> os.path.exists(transformed_model_file):
<span class="line-number">150</span>                model_to_use = transformed_model_file
<span class="line-number">151</span>            <span class=<span class="string">"keyword"</span>>elif</span> os.path.exists(model_file):
<span class="line-number">152</span>                model_to_use = model_file
</pre>
<h4>Lines 149-152</h4>
<pre>
<span class="line-number">144</span>    <span class="comment"># Generate command</span>
<span class="line-number">145</span>    <span class=<span class="string">"keyword"</span>>if</span> args.command == <span class="string">"generate"</span>:
<span class="line-number">146</span>        <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">147</span>            generator = <span class="function">Generator</span>()
<span class="line-number">148</span>            <span class="comment"># Prefer transformed model, <span class="keyword">else</span> fallback to model.json</span>
<span class="line-number">149</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> os.path.exists(transformed_model_file):</span>
<span class="line-number">150</span><span class="uncovered">                model_to_use = transformed_model_file</span>
<span class="line-number">151</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>elif</span> os.path.exists(model_file):</span>
<span class="line-number">152</span><span class="uncovered">                model_to_use = model_file</span>
<span class="line-number">153</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">154</span>                logging.error(<span class="string">"No model file found <span class="</span>keyword<span class="string">">for</span> generation."</span>)
<span class="line-number">155</span>                <span class=<span class="string">"keyword"</span>>return</span> 1
<span class="line-number">156</span>            generator.<span class="function">generate</span>(
<span class="line-number">157</span>                model_file=model_to_use,
</pre>
<h4>Lines 154-156</h4>
<pre>
<span class="line-number">149</span>            <span class=<span class="string">"keyword"</span>>if</span> os.path.exists(transformed_model_file):
<span class="line-number">150</span>                model_to_use = transformed_model_file
<span class="line-number">151</span>            <span class=<span class="string">"keyword"</span>>elif</span> os.path.exists(model_file):
<span class="line-number">152</span>                model_to_use = model_file
<span class="line-number">153</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">154</span><span class="uncovered">                logging.error(<span class="string">"No model file found <span class="</span>keyword<span class="string">">for</span> generation."</span>)</span>
<span class="line-number">155</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> 1</span>
<span class="line-number">156</span><span class="uncovered">            generator.<span class="function">generate</span>(</span>
<span class="line-number">157</span>                model_file=model_to_use,
<span class="line-number">158</span>                output_dir=output_folder,
<span class="line-number">159</span>                include_depth=getattr(config, <span class="string">"include_depth"</span>, 1),
<span class="line-number">160</span>            )
<span class="line-number">161</span>            logging.info(<span class="string">"PlantUML generation complete! Output <span class="</span>keyword<span class="string">">in</span>: %s"</span>, output_folder)
</pre>
<h4>Lines 161-165</h4>
<pre>
<span class="line-number">156</span>            generator.<span class="function">generate</span>(
<span class="line-number">157</span>                model_file=model_to_use,
<span class="line-number">158</span>                output_dir=output_folder,
<span class="line-number">159</span>                include_depth=getattr(config, <span class="string">"include_depth"</span>, 1),
<span class="line-number">160</span>            )
<span class="line-number">161</span><span class="uncovered">            logging.info(<span class="string">"PlantUML generation complete! Output <span class="</span>keyword<span class="string">">in</span>: %s"</span>, output_folder)</span>
<span class="line-number">162</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> 0</span>
<span class="line-number">163</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>except</span> (OSError, ValueError, RuntimeError) <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">164</span><span class="uncovered">            logging.error(<span class="string">"Error generating PlantUML: %s"</span>, e)</span>
<span class="line-number">165</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> 1</span>
<span class="line-number">166</span>
<span class="line-number">167</span>    <span class="comment"># Default: full workflow</span>
<span class="line-number">168</span>    <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">169</span>        <span class="comment"># Step 1: Parse</span>
<span class="line-number">170</span>        parser_obj = <span class="function">Parser</span>()
</pre>
<h4>Lines 201-203</h4>
<pre>
<span class="line-number">196</span>            include_depth=getattr(config, <span class="string">"include_depth"</span>, 1),
<span class="line-number">197</span>        )
<span class="line-number">198</span>        logging.info(<span class="string">"PlantUML generation complete! Output <span class="</span>keyword<span class="string">">in</span>: %s"</span>, output_folder)
<span class="line-number">199</span>        logging.info(<span class="string">"Complete workflow finished successfully!"</span>)
<span class="line-number">200</span>        <span class=<span class="string">"keyword"</span>>return</span> 0
<span class="line-number">201</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>except</span> (OSError, ValueError, RuntimeError) <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">202</span><span class="uncovered">        logging.error(<span class="string">"Error <span class="</span>keyword<span class="string">">in</span> workflow: %s"</span>, e)</span>
<span class="line-number">203</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> 1</span>
<span class="line-number">204</span>
<span class="line-number">205</span>
<span class="line-number">206</span><span class=<span class="string">"keyword"</span>>if</span> __name__ == <span class="string">"__main__"</span>:
<span class="line-number">207</span>    sys.<span class="function">exit</span>(<span class="function">main</span>())
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/parser.py - 87.39% coverage (617/706 lines)
</div>
<h4>Lines 21-22</h4>
<pre>
<span class="line-number"> 16</span>)
<span class="line-number"> 17</span><span class=<span class="string">"keyword"</span>>from</span> .preprocessor <span class=<span class="string">"keyword"</span>>import</span> PreprocessorManager
<span class="line-number"> 18</span><span class=<span class="string">"keyword"</span>>from</span> .utils <span class=<span class="string">"keyword"</span>>import</span> detect_file_encoding
<span class="line-number"> 19</span>
<span class="line-number"> 20</span><span class=<span class="string">"keyword"</span>>if</span> TYPE_CHECKING:
<span class="line-number"> 21</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>from</span> .models <span class=<span class="string">"keyword"</span>>import</span> Struct, Enum, Union, Function, Field, Alias</span>
<span class="line-number"> 22</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>from</span> .config <span class=<span class="string">"keyword"</span>>import</span> Config</span>
<span class="line-number"> 23</span>
<span class="line-number"> 24</span>
<span class="line-number"> 25</span><span class=<span class="string">"keyword"</span>>class</span> CParser:
<span class="line-number"> 26</span>    <span class="string">""</span><span class="string">"C/C++ parser <span class="</span>keyword<span class="string">">for</span> extracting structural information <span class="</span>keyword<span class="string">">from</span> source code using tokenization"</span><span class="string">""</span>
<span class="line-number"> 27</span>
</pre>
<h4>Line 45</h4>
<pre>
<span class="line-number"> 40</span>
<span class="line-number"> 41</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> project_root.exists():
<span class="line-number"> 42</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(f<span class="string">"Project root <span class="</span>keyword<span class="string">">not</span> found: {project_root}"</span>)
<span class="line-number"> 43</span>
<span class="line-number"> 44</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> project_root.is_dir():
<span class="line-number"> 45</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(f<span class="string">"Project root must be a directory: {project_root}"</span>)</span>
<span class="line-number"> 46</span>
<span class="line-number"> 47</span>        <span class="comment"># Clear the failed includes cache <span class="keyword">for</span> this new project</span>
<span class="line-number"> 48</span>        cache_size_before = <span class="function">len</span>(self._failed_includes_cache)
<span class="line-number"> 49</span>        self._failed_includes_cache.<span class="function">clear</span>()
<span class="line-number"> 50</span>        <span class=<span class="string">"keyword"</span>>if</span> cache_size_before > 0:
</pre>
<h4>Line 51</h4>
<pre>
<span class="line-number"> 46</span>
<span class="line-number"> 47</span>        <span class="comment"># Clear the failed includes cache <span class="keyword">for</span> this new project</span>
<span class="line-number"> 48</span>        cache_size_before = <span class="function">len</span>(self._failed_includes_cache)
<span class="line-number"> 49</span>        self._failed_includes_cache.<span class="function">clear</span>()
<span class="line-number"> 50</span>        <span class=<span class="string">"keyword"</span>>if</span> cache_size_before > 0:
<span class="line-number"> 51</span><span class="uncovered">            self.logger.<span class="function">debug</span>(</span>
<span class="line-number"> 52</span>                <span class="string">"Cleared failed includes cache (%d entries)"</span>, cache_size_before
<span class="line-number"> 53</span>            )
<span class="line-number"> 54</span>
<span class="line-number"> 55</span>        self.logger.info(<span class="string">"Parsing project: %s"</span>, project_root)
<span class="line-number"> 56</span>
</pre>
<h4>Lines 82-84</h4>
<pre>
<span class="line-number"> 77</span>                )
<span class="line-number"> 78</span>                files[relative_path] = file_model
<span class="line-number"> 79</span>
<span class="line-number"> 80</span>                self.logger.debug(<span class="string">"Successfully parsed: %s"</span>, relative_path)
<span class="line-number"> 81</span>
<span class="line-number"> 82</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>except</span> (OSError, ValueError) <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number"> 83</span><span class="uncovered">                self.logger.warning(<span class="string">"Failed to parse %s: %s"</span>, file_path, e)</span>
<span class="line-number"> 84</span><span class="uncovered">                failed_files.<span class="function">append</span>(<span class="function">str</span>(file_path))</span>
<span class="line-number"> 85</span>
<span class="line-number"> 86</span>        <span class=<span class="string">"keyword"</span>>if</span> failed_files:
<span class="line-number"> 87</span>            error_msg = (
<span class="line-number"> 88</span>                f<span class="string">"Failed to parse {len(failed_files)} files: {failed_files}. "</span>
<span class="line-number"> 89</span>                <span class="string">"Stopping model processing."</span>
</pre>
<h4>Line 87</h4>
<pre>
<span class="line-number"> 82</span>            <span class=<span class="string">"keyword"</span>>except</span> (OSError, ValueError) <span class=<span class="string">"keyword"</span>>as</span> e:
<span class="line-number"> 83</span>                self.logger.warning(<span class="string">"Failed to parse %s: %s"</span>, file_path, e)
<span class="line-number"> 84</span>                failed_files.<span class="function">append</span>(<span class="function">str</span>(file_path))
<span class="line-number"> 85</span>
<span class="line-number"> 86</span>        <span class=<span class="string">"keyword"</span>>if</span> failed_files:
<span class="line-number"> 87</span><span class="uncovered">            error_msg = (</span>
<span class="line-number"> 88</span>                f<span class="string">"Failed to parse {len(failed_files)} files: {failed_files}. "</span>
<span class="line-number"> 89</span>                <span class="string">"Stopping model processing."</span>
<span class="line-number"> 90</span>            )
<span class="line-number"> 91</span>            self.logger.<span class="function">error</span>(error_msg)
<span class="line-number"> 92</span>            <span class=<span class="string">"keyword"</span>>raise</span> RuntimeError(error_msg)
</pre>
<h4>Lines 91-92</h4>
<pre>
<span class="line-number"> 86</span>        <span class=<span class="string">"keyword"</span>>if</span> failed_files:
<span class="line-number"> 87</span>            error_msg = (
<span class="line-number"> 88</span>                f<span class="string">"Failed to parse {len(failed_files)} files: {failed_files}. "</span>
<span class="line-number"> 89</span>                <span class="string">"Stopping model processing."</span>
<span class="line-number"> 90</span>            )
<span class="line-number"> 91</span><span class="uncovered">            self.logger.<span class="function">error</span>(error_msg)</span>
<span class="line-number"> 92</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> RuntimeError(error_msg)</span>
<span class="line-number"> 93</span>
<span class="line-number"> 94</span>        model = <span class="function">ProjectModel</span>(
<span class="line-number"> 95</span>            project_name=project_root.name,
<span class="line-number"> 96</span>            project_root=<span class="function">str</span>(project_root),
<span class="line-number"> 97</span>            files=files,
</pre>
<h4>Lines 206-207</h4>
<pre>
<span class="line-number">201</span>                <span class="comment"># Convert to Field objects</span>
<span class="line-number">202</span>                fields = []
<span class="line-number">203</span>                <span class=<span class="string">"keyword"</span>>for</span> field_name, field_type <span class=<span class="string">"keyword"</span>>in</span> field_tuples:
<span class="line-number">204</span>                    <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">205</span>                        fields.<span class="function">append</span>(<span class="function">Field</span>(field_name, field_type))
<span class="line-number">206</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>except</span> ValueError <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">207</span><span class="uncovered">                        self.logger.<span class="function">warning</span>(</span>
<span class="line-number">208</span>                            <span class="string">"Error creating field %s: %s"</span>, field_name, e
<span class="line-number">209</span>                        )
<span class="line-number">210</span>
<span class="line-number">211</span>                <span class="comment"># For anonymous structs, use a special key that can be mapped later</span>
<span class="line-number">212</span>                <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> struct_name:
</pre>
<h4>Lines 306-307</h4>
<pre>
<span class="line-number">301</span>                <span class="comment"># Convert to Field objects</span>
<span class="line-number">302</span>                fields = []
<span class="line-number">303</span>                <span class=<span class="string">"keyword"</span>>for</span> field_name, field_type <span class=<span class="string">"keyword"</span>>in</span> field_tuples:
<span class="line-number">304</span>                    <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">305</span>                        fields.<span class="function">append</span>(<span class="function">Field</span>(field_name, field_type))
<span class="line-number">306</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>except</span> ValueError <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">307</span><span class="uncovered">                        self.logger.<span class="function">warning</span>(</span>
<span class="line-number">308</span>                            <span class="string">"Error creating union field %s: %s"</span>, field_name, e
<span class="line-number">309</span>                        )
<span class="line-number">310</span>
<span class="line-number">311</span>                <span class="comment"># For anonymous unions, use a special key that can be mapped later</span>
<span class="line-number">312</span>                <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> union_name:
</pre>
<h4>Line 313</h4>
<pre>
<span class="line-number">308</span>                            <span class="string">"Error creating union field %s: %s"</span>, field_name, e
<span class="line-number">309</span>                        )
<span class="line-number">310</span>
<span class="line-number">311</span>                <span class="comment"># For anonymous unions, use a special key that can be mapped later</span>
<span class="line-number">312</span>                <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> union_name:
<span class="line-number">313</span><span class="uncovered">                    union_name = <span class="string">"__anonymous_union__"</span></span>
<span class="line-number">314</span>
<span class="line-number">315</span>                <span class="comment"># Extract tag name <span class="keyword">if</span> this <span class="keyword">is</span> a typedef union</span>
<span class="line-number">316</span>                tag_name = <span class="string">""</span>
<span class="line-number">317</span>                <span class=<span class="string">"keyword"</span>>if</span> union_name <span class=<span class="string">"keyword"</span>>and</span> <span class=<span class="string">"keyword"</span>>not</span> union_name.startswith(<span class="string">"__anonymous"</span>):
<span class="line-number">318</span>                    <span class="comment"># Check <span class="keyword">if</span> this union has a typedef</span>
</pre>
<h4>Lines 370-371</h4>
<pre>
<span class="line-number">365</span>                function.is_declaration = is_declaration
<span class="line-number">366</span>                functions.<span class="function">append</span>(function)
<span class="line-number">367</span>                self.logger.<span class="function">debug</span>(
<span class="line-number">368</span>                    f<span class="string">"Parsed function: {func_name} <span class="</span>keyword<span class="string">">with</span> {len(parameters)} parameters (declaration: {is_declaration})"</span>
<span class="line-number">369</span>                )
<span class="line-number">370</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>except</span> Exception <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">371</span><span class="uncovered">                self.logger.warning(<span class="string">"Error creating function %s: %s"</span>, func_name, e)</span>
<span class="line-number">372</span>
<span class="line-number">373</span>        <span class=<span class="string">"keyword"</span>>return</span> functions
<span class="line-number">374</span>
<span class="line-number">375</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_globals_with_tokenizer(self, tokens) -> List[<span class="string">"Field"</span>]:
<span class="line-number">376</span>        <span class="string">""</span><span class="string">"Parse <span class="</span>keyword<span class="string">">global</span> variables using tokenizer"</span><span class="string">""</span>
</pre>
<h4>Lines 396-397</h4>
<pre>
<span class="line-number">391</span>                i += <span class="number">1</span>
<span class="line-number">392</span>                <span class=<span class="string">"keyword"</span>>continue</span>
<span class="line-number">393</span>
<span class="line-number">394</span>            <span class="comment"># Skip preprocessor directives but keep their content</span>
<span class="line-number">395</span>            <span class=<span class="string">"keyword"</span>>if</span> tokens[i].type == TokenType.PREPROCESSOR:
<span class="line-number">396</span><span class="uncovered">                i = self.<span class="function">_skip_preprocessor_directives</span>(tokens, i)</span>
<span class="line-number">397</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>continue</span></span>
<span class="line-number">398</span>
<span class="line-number">399</span>            <span class="comment"># Skip function definitions (look <span class="keyword">for</span> parentheses)</span>
<span class="line-number">400</span>            <span class=<span class="string">"keyword"</span>>if</span> self._looks_like_function(tokens, i):
<span class="line-number">401</span>                i = self.<span class="function">_skip_function</span>(tokens, i)
<span class="line-number">402</span>                <span class=<span class="string">"keyword"</span>>continue</span>
</pre>
<h4>Lines 417-426</h4>
<pre>
<span class="line-number">412</span>                <span class=<span class="string">"keyword"</span>>continue</span>
<span class="line-number">413</span>
<span class="line-number">414</span>            <span class="comment"># Skip <span class="keyword">if</span> we're inside a struct definition (look <span class="keyword">for</span> opening brace)</span>
<span class="line-number">415</span>            <span class=<span class="string">"keyword"</span>>if</span> i > 0 <span class=<span class="string">"keyword"</span>>and</span> tokens[i - 1].type == TokenType.LBRACE:
<span class="line-number">416</span>                <span class="comment"># We're inside a struct, skip until closing brace</span>
<span class="line-number">417</span><span class="uncovered">                brace_count = <span class="number">1</span></span>
<span class="line-number">418</span><span class="uncovered">                j = i</span>
<span class="line-number">419</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>while</span> j < len(tokens) <span class=<span class="string">"keyword"</span>>and</span> brace_count > 0:</span>
<span class="line-number">420</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>if</span> tokens[j].type == TokenType.LBRACE:</span>
<span class="line-number">421</span><span class="uncovered">                        brace_count += <span class="number">1</span></span>
<span class="line-number">422</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>elif</span> tokens[j].type == TokenType.RBRACE:</span>
<span class="line-number">423</span><span class="uncovered">                        brace_count -= <span class="number">1</span></span>
<span class="line-number">424</span><span class="uncovered">                    j += <span class="number">1</span></span>
<span class="line-number">425</span><span class="uncovered">                i = j</span>
<span class="line-number">426</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>continue</span></span>
<span class="line-number">427</span>
<span class="line-number">428</span>            <span class="comment"># Skip macros <span class="keyword">and</span> other preprocessor content</span>
<span class="line-number">429</span>            <span class=<span class="string">"keyword"</span>>if</span> tokens[i].type == TokenType.DEFINE:
<span class="line-number">430</span>                <span class="comment"># Skip the entire macro content (multi-line macros are now merged)</span>
<span class="line-number">431</span>                i += <span class="number">1</span>
</pre>
<h4>Lines 431-432</h4>
<pre>
<span class="line-number">426</span>                <span class=<span class="string">"keyword"</span>>continue</span>
<span class="line-number">427</span>
<span class="line-number">428</span>            <span class="comment"># Skip macros <span class="keyword">and</span> other preprocessor content</span>
<span class="line-number">429</span>            <span class=<span class="string">"keyword"</span>>if</span> tokens[i].type == TokenType.DEFINE:
<span class="line-number">430</span>                <span class="comment"># Skip the entire macro content (multi-line macros are now merged)</span>
<span class="line-number">431</span><span class="uncovered">                i += <span class="number">1</span></span>
<span class="line-number">432</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>continue</span></span>
<span class="line-number">433</span>
<span class="line-number">434</span>            <span class="comment"># Additional check: skip <span class="keyword">if</span> we're inside any brace block (struct, function, etc.)</span>
<span class="line-number">435</span>            brace_count = <span class="number">0</span>
<span class="line-number">436</span>            j = i - <span class="number">1</span>
<span class="line-number">437</span>            <span class=<span class="string">"keyword"</span>>while</span> j >= 0:
</pre>
<h4>Lines 480-481</h4>
<pre>
<span class="line-number">475</span>                                    )
<span class="line-number">476</span>                                )
<span class="line-number">477</span>                                self.logger.<span class="function">debug</span>(
<span class="line-number">478</span>                                    f<span class="string">"Parsed <span class="</span>keyword<span class="string">">global</span>: {stripped_name} : {stripped_type}"</span>
<span class="line-number">479</span>                                )
<span class="line-number">480</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>except</span> Exception <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">481</span><span class="uncovered">                            self.logger.<span class="function">warning</span>(</span>
<span class="line-number">482</span>                                f<span class="string">"Error creating <span class="</span>keyword<span class="string">">global</span> field {var_name}: {e}"</span>
<span class="line-number">483</span>                            )
<span class="line-number">484</span>                    i = self.<span class="function">_skip_to_semicolon</span>(tokens, i)
<span class="line-number">485</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">486</span>                    i += <span class="number">1</span>
</pre>
<h4>Line 609</h4>
<pre>
<span class="line-number">604</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _extract_non_primitive_types(
<span class="line-number">605</span>        self, type_str: str, available_types: Set[str]
<span class="line-number">606</span>    ) -> List[str]:
<span class="line-number">607</span>        <span class="string">""</span><span class="string">"Extract non-primitive type names <span class="</span>keyword<span class="string">">from</span> a type string that exist <span class="</span>keyword<span class="string">">in</span> available_types"</span><span class="string">""</span>
<span class="line-number">608</span>        <span class="comment"># Define primitive types</span>
<span class="line-number">609</span><span class="uncovered">        primitive_types = {</span>
<span class="line-number">610</span>            <span class="string">"void"</span>,
<span class="line-number">611</span>            <span class="string">"char"</span>,
<span class="line-number">612</span>            <span class="string">"short"</span>,
<span class="line-number">613</span>            <span class="string">"int"</span>,
<span class="line-number">614</span>            <span class="string">"long"</span>,
</pre>
<h4>Line 647</h4>
<pre>
<span class="line-number">642</span>            <span class="string">"NULL"</span>,
<span class="line-number">643</span>            <span class="string">"nullptr"</span>,
<span class="line-number">644</span>        }
<span class="line-number">645</span>
<span class="line-number">646</span>        <span class="comment"># Remove common C keywords <span class="keyword">and</span> operators</span>
<span class="line-number">647</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>import</span> re</span>
<span class="line-number">648</span>
<span class="line-number">649</span>        <span class="comment"># Split by common delimiters <span class="keyword">and</span> operators</span>
<span class="line-number">650</span>        parts = re.split(r<span class="string">"[\[\]\(\)\{\}\s\*&,;]"</span>, type_str)
<span class="line-number">651</span>
<span class="line-number">652</span>        <span class="comment"># Extract potential type names that exist <span class="keyword">in</span> available_types</span>
</pre>
<h4>Line 650</h4>
<pre>
<span class="line-number">645</span>
<span class="line-number">646</span>        <span class="comment"># Remove common C keywords <span class="keyword">and</span> operators</span>
<span class="line-number">647</span>        <span class=<span class="string">"keyword"</span>>import</span> re
<span class="line-number">648</span>
<span class="line-number">649</span>        <span class="comment"># Split by common delimiters <span class="keyword">and</span> operators</span>
<span class="line-number">650</span><span class="uncovered">        parts = re.split(r<span class="string">"[\[\]\(\)\{\}\s\*&,;]"</span>, type_str)</span>
<span class="line-number">651</span>
<span class="line-number">652</span>        <span class="comment"># Extract potential type names that exist <span class="keyword">in</span> available_types</span>
<span class="line-number">653</span>        types = []
<span class="line-number">654</span>        <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> parts:
<span class="line-number">655</span>            part = part.<span class="function">strip</span>()
</pre>
<h4>Lines 653-656</h4>
<pre>
<span class="line-number">648</span>
<span class="line-number">649</span>        <span class="comment"># Split by common delimiters <span class="keyword">and</span> operators</span>
<span class="line-number">650</span>        parts = re.split(r<span class="string">"[\[\]\(\)\{\}\s\*&,;]"</span>, type_str)
<span class="line-number">651</span>
<span class="line-number">652</span>        <span class="comment"># Extract potential type names that exist <span class="keyword">in</span> available_types</span>
<span class="line-number">653</span><span class="uncovered">        types = []</span>
<span class="line-number">654</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> parts:</span>
<span class="line-number">655</span><span class="uncovered">            part = part.<span class="function">strip</span>()</span>
<span class="line-number">656</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> part <span class=<span class="string">"keyword"</span>>and</span> len(part) > 1 <span class=<span class="string">"keyword"</span>>and</span> part <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> primitive_types:</span>
<span class="line-number">657</span>                <span class="comment"># Check <span class="keyword">if</span> it looks like a type name (starts <span class="keyword">with</span> letter, contains letters/numbers/underscores)</span>
<span class="line-number">658</span>                <span class=<span class="string">"keyword"</span>>if</span> re.match(r<span class="string">"^[a-zA-Z_][a-zA-Z0-9_]*$"</span>, part):
<span class="line-number">659</span>                    <span class="comment"># Only include <span class="keyword">if</span> it exists <span class="keyword">in</span> available_types</span>
<span class="line-number">660</span>                    <span class=<span class="string">"keyword"</span>>if</span> part <span class=<span class="string">"keyword"</span>>in</span> available_types:
<span class="line-number">661</span>                        types.<span class="function">append</span>(part)
</pre>
<h4>Line 658</h4>
<pre>
<span class="line-number">653</span>        types = []
<span class="line-number">654</span>        <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> parts:
<span class="line-number">655</span>            part = part.<span class="function">strip</span>()
<span class="line-number">656</span>            <span class=<span class="string">"keyword"</span>>if</span> part <span class=<span class="string">"keyword"</span>>and</span> len(part) > 1 <span class=<span class="string">"keyword"</span>>and</span> part <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> primitive_types:
<span class="line-number">657</span>                <span class="comment"># Check <span class="keyword">if</span> it looks like a type name (starts <span class="keyword">with</span> letter, contains letters/numbers/underscores)</span>
<span class="line-number">658</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>if</span> re.match(r<span class="string">"^[a-zA-Z_][a-zA-Z0-9_]*$"</span>, part):</span>
<span class="line-number">659</span>                    <span class="comment"># Only include <span class="keyword">if</span> it exists <span class="keyword">in</span> available_types</span>
<span class="line-number">660</span>                    <span class=<span class="string">"keyword"</span>>if</span> part <span class=<span class="string">"keyword"</span>>in</span> available_types:
<span class="line-number">661</span>                        types.<span class="function">append</span>(part)
<span class="line-number">662</span>
<span class="line-number">663</span>        <span class="keyword">return</span> list(set(types))  <span class="comment"># Remove duplicates</span>
</pre>
<h4>Lines 660-661</h4>
<pre>
<span class="line-number">655</span>            part = part.<span class="function">strip</span>()
<span class="line-number">656</span>            <span class=<span class="string">"keyword"</span>>if</span> part <span class=<span class="string">"keyword"</span>>and</span> len(part) > 1 <span class=<span class="string">"keyword"</span>>and</span> part <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> primitive_types:
<span class="line-number">657</span>                <span class="comment"># Check <span class="keyword">if</span> it looks like a type name (starts <span class="keyword">with</span> letter, contains letters/numbers/underscores)</span>
<span class="line-number">658</span>                <span class=<span class="string">"keyword"</span>>if</span> re.match(r<span class="string">"^[a-zA-Z_][a-zA-Z0-9_]*$"</span>, part):
<span class="line-number">659</span>                    <span class="comment"># Only include <span class="keyword">if</span> it exists <span class="keyword">in</span> available_types</span>
<span class="line-number">660</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>if</span> part <span class=<span class="string">"keyword"</span>>in</span> available_types:</span>
<span class="line-number">661</span><span class="uncovered">                        types.<span class="function">append</span>(part)</span>
<span class="line-number">662</span>
<span class="line-number">663</span>        <span class="keyword">return</span> list(set(types))  <span class="comment"># Remove duplicates</span>
<span class="line-number">664</span>
<span class="line-number">665</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _find_c_files(self, project_root: Path, recursive_search: bool) -> List[Path]:
<span class="line-number">666</span>        <span class="string">""</span><span class="string">"Find all C/C++ files <span class="</span>keyword<span class="string">">in</span> the project"</span><span class="string">""</span>
</pre>
<h4>Line 663</h4>
<pre>
<span class="line-number">658</span>                <span class=<span class="string">"keyword"</span>>if</span> re.match(r<span class="string">"^[a-zA-Z_][a-zA-Z0-9_]*$"</span>, part):
<span class="line-number">659</span>                    <span class="comment"># Only include <span class="keyword">if</span> it exists <span class="keyword">in</span> available_types</span>
<span class="line-number">660</span>                    <span class=<span class="string">"keyword"</span>>if</span> part <span class=<span class="string">"keyword"</span>>in</span> available_types:
<span class="line-number">661</span>                        types.<span class="function">append</span>(part)
<span class="line-number">662</span>
<span class="line-number">663</span><span class="uncovered">        <span class="keyword">return</span> list(set(types))  <span class="comment"># Remove duplicates</span></span>
<span class="line-number">664</span>
<span class="line-number">665</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _find_c_files(self, project_root: Path, recursive_search: bool) -> List[Path]:
<span class="line-number">666</span>        <span class="string">""</span><span class="string">"Find all C/C++ files <span class="</span>keyword<span class="string">">in</span> the project"</span><span class="string">""</span>
<span class="line-number">667</span>        c_extensions = {<span class="string">".c"</span>, <span class="string">".h"</span>, <span class="string">".cpp"</span>, <span class="string">".cc"</span>, <span class="string">".cxx"</span>, <span class="string">".hpp"</span>, <span class="string">".hxx"</span>}
<span class="line-number">668</span>        files = []
</pre>
<h4>Lines 676-677</h4>
<pre>
<span class="line-number">671</span>
<span class="line-number">672</span>        <span class=<span class="string">"keyword"</span>>if</span> recursive_search:
<span class="line-number">673</span>            <span class=<span class="string">"keyword"</span>>for</span> ext <span class=<span class="string">"keyword"</span>>in</span> c_extensions:
<span class="line-number">674</span>                files.extend(project_root.rglob(f<span class="string">"*{ext}"</span>))
<span class="line-number">675</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">676</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>for</span> ext <span class=<span class="string">"keyword"</span>>in</span> c_extensions:</span>
<span class="line-number">677</span><span class="uncovered">                files.extend(project_root.glob(f<span class="string">"*{ext}"</span>))</span>
<span class="line-number">678</span>
<span class="line-number">679</span>        <span class="comment"># Filter out hidden files <span class="keyword">and</span> common exclude patterns</span>
<span class="line-number">680</span>        filtered_files = []
<span class="line-number">681</span>        exclude_patterns = {<span class="string">".git"</span>, <span class="string">"__pycache__"</span>, <span class="string">"node_modules"</span>, <span class="string">".vscode"</span>, <span class="string">".idea"</span>}
<span class="line-number">682</span>
</pre>
<h4>Line 686</h4>
<pre>
<span class="line-number">681</span>        exclude_patterns = {<span class="string">".git"</span>, <span class="string">"__pycache__"</span>, <span class="string">"node_modules"</span>, <span class="string">".vscode"</span>, <span class="string">".idea"</span>}
<span class="line-number">682</span>
<span class="line-number">683</span>        <span class=<span class="string">"keyword"</span>>for</span> file_path <span class=<span class="string">"keyword"</span>>in</span> files:
<span class="line-number">684</span>            <span class="comment"># Skip hidden files <span class="keyword">and</span> directories</span>
<span class="line-number">685</span>            <span class=<span class="string">"keyword"</span>>if</span> any(part.startswith(<span class="string">"."</span>) <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> file_path.parts):
<span class="line-number">686</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>continue</span></span>
<span class="line-number">687</span>
<span class="line-number">688</span>            <span class="comment"># Skip common exclude patterns</span>
<span class="line-number">689</span>            <span class=<span class="string">"keyword"</span>>if</span> any(pattern <span class=<span class="string">"keyword"</span>>in</span> file_path.parts <span class=<span class="string">"keyword"</span>>for</span> pattern <span class=<span class="string">"keyword"</span>>in</span> exclude_patterns):
<span class="line-number">690</span>                <span class=<span class="string">"keyword"</span>>continue</span>
<span class="line-number">691</span>
</pre>
<h4>Line 690</h4>
<pre>
<span class="line-number">685</span>            <span class=<span class="string">"keyword"</span>>if</span> any(part.startswith(<span class="string">"."</span>) <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> file_path.parts):
<span class="line-number">686</span>                <span class=<span class="string">"keyword"</span>>continue</span>
<span class="line-number">687</span>
<span class="line-number">688</span>            <span class="comment"># Skip common exclude patterns</span>
<span class="line-number">689</span>            <span class=<span class="string">"keyword"</span>>if</span> any(pattern <span class=<span class="string">"keyword"</span>>in</span> file_path.parts <span class=<span class="string">"keyword"</span>>for</span> pattern <span class=<span class="string">"keyword"</span>>in</span> exclude_patterns):
<span class="line-number">690</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>continue</span></span>
<span class="line-number">691</span>
<span class="line-number">692</span>            filtered_files.<span class="function">append</span>(file_path)
<span class="line-number">693</span>
<span class="line-number">694</span>        self.logger.debug(<span class="string">"Found %d C/C++ files after filtering"</span>, len(filtered_files))
<span class="line-number">695</span>        <span class=<span class="string">"keyword"</span>>return</span> sorted(filtered_files)
</pre>
<h4>Line 704</h4>
<pre>
<span class="line-number">699</span>    ) -> List[Path]:
<span class="line-number">700</span>        <span class="string">""</span><span class="string">"Find C/C++ files based on configuration <span class="</span>keyword<span class="string">">and</span> include dependencies"</span><span class="string">""</span>
<span class="line-number">701</span>
<span class="line-number">702</span>        <span class="comment"># If no config provided, fall back to old behavior</span>
<span class="line-number">703</span>        <span class=<span class="string">"keyword"</span>>if</span> config <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">704</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> self._find_c_files(project_root, recursive_search)</span>
<span class="line-number">705</span>
<span class="line-number">706</span>        <span class="comment"># Get include depth <span class="keyword">from</span> config</span>
<span class="line-number">707</span>        include_depth = getattr(config, <span class="string">"include_depth"</span>, 1)
<span class="line-number">708</span>        self.logger.info(<span class="string">"Using include depth: %d"</span>, include_depth)
<span class="line-number">709</span>
</pre>
<h4>Line 739</h4>
<pre>
<span class="line-number">734</span>        )
<span class="line-number">735</span>        self.logger.debug(<span class="string">"Initial C files: %s"</span>, [f.name <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> initial_c_files])
<span class="line-number">736</span>
<span class="line-number">737</span>        <span class="comment"># Step 3: If include_depth <span class="keyword">is</span> 0, <span class="keyword">return</span> only the initially filtered C files</span>
<span class="line-number">738</span>        <span class=<span class="string">"keyword"</span>>if</span> include_depth == 0:
<span class="line-number">739</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> initial_c_files</span>
<span class="line-number">740</span>
<span class="line-number">741</span>        <span class="comment"># Step 4: Process include dependencies <span class="keyword">for</span> N iterations</span>
<span class="line-number">742</span>        files_to_parse = <span class="function">set</span>(initial_c_files)
<span class="line-number">743</span>
<span class="line-number">744</span>        <span class=<span class="string">"keyword"</span>>for</span> iteration <span class=<span class="string">"keyword"</span>>in</span> range(include_depth):
</pre>
<h4>Line 776</h4>
<pre>
<span class="line-number">771</span>                            new_includes.<span class="function">add</span>(included_file)
<span class="line-number">772</span>                            self.logger.<span class="function">debug</span>(
<span class="line-number">773</span>                                f<span class="string">"Added included file <span class="</span>keyword<span class="string">">in</span> iteration {iteration + 1}: {relative_included_path}"</span>
<span class="line-number">774</span>                            )
<span class="line-number">775</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">776</span><span class="uncovered">                            self.logger.<span class="function">debug</span>(</span>
<span class="line-number">777</span>                                f<span class="string">"Excluded included file due to config: {relative_included_path}"</span>
<span class="line-number">778</span>                            )
<span class="line-number">779</span>                    <span class=<span class="string">"keyword"</span>>elif</span> included_file:
<span class="line-number">780</span>                        self.logger.<span class="function">debug</span>(
<span class="line-number">781</span>                            f<span class="string">"Included file already <span class="</span>keyword<span class="string">">in</span> list: {included_file.name}"</span>
</pre>
<h4>Line 848</h4>
<pre>
<span class="line-number">843</span>                    <span class=<span class="string">"keyword"</span>>if</span> include_name.endswith(ext)
<span class="line-number">844</span>                    <span class=<span class="string">"keyword"</span>>else</span> f<span class="string">"{include_name}{ext}"</span>
<span class="line-number">845</span>                )
<span class="line-number">846</span>                <span class="comment"># Search recursively <span class="keyword">in</span> project root</span>
<span class="line-number">847</span>                <span class=<span class="string">"keyword"</span>>for</span> found_file <span class=<span class="string">"keyword"</span>>in</span> project_root.rglob(full_name):
<span class="line-number">848</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>if</span> found_file.is_file():</span>
<span class="line-number">849</span>                        <span class="comment"># For backward compatibility <span class="keyword">with</span> tests, <span class="keyword">return</span> full path <span class="keyword">if</span> it's a test</span>
<span class="line-number">850</span>                        <span class="comment"># Otherwise <span class="keyword">return</span> filename <span class="keyword">for</span> simplified tracking</span>
<span class="line-number">851</span>                        <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"tmp"</span> <span class=<span class="string">"keyword"</span>>in</span> str(found_file):
<span class="line-number">852</span>                            <span class=<span class="string">"keyword"</span>>return</span> found_file
<span class="line-number">853</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
</pre>
<h4>Lines 851-852</h4>
<pre>
<span class="line-number">846</span>                <span class="comment"># Search recursively <span class="keyword">in</span> project root</span>
<span class="line-number">847</span>                <span class=<span class="string">"keyword"</span>>for</span> found_file <span class=<span class="string">"keyword"</span>>in</span> project_root.rglob(full_name):
<span class="line-number">848</span>                    <span class=<span class="string">"keyword"</span>>if</span> found_file.is_file():
<span class="line-number">849</span>                        <span class="comment"># For backward compatibility <span class="keyword">with</span> tests, <span class="keyword">return</span> full path <span class="keyword">if</span> it's a test</span>
<span class="line-number">850</span>                        <span class="comment"># Otherwise <span class="keyword">return</span> filename <span class="keyword">for</span> simplified tracking</span>
<span class="line-number">851</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"tmp"</span> <span class=<span class="string">"keyword"</span>>in</span> str(found_file):</span>
<span class="line-number">852</span><span class="uncovered">                            <span class=<span class="string">"keyword"</span>>return</span> found_file</span>
<span class="line-number">853</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">854</span>                            <span class=<span class="string">"keyword"</span>>return</span> found_file
<span class="line-number">855</span>
<span class="line-number">856</span>        <span class="comment"># If we get here, the file was <span class="keyword">not</span> found - cache this result</span>
<span class="line-number">857</span>        self._failed_includes_cache.<span class="function">add</span>(cache_key)
</pre>
<h4>Line 854</h4>
<pre>
<span class="line-number">849</span>                        <span class="comment"># For backward compatibility <span class="keyword">with</span> tests, <span class="keyword">return</span> full path <span class="keyword">if</span> it's a test</span>
<span class="line-number">850</span>                        <span class="comment"># Otherwise <span class="keyword">return</span> filename <span class="keyword">for</span> simplified tracking</span>
<span class="line-number">851</span>                        <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"tmp"</span> <span class=<span class="string">"keyword"</span>>in</span> str(found_file):
<span class="line-number">852</span>                            <span class=<span class="string">"keyword"</span>>return</span> found_file
<span class="line-number">853</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">854</span><span class="uncovered">                            <span class=<span class="string">"keyword"</span>>return</span> found_file</span>
<span class="line-number">855</span>
<span class="line-number">856</span>        <span class="comment"># If we get here, the file was <span class="keyword">not</span> found - cache this result</span>
<span class="line-number">857</span>        self._failed_includes_cache.<span class="function">add</span>(cache_key)
<span class="line-number">858</span>        self.logger.debug(<span class="string">"Cached failed include search <span class="</span>keyword<span class="string">">for</span> <span class="string">'%s'</span>"</span>, include_name)
<span class="line-number">859</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
</pre>
<h4>Lines 872-874</h4>
<pre>
<span class="line-number">867</span>
<span class="line-number">868</span>            <span class="comment"># Tokenize <span class="keyword">and</span> extract includes</span>
<span class="line-number">869</span>            tokens = self.tokenizer.<span class="function">tokenize</span>(content)
<span class="line-number">870</span>            <span class=<span class="string">"keyword"</span>>return</span> self._parse_includes_with_tokenizer(tokens)
<span class="line-number">871</span>
<span class="line-number">872</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>except</span> Exception <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">873</span><span class="uncovered">            self.logger.warning(<span class="string">"Failed to extract includes <span class="</span>keyword<span class="string">">from</span> %s: %s"</span>, file_path, e)</span>
<span class="line-number">874</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> []</span>
<span class="line-number">875</span>
<span class="line-number">876</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _detect_encoding(self, file_path: Path) -> str:
<span class="line-number">877</span>        <span class="string">""</span><span class="string">"Detect file encoding <span class="</span>keyword<span class="string">">with</span> platform-aware fallbacks"</span><span class="string">""</span>
<span class="line-number">878</span>        <span class=<span class="string">"keyword"</span>>return</span> detect_file_encoding(file_path)
<span class="line-number">879</span>
</pre>
<h4>Line 896</h4>
<pre>
<span class="line-number">891</span>                <span class=<span class="string">"keyword"</span>>and</span> token.column == target_token.column
<span class="line-number">892</span>                <span class=<span class="string">"keyword"</span>>and</span> token.value == target_token.value
<span class="line-number">893</span>            ):
<span class="line-number">894</span>                <span class=<span class="string">"keyword"</span>>return</span> i
<span class="line-number">895</span>
<span class="line-number">896</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">897</span>
<span class="line-number">898</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_single_typedef(self, tokens, start_pos):
<span class="line-number">899</span>        <span class="string">""</span><span class="string">"Parse a single typedef starting at the given position"</span><span class="string">""</span>
<span class="line-number">900</span>        <span class="comment"># Skip 'typedef' keyword</span>
<span class="line-number">901</span>        pos = start_pos + <span class="number">1</span>
</pre>
<h4>Line 911</h4>
<pre>
<span class="line-number">906</span>            TokenType.COMMENT,
<span class="line-number">907</span>        ]:
<span class="line-number">908</span>            pos += <span class="number">1</span>
<span class="line-number">909</span>
<span class="line-number">910</span>        <span class=<span class="string">"keyword"</span>>if</span> pos >= len(tokens):
<span class="line-number">911</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">912</span>
<span class="line-number">913</span>        <span class="comment"># Check <span class="keyword">if</span> it's a struct/enum/union typedef (we'll handle these separately)</span>
<span class="line-number">914</span>        <span class=<span class="string">"keyword"</span>>if</span> tokens[pos].type <span class=<span class="string">"keyword"</span>>in</span> [TokenType.STRUCT, TokenType.ENUM, TokenType.UNION]:
<span class="line-number">915</span>            <span class=<span class="string">"keyword"</span>>return</span> self._parse_complex_typedef(tokens, pos)
<span class="line-number">916</span>
</pre>
<h4>Line 925</h4>
<pre>
<span class="line-number">920</span>            <span class=<span class="string">"keyword"</span>>if</span> tokens[pos].type <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> [TokenType.WHITESPACE, TokenType.COMMENT]:
<span class="line-number">921</span>                all_tokens.<span class="function">append</span>(tokens[pos])
<span class="line-number">922</span>            pos += <span class="number">1</span>
<span class="line-number">923</span>
<span class="line-number">924</span>        <span class=<span class="string">"keyword"</span>>if</span> len(all_tokens) < 2:
<span class="line-number">925</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">926</span>
<span class="line-number">927</span>        <span class="comment"># Function pointer typedef: typedef ret (*name)(params);</span>
<span class="line-number">928</span>        <span class=<span class="string">"keyword"</span>>for</span> i <span class=<span class="string">"keyword"</span>>in</span> range(len(all_tokens) - 3):
<span class="line-number">929</span>            <span class=<span class="string">"keyword"</span>>if</span> (
<span class="line-number">930</span>                all_tokens[i].type
</pre>
<h4>Lines 959-961</h4>
<pre>
<span class="line-number">954</span>            <span class=<span class="string">"keyword"</span>>if</span> (
<span class="line-number">955</span>                all_tokens[i].type == TokenType.LBRACKET
<span class="line-number">956</span>                <span class=<span class="string">"keyword"</span>>and</span> i > 0
<span class="line-number">957</span>                <span class=<span class="string">"keyword"</span>>and</span> all_tokens[i - 1].type == TokenType.IDENTIFIER
<span class="line-number">958</span>            ):
<span class="line-number">959</span><span class="uncovered">                typedef_name = all_tokens[i - <span class="number">1</span>].value</span>
<span class="line-number">960</span><span class="uncovered">                original_type = <span class="string">" "</span>.join(t.value <span class=<span class="string">"keyword"</span>>for</span> t <span class=<span class="string">"keyword"</span>>in</span> all_tokens)</span>
<span class="line-number">961</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> (typedef_name, original_type)</span>
<span class="line-number">962</span>
<span class="line-number">963</span>        <span class="comment"># Pointer typedef: typedef type * name;</span>
<span class="line-number">964</span>        <span class=<span class="string">"keyword"</span>>for</span> i <span class=<span class="string">"keyword"</span>>in</span> range(len(all_tokens) - 2):
<span class="line-number">965</span>            <span class=<span class="string">"keyword"</span>>if</span> (
<span class="line-number">966</span>                all_tokens[i].type == TokenType.ASTERISK
</pre>
<h4>Lines 969-971</h4>
<pre>
<span class="line-number">964</span>        <span class=<span class="string">"keyword"</span>>for</span> i <span class=<span class="string">"keyword"</span>>in</span> range(len(all_tokens) - 2):
<span class="line-number">965</span>            <span class=<span class="string">"keyword"</span>>if</span> (
<span class="line-number">966</span>                all_tokens[i].type == TokenType.ASTERISK
<span class="line-number">967</span>                <span class=<span class="string">"keyword"</span>>and</span> all_tokens[i + 1].type == TokenType.IDENTIFIER
<span class="line-number">968</span>            ):
<span class="line-number">969</span><span class="uncovered">                typedef_name = all_tokens[i + <span class="number">1</span>].value</span>
<span class="line-number">970</span><span class="uncovered">                original_type = <span class="string">" "</span>.join(t.value <span class=<span class="string">"keyword"</span>>for</span> t <span class=<span class="string">"keyword"</span>>in</span> all_tokens)</span>
<span class="line-number">971</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> (typedef_name, original_type)</span>
<span class="line-number">972</span>
<span class="line-number">973</span>        <span class="comment"># Simple typedef: the last token should be the typedef name, everything <span class="keyword">else</span> <span class="keyword">is</span> the type</span>
<span class="line-number">974</span>        typedef_name = all_tokens[-<span class="number">1</span>].value
<span class="line-number">975</span>        type_tokens = all_tokens[:-<span class="number">1</span>]
<span class="line-number">976</span>        original_type = <span class="string">" "</span>.join(t.value <span class=<span class="string">"keyword"</span>>for</span> t <span class=<span class="string">"keyword"</span>>in</span> type_tokens)
</pre>
<h4>Line 1007</h4>
<pre>
<span class="line-number">1002</span>            <span class=<span class="string">"keyword"</span>>elif</span> tokens[pos].type == TokenType.RBRACE:
<span class="line-number">1003</span>                brace_count -= <span class="number">1</span>
<span class="line-number">1004</span>            pos += <span class="number">1</span>
<span class="line-number">1005</span>
<span class="line-number">1006</span>        <span class=<span class="string">"keyword"</span>>if</span> brace_count > 0:
<span class="line-number">1007</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">1008</span>
<span class="line-number">1009</span>        <span class="comment"># Find typedef name after closing brace</span>
<span class="line-number">1010</span>        <span class=<span class="string">"keyword"</span>>while</span> pos < len(tokens) <span class=<span class="string">"keyword"</span>>and</span> tokens[pos].type <span class=<span class="string">"keyword"</span>>in</span> [
<span class="line-number">1011</span>            TokenType.WHITESPACE,
<span class="line-number">1012</span>            TokenType.COMMENT,
</pre>
<h4>Line 1036</h4>
<pre>
<span class="line-number">1031</span>            TokenType.COMMENT,
<span class="line-number">1032</span>        ]:
<span class="line-number">1033</span>            pos += <span class="number">1</span>
<span class="line-number">1034</span>
<span class="line-number">1035</span>        <span class=<span class="string">"keyword"</span>>if</span> pos >= len(tokens):
<span class="line-number">1036</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class="string">""</span></span>
<span class="line-number">1037</span>
<span class="line-number">1038</span>        <span class="comment"># Check <span class="keyword">if</span> it's a struct/enum/union</span>
<span class="line-number">1039</span>        <span class=<span class="string">"keyword"</span>>if</span> tokens[pos].type <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> [TokenType.STRUCT, TokenType.ENUM, TokenType.UNION]:
<span class="line-number">1040</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class="string">""</span>
<span class="line-number">1041</span>
</pre>
<h4>Line 1040</h4>
<pre>
<span class="line-number">1035</span>        <span class=<span class="string">"keyword"</span>>if</span> pos >= len(tokens):
<span class="line-number">1036</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class="string">""</span>
<span class="line-number">1037</span>
<span class="line-number">1038</span>        <span class="comment"># Check <span class="keyword">if</span> it's a struct/enum/union</span>
<span class="line-number">1039</span>        <span class=<span class="string">"keyword"</span>>if</span> tokens[pos].type <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> [TokenType.STRUCT, TokenType.ENUM, TokenType.UNION]:
<span class="line-number">1040</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class="string">""</span></span>
<span class="line-number">1041</span>
<span class="line-number">1042</span>        <span class="comment"># Skip struct/enum/union keyword</span>
<span class="line-number">1043</span>        pos += <span class="number">1</span>
<span class="line-number">1044</span>
<span class="line-number">1045</span>        <span class="comment"># Skip whitespace <span class="keyword">and</span> comments</span>
</pre>
<h4>Line 1120</h4>
<pre>
<span class="line-number">1115</span>                    <span class=<span class="string">"keyword"</span>>return</span> i + 1 <span class=<span class="string">"keyword"</span>>if</span> i < len(tokens) <span class=<span class="string">"keyword"</span>>else</span> i
<span class="line-number">1116</span>            <span class=<span class="string">"keyword"</span>>elif</span> tokens[i].type == TokenType.SEMICOLON <span class=<span class="string">"keyword"</span>>and</span> brace_count == 0:
<span class="line-number">1117</span>                <span class=<span class="string">"keyword"</span>>return</span> i + 1
<span class="line-number">1118</span>            i += <span class="number">1</span>
<span class="line-number">1119</span>
<span class="line-number">1120</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> i</span>
<span class="line-number">1121</span>
<span class="line-number">1122</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_global_variable(self, tokens, start_pos):
<span class="line-number">1123</span>        <span class="string">""</span><span class="string">"Parse a <span class="</span>keyword<span class="string">">global</span> variable declaration starting at start_pos"</span><span class="string">""</span>
<span class="line-number">1124</span>        <span class="comment"># Look <span class="keyword">for</span> pattern: [static/extern] type name [= value];</span>
<span class="line-number">1125</span>        i = start_pos
</pre>
<h4>Line 1182</h4>
<pre>
<span class="line-number">1177</span>                                <span class=<span class="string">"keyword"</span>>if</span> collected_tokens[k].type == TokenType.IDENTIFIER:
<span class="line-number">1178</span>                                    var_name = collected_tokens[k].value
<span class="line-number">1179</span>                                    type_tokens = collected_tokens[start_idx:k]
<span class="line-number">1180</span>                                    var_type = <span class="string">" "</span>.join(t.value <span class=<span class="string">"keyword"</span>>for</span> t <span class=<span class="string">"keyword"</span>>in</span> type_tokens)
<span class="line-number">1181</span>                                    <span class=<span class="string">"keyword"</span>>return</span> (var_name, var_type, <span class=<span class="string">"keyword"</span>>None</span>)
<span class="line-number">1182</span><span class="uncovered">                            <span class=<span class="string">"keyword"</span>>break</span></span>
<span class="line-number">1183</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">1184</span>                    <span class="comment"># Regular variable: last token <span class="keyword">is</span> the name</span>
<span class="line-number">1185</span>                    var_name = collected_tokens[-<span class="number">1</span>].value
<span class="line-number">1186</span>                    type_tokens = collected_tokens[start_idx:-<span class="number">1</span>]
<span class="line-number">1187</span>                    var_type = <span class="string">" "</span>.join(t.value <span class=<span class="string">"keyword"</span>>for</span> t <span class=<span class="string">"keyword"</span>>in</span> type_tokens)
</pre>
<h4>Lines 1202-1203</h4>
<pre>
<span class="line-number">1197</span>        <span class=<span class="string">"keyword"</span>>return</span> i + 1 <span class=<span class="string">"keyword"</span>>if</span> i < len(tokens) <span class=<span class="string">"keyword"</span>>else</span> i
<span class="line-number">1198</span>
<span class="line-number">1199</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _skip_preprocessor_directives(self, tokens, start_pos):
<span class="line-number">1200</span>        <span class="string">""</span><span class="string">"Skip preprocessor directives but keep their content <span class="</span>keyword<span class="string">">for</span> parsing"</span><span class="string">""</span>
<span class="line-number">1201</span>        <span class="comment"># This method <span class="keyword">is</span> deprecated - use the PreprocessorManager instead</span>
<span class="line-number">1202</span><span class="uncovered">        i = start_pos</span>
<span class="line-number">1203</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>while</span> i < len(tokens) <span class=<span class="string">"keyword"</span>>and</span> tokens[i].type == TokenType.PREPROCESSOR:</span>
<span class="line-number">1204</span>            <span class="comment"># Skip the preprocessor directive itself</span>
<span class="line-number">1205</span>            i += <span class="number">1</span>
<span class="line-number">1206</span>        <span class=<span class="string">"keyword"</span>>return</span> i
<span class="line-number">1207</span>
<span class="line-number">1208</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_function_parameters(self, tokens, start_pos, end_pos, func_name):
</pre>
<h4>Lines 1205-1206</h4>
<pre>
<span class="line-number">1200</span>        <span class="string">""</span><span class="string">"Skip preprocessor directives but keep their content <span class="</span>keyword<span class="string">">for</span> parsing"</span><span class="string">""</span>
<span class="line-number">1201</span>        <span class="comment"># This method <span class="keyword">is</span> deprecated - use the PreprocessorManager instead</span>
<span class="line-number">1202</span>        i = start_pos
<span class="line-number">1203</span>        <span class=<span class="string">"keyword"</span>>while</span> i < len(tokens) <span class=<span class="string">"keyword"</span>>and</span> tokens[i].type == TokenType.PREPROCESSOR:
<span class="line-number">1204</span>            <span class="comment"># Skip the preprocessor directive itself</span>
<span class="line-number">1205</span><span class="uncovered">            i += <span class="number">1</span></span>
<span class="line-number">1206</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> i</span>
<span class="line-number">1207</span>
<span class="line-number">1208</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_function_parameters(self, tokens, start_pos, end_pos, func_name):
<span class="line-number">1209</span>        <span class="string">""</span><span class="string">"Parse function parameters <span class="</span>keyword<span class="string">">from</span> token range"</span><span class="string">""</span>
<span class="line-number">1210</span>
<span class="line-number">1211</span>        parameters = []
</pre>
<h4>Line 1224</h4>
<pre>
<span class="line-number">1219</span>                <span class="comment"># Look <span class="keyword">for</span> opening parenthesis after function name</span>
<span class="line-number">1220</span>                <span class=<span class="string">"keyword"</span>>for</span> j <span class=<span class="string">"keyword"</span>>in</span> range(i + 1, min(end_pos + 1, len(tokens))):
<span class="line-number">1221</span>                    <span class=<span class="string">"keyword"</span>>if</span> tokens[j].type == TokenType.LPAREN:
<span class="line-number">1222</span>                        paren_start = j
<span class="line-number">1223</span>                        <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">1224</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>elif</span> tokens[j].type <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> [</span>
<span class="line-number">1225</span>                        TokenType.WHITESPACE,
<span class="line-number">1226</span>                        TokenType.COMMENT,
<span class="line-number">1227</span>                    ]:
<span class="line-number">1228</span>                        <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">1229</span>                <span class=<span class="string">"keyword"</span>>break</span>
</pre>
<h4>Line 1228</h4>
<pre>
<span class="line-number">1223</span>                        <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">1224</span>                    <span class=<span class="string">"keyword"</span>>elif</span> tokens[j].type <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> [
<span class="line-number">1225</span>                        TokenType.WHITESPACE,
<span class="line-number">1226</span>                        TokenType.COMMENT,
<span class="line-number">1227</span>                    ]:
<span class="line-number">1228</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>break</span></span>
<span class="line-number">1229</span>                <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">1230</span>
<span class="line-number">1231</span>        <span class=<span class="string">"keyword"</span>>if</span> paren_start <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">1232</span>            <span class=<span class="string">"keyword"</span>>return</span> parameters
<span class="line-number">1233</span>
</pre>
<h4>Line 1232</h4>
<pre>
<span class="line-number">1227</span>                    ]:
<span class="line-number">1228</span>                        <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">1229</span>                <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">1230</span>
<span class="line-number">1231</span>        <span class=<span class="string">"keyword"</span>>if</span> paren_start <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">1232</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> parameters</span>
<span class="line-number">1233</span>
<span class="line-number">1234</span>        <span class="comment"># Find matching closing parenthesis</span>
<span class="line-number">1235</span>        paren_depth = <span class="number">1</span>
<span class="line-number">1236</span>        <span class=<span class="string">"keyword"</span>>for</span> i <span class=<span class="string">"keyword"</span>>in</span> range(paren_start + 1, min(end_pos + 1, len(tokens))):
<span class="line-number">1237</span>            <span class=<span class="string">"keyword"</span>>if</span> tokens[i].type == TokenType.LPAREN:
</pre>
<h4>Line 1246</h4>
<pre>
<span class="line-number">1241</span>                <span class=<span class="string">"keyword"</span>>if</span> paren_depth == 0:
<span class="line-number">1242</span>                    paren_end = i
<span class="line-number">1243</span>                    <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">1244</span>
<span class="line-number">1245</span>        <span class=<span class="string">"keyword"</span>>if</span> paren_end <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">1246</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> parameters</span>
<span class="line-number">1247</span>
<span class="line-number">1248</span>        <span class="comment"># Parse parameter tokens between parentheses</span>
<span class="line-number">1249</span>        param_tokens = []
<span class="line-number">1250</span>        <span class=<span class="string">"keyword"</span>>for</span> i <span class=<span class="string">"keyword"</span>>in</span> range(paren_start + 1, paren_end):
<span class="line-number">1251</span>            <span class=<span class="string">"keyword"</span>>if</span> tokens[i].type <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> [TokenType.WHITESPACE, TokenType.COMMENT]:
</pre>
<h4>Line 1285</h4>
<pre>
<span class="line-number">1280</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_single_parameter(self, param_tokens):
<span class="line-number">1281</span>        <span class="string">""</span><span class="string">"Parse a single function parameter <span class="</span>keyword<span class="string">">from</span> tokens"</span><span class="string">""</span>
<span class="line-number">1282</span>        <span class=<span class="string">"keyword"</span>>from</span> .models <span class=<span class="string">"keyword"</span>>import</span> Field
<span class="line-number">1283</span>
<span class="line-number">1284</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> param_tokens:
<span class="line-number">1285</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">1286</span>
<span class="line-number">1287</span>        <span class="comment"># Handle variadic parameters (three consecutive dots)</span>
<span class="line-number">1288</span>        <span class=<span class="string">"keyword"</span>>if</span> len(param_tokens) == 3 <span class=<span class="string">"keyword"</span>>and</span> all(t.value == <span class="string">"."</span> <span class=<span class="string">"keyword"</span>>for</span> t <span class=<span class="string">"keyword"</span>>in</span> param_tokens):
<span class="line-number">1289</span>            <span class=<span class="string">"keyword"</span>>return</span> Field(name=<span class="string">"..."</span>, type=<span class="string">"..."</span>)
<span class="line-number">1290</span>
</pre>
<h4>Line 1293</h4>
<pre>
<span class="line-number">1288</span>        <span class=<span class="string">"keyword"</span>>if</span> len(param_tokens) == 3 <span class=<span class="string">"keyword"</span>>and</span> all(t.value == <span class="string">"."</span> <span class=<span class="string">"keyword"</span>>for</span> t <span class=<span class="string">"keyword"</span>>in</span> param_tokens):
<span class="line-number">1289</span>            <span class=<span class="string">"keyword"</span>>return</span> Field(name=<span class="string">"..."</span>, type=<span class="string">"..."</span>)
<span class="line-number">1290</span>
<span class="line-number">1291</span>        <span class="comment"># Handle variadic parameters (single ... token)</span>
<span class="line-number">1292</span>        <span class=<span class="string">"keyword"</span>>if</span> len(param_tokens) == 1 <span class=<span class="string">"keyword"</span>>and</span> param_tokens[0].value == <span class="string">"..."</span>:
<span class="line-number">1293</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> Field(name=<span class="string">"..."</span>, type=<span class="string">"..."</span>)</span>
<span class="line-number">1294</span>
<span class="line-number">1295</span>        <span class="comment"># For parameters like "int x" <span class="keyword">or</span> "const char *name"</span>
<span class="line-number">1296</span>        <span class=<span class="string">"keyword"</span>>if</span> len(param_tokens) >= 2:
<span class="line-number">1297</span>            <span class="comment"># Last token <span class="keyword">is</span> usually the parameter name</span>
<span class="line-number">1298</span>            param_name = param_tokens[-<span class="number">1</span>].value
</pre>
<h4>Lines 1340-1341</h4>
<pre>
<span class="line-number">1335</span>                <span class="string">"signed"</span>,
<span class="line-number">1336</span>            ]:
<span class="line-number">1337</span>                <span class=<span class="string">"keyword"</span>>return</span> Field(name=<span class="string">"unnamed"</span>, type=token_value)
<span class="line-number">1338</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">1339</span>                <span class="comment"># If we can't determine the type, use 'unknown' <span class="keyword">as</span> a fallback</span>
<span class="line-number">1340</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>if</span> token_value <span class=<span class="string">"keyword"</span>>and</span> token_value.strip():</span>
<span class="line-number">1341</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> Field(name=token_value.strip(), type=<span class="string">"unknown"</span>)</span>
<span class="line-number">1342</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">1343</span>                    <span class=<span class="string">"keyword"</span>>return</span> Field(name=<span class="string">"unnamed"</span>, type=<span class="string">"unknown"</span>)
<span class="line-number">1344</span>
<span class="line-number">1345</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">1346</span>
</pre>
<h4>Line 1343</h4>
<pre>
<span class="line-number">1338</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">1339</span>                <span class="comment"># If we can't determine the type, use 'unknown' <span class="keyword">as</span> a fallback</span>
<span class="line-number">1340</span>                <span class=<span class="string">"keyword"</span>>if</span> token_value <span class=<span class="string">"keyword"</span>>and</span> token_value.strip():
<span class="line-number">1341</span>                    <span class=<span class="string">"keyword"</span>>return</span> Field(name=token_value.strip(), type=<span class="string">"unknown"</span>)
<span class="line-number">1342</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">1343</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> Field(name=<span class="string">"unnamed"</span>, type=<span class="string">"unknown"</span>)</span>
<span class="line-number">1344</span>
<span class="line-number">1345</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">1346</span>
<span class="line-number">1347</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _get_timestamp(self) -> str:
<span class="line-number">1348</span>        <span class="string">""</span><span class="string">"Get current timestamp string"</span><span class="string">""</span>
</pre>
<h4>Line 1345</h4>
<pre>
<span class="line-number">1340</span>                <span class=<span class="string">"keyword"</span>>if</span> token_value <span class=<span class="string">"keyword"</span>>and</span> token_value.strip():
<span class="line-number">1341</span>                    <span class=<span class="string">"keyword"</span>>return</span> Field(name=token_value.strip(), type=<span class="string">"unknown"</span>)
<span class="line-number">1342</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">1343</span>                    <span class=<span class="string">"keyword"</span>>return</span> Field(name=<span class="string">"unnamed"</span>, type=<span class="string">"unknown"</span>)
<span class="line-number">1344</span>
<span class="line-number">1345</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">1346</span>
<span class="line-number">1347</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _get_timestamp(self) -> str:
<span class="line-number">1348</span>        <span class="string">""</span><span class="string">"Get current timestamp string"</span><span class="string">""</span>
<span class="line-number">1349</span>        <span class=<span class="string">"keyword"</span>>from</span> datetime <span class=<span class="string">"keyword"</span>>import</span> datetime
<span class="line-number">1350</span>
</pre>
<h4>Line 1349</h4>
<pre>
<span class="line-number">1344</span>
<span class="line-number">1345</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">1346</span>
<span class="line-number">1347</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _get_timestamp(self) -> str:
<span class="line-number">1348</span>        <span class="string">""</span><span class="string">"Get current timestamp string"</span><span class="string">""</span>
<span class="line-number">1349</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>from</span> datetime <span class=<span class="string">"keyword"</span>>import</span> datetime</span>
<span class="line-number">1350</span>
<span class="line-number">1351</span>        <span class=<span class="string">"keyword"</span>>return</span> datetime.now().isoformat()
<span class="line-number">1352</span>
<span class="line-number">1353</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> get_failed_includes_cache_stats(self) -> dict:
<span class="line-number">1354</span>        <span class="string">""</span><span class="string">"Get statistics about the failed includes cache"</span><span class="string">""</span>
</pre>
<h4>Line 1351</h4>
<pre>
<span class="line-number">1346</span>
<span class="line-number">1347</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _get_timestamp(self) -> str:
<span class="line-number">1348</span>        <span class="string">""</span><span class="string">"Get current timestamp string"</span><span class="string">""</span>
<span class="line-number">1349</span>        <span class=<span class="string">"keyword"</span>>from</span> datetime <span class=<span class="string">"keyword"</span>>import</span> datetime
<span class="line-number">1350</span>
<span class="line-number">1351</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> datetime.now().isoformat()</span>
<span class="line-number">1352</span>
<span class="line-number">1353</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> get_failed_includes_cache_stats(self) -> dict:
<span class="line-number">1354</span>        <span class="string">""</span><span class="string">"Get statistics about the failed includes cache"</span><span class="string">""</span>
<span class="line-number">1355</span>        <span class=<span class="string">"keyword"</span>>return</span> {
<span class="line-number">1356</span>            <span class="string">"cache_size"</span>: len(self._failed_includes_cache),
</pre>
<h4>Line 1355</h4>
<pre>
<span class="line-number">1350</span>
<span class="line-number">1351</span>        <span class=<span class="string">"keyword"</span>>return</span> datetime.now().isoformat()
<span class="line-number">1352</span>
<span class="line-number">1353</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> get_failed_includes_cache_stats(self) -> dict:
<span class="line-number">1354</span>        <span class="string">""</span><span class="string">"Get statistics about the failed includes cache"</span><span class="string">""</span>
<span class="line-number">1355</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> {</span>
<span class="line-number">1356</span>            <span class="string">"cache_size"</span>: len(self._failed_includes_cache),
<span class="line-number">1357</span>            <span class="string">"cached_includes"</span>: list(self._failed_includes_cache),
<span class="line-number">1358</span>        }
<span class="line-number">1359</span>
<span class="line-number">1360</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/preprocessor.py - 65.76% coverage (194/295 lines)
</div>
<h4>Lines 54-56</h4>
<pre>
<span class="line-number"> 49</span>        self.blocks: List[PreprocessorBlock] = []
<span class="line-number"> 50</span>        self.current_block_stack: List[PreprocessorBlock] = []
<span class="line-number"> 51</span>
<span class="line-number"> 52</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> add_define(self, name: str, value: str = <span class="string">""</span>):
<span class="line-number"> 53</span>        <span class="string">""</span><span class="string">"Add a defined macro."</span><span class="string">""</span>
<span class="line-number"> 54</span><span class="uncovered">        self.defined_macros.<span class="function">add</span>(name)</span>
<span class="line-number"> 55</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>if</span> value:</span>
<span class="line-number"> 56</span><span class="uncovered">            self.macro_values[name] = value</span>
<span class="line-number"> 57</span>
<span class="line-number"> 58</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> add_undef(self, name: str):
<span class="line-number"> 59</span>        <span class="string">""</span><span class="string">"Remove a defined macro."</span><span class="string">""</span>
<span class="line-number"> 60</span>        self.defined_macros.<span class="function">discard</span>(name)
<span class="line-number"> 61</span>        self.macro_values.pop(name, <span class=<span class="string">"keyword"</span>>None</span>)
</pre>
<h4>Lines 60-61</h4>
<pre>
<span class="line-number"> 55</span>        <span class=<span class="string">"keyword"</span>>if</span> value:
<span class="line-number"> 56</span>            self.macro_values[name] = value
<span class="line-number"> 57</span>
<span class="line-number"> 58</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> add_undef(self, name: str):
<span class="line-number"> 59</span>        <span class="string">""</span><span class="string">"Remove a defined macro."</span><span class="string">""</span>
<span class="line-number"> 60</span><span class="uncovered">        self.defined_macros.<span class="function">discard</span>(name)</span>
<span class="line-number"> 61</span><span class="uncovered">        self.macro_values.pop(name, <span class=<span class="string">"keyword"</span>>None</span>)</span>
<span class="line-number"> 62</span>
<span class="line-number"> 63</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> is_defined(self, name: str) -> bool:
<span class="line-number"> 64</span>        <span class="string">""</span><span class="string">"Check <span class="</span>keyword<span class="string">">if</span> a macro <span class="</span>keyword<span class="string">">is</span> defined."</span><span class="string">""</span>
<span class="line-number"> 65</span>        <span class=<span class="string">"keyword"</span>>return</span> name <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros
<span class="line-number"> 66</span>
</pre>
<h4>Line 69</h4>
<pre>
<span class="line-number"> 64</span>        <span class="string">""</span><span class="string">"Check <span class="</span>keyword<span class="string">">if</span> a macro <span class="</span>keyword<span class="string">">is</span> defined."</span><span class="string">""</span>
<span class="line-number"> 65</span>        <span class=<span class="string">"keyword"</span>>return</span> name <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros
<span class="line-number"> 66</span>
<span class="line-number"> 67</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> get_macro_value(self, name: str) -> str:
<span class="line-number"> 68</span>        <span class="string">""</span><span class="string">"Get the value of a defined macro."</span><span class="string">""</span>
<span class="line-number"> 69</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> self.macro_values.get(name, <span class="string">""</span>)</span>
<span class="line-number"> 70</span>
<span class="line-number"> 71</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> evaluate_condition(self, condition: str) -> bool:
<span class="line-number"> 72</span>        <span class="string">""</span><span class="string">"Evaluate a preprocessor condition."</span><span class="string">""</span>
<span class="line-number"> 73</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> condition.strip():
<span class="line-number"> 74</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
</pre>
<h4>Lines 103-104</h4>
<pre>
<span class="line-number"> 98</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _expand_macros(self, condition: str) -> str:
<span class="line-number"> 99</span>        <span class="string">""</span><span class="string">"Expand macros <span class="</span>keyword<span class="string">">in</span> the condition."</span><span class="string">""</span>
<span class="line-number">100</span>        <span class="comment"># Simple macro expansion <span class="keyword">for</span> common cases</span>
<span class="line-number">101</span>        <span class=<span class="string">"keyword"</span>>for</span> macro_name, macro_value <span class=<span class="string">"keyword"</span>>in</span> self.macro_values.items():
<span class="line-number">102</span>            <span class="comment"># Replace macro name <span class="keyword">with</span> its value</span>
<span class="line-number">103</span><span class="uncovered">            pattern = r<span class="string">"\b"</span> + re.escape(macro_name) + r<span class="string">"\b"</span></span>
<span class="line-number">104</span><span class="uncovered">            condition = re.<span class="function">sub</span>(pattern, macro_value, condition)</span>
<span class="line-number">105</span>        <span class=<span class="string">"keyword"</span>>return</span> condition
<span class="line-number">106</span>
<span class="line-number">107</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _evaluate_simple_expression(self, condition: str) -> bool:
<span class="line-number">108</span>        <span class="string">""</span><span class="string">"Evaluate simple expressions like comparisons <span class="</span>keyword<span class="string">">and</span> logical operators."</span><span class="string">""</span>
<span class="line-number">109</span>        <span class=<span class="string">"keyword"</span>>try</span>:
</pre>
<h4>Line 115</h4>
<pre>
<span class="line-number">110</span>            <span class="comment"># Handle common comparison operators</span>
<span class="line-number">111</span>            condition = condition.<span class="function">strip</span>()
<span class="line-number">112</span>
<span class="line-number">113</span>            <span class="comment"># Handle simple boolean values</span>
<span class="line-number">114</span>            <span class=<span class="string">"keyword"</span>>if</span> condition.lower() <span class=<span class="string">"keyword"</span>>in</span> [<span class="string">"1"</span>, <span class="string">"true"</span>, <span class="string">"yes"</span>]:
<span class="line-number">115</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">116</span>            <span class=<span class="string">"keyword"</span>>if</span> condition.lower() <span class=<span class="string">"keyword"</span>>in</span> [<span class="string">"0"</span>, <span class="string">"false"</span>, <span class="string">"no"</span>]:
<span class="line-number">117</span>                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">118</span>
<span class="line-number">119</span>            <span class="comment"># Handle simple comparisons</span>
<span class="line-number">120</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"=="</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
</pre>
<h4>Line 127</h4>
<pre>
<span class="line-number">122</span>                left_val = left.<span class="function">strip</span>()
<span class="line-number">123</span>                right_val = right.<span class="function">strip</span>()
<span class="line-number">124</span>
<span class="line-number">125</span>                <span class="comment"># If both sides are known macros, compare their values</span>
<span class="line-number">126</span>                <span class=<span class="string">"keyword"</span>>if</span> left_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros <span class=<span class="string">"keyword"</span>>and</span> right_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">127</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) == self.get_macro_value(</span>
<span class="line-number">128</span>                        right_val
<span class="line-number">129</span>                    )
<span class="line-number">130</span>                <span class="comment"># If one side <span class="keyword">is</span> a known macro, compare <span class="keyword">with</span> the other side</span>
<span class="line-number">131</span>                <span class=<span class="string">"keyword"</span>>elif</span> left_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">132</span>                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) == right_val
</pre>
<h4>Line 132</h4>
<pre>
<span class="line-number">127</span>                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) == self.get_macro_value(
<span class="line-number">128</span>                        right_val
<span class="line-number">129</span>                    )
<span class="line-number">130</span>                <span class="comment"># If one side <span class="keyword">is</span> a known macro, compare <span class="keyword">with</span> the other side</span>
<span class="line-number">131</span>                <span class=<span class="string">"keyword"</span>>elif</span> left_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">132</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) == right_val</span>
<span class="line-number">133</span>                <span class=<span class="string">"keyword"</span>>elif</span> right_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">134</span>                    <span class=<span class="string">"keyword"</span>>return</span> left_val == self.get_macro_value(right_val)
<span class="line-number">135</span>                <span class="comment"># If neither side <span class="keyword">is</span> a known macro, both are undefined, so they're equal</span>
<span class="line-number">136</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">137</span>                    <span class="keyword">return</span> <span class="keyword">True</span>  <span class="comment"># Both undefined macros are considered equal</span>
</pre>
<h4>Line 134</h4>
<pre>
<span class="line-number">129</span>                    )
<span class="line-number">130</span>                <span class="comment"># If one side <span class="keyword">is</span> a known macro, compare <span class="keyword">with</span> the other side</span>
<span class="line-number">131</span>                <span class=<span class="string">"keyword"</span>>elif</span> left_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">132</span>                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) == right_val
<span class="line-number">133</span>                <span class=<span class="string">"keyword"</span>>elif</span> right_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">134</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> left_val == self.get_macro_value(right_val)</span>
<span class="line-number">135</span>                <span class="comment"># If neither side <span class="keyword">is</span> a known macro, both are undefined, so they're equal</span>
<span class="line-number">136</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">137</span>                    <span class="keyword">return</span> <span class="keyword">True</span>  <span class="comment"># Both undefined macros are considered equal</span>
<span class="line-number">138</span>
<span class="line-number">139</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"!="</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
</pre>
<h4>Lines 140-142</h4>
<pre>
<span class="line-number">135</span>                <span class="comment"># If neither side <span class="keyword">is</span> a known macro, both are undefined, so they're equal</span>
<span class="line-number">136</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">137</span>                    <span class="keyword">return</span> <span class="keyword">True</span>  <span class="comment"># Both undefined macros are considered equal</span>
<span class="line-number">138</span>
<span class="line-number">139</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"!="</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
<span class="line-number">140</span><span class="uncovered">                left, right = condition.split(<span class="string">"!="</span>, 1)</span>
<span class="line-number">141</span><span class="uncovered">                left_val = left.<span class="function">strip</span>()</span>
<span class="line-number">142</span><span class="uncovered">                right_val = right.<span class="function">strip</span>()</span>
<span class="line-number">143</span>
<span class="line-number">144</span>                <span class="comment"># If both sides are known macros, compare their values</span>
<span class="line-number">145</span>                <span class=<span class="string">"keyword"</span>>if</span> left_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros <span class=<span class="string">"keyword"</span>>and</span> right_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">146</span>                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) != self.get_macro_value(
<span class="line-number">147</span>                        right_val
</pre>
<h4>Lines 145-146</h4>
<pre>
<span class="line-number">140</span>                left, right = condition.split(<span class="string">"!="</span>, 1)
<span class="line-number">141</span>                left_val = left.<span class="function">strip</span>()
<span class="line-number">142</span>                right_val = right.<span class="function">strip</span>()
<span class="line-number">143</span>
<span class="line-number">144</span>                <span class="comment"># If both sides are known macros, compare their values</span>
<span class="line-number">145</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>if</span> left_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros <span class=<span class="string">"keyword"</span>>and</span> right_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:</span>
<span class="line-number">146</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) != self.get_macro_value(</span>
<span class="line-number">147</span>                        right_val
<span class="line-number">148</span>                    )
<span class="line-number">149</span>                <span class="comment"># If one side <span class="keyword">is</span> a known macro, compare <span class="keyword">with</span> the other side</span>
<span class="line-number">150</span>                <span class=<span class="string">"keyword"</span>>elif</span> left_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">151</span>                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) != right_val
</pre>
<h4>Lines 150-153</h4>
<pre>
<span class="line-number">145</span>                <span class=<span class="string">"keyword"</span>>if</span> left_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros <span class=<span class="string">"keyword"</span>>and</span> right_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">146</span>                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) != self.get_macro_value(
<span class="line-number">147</span>                        right_val
<span class="line-number">148</span>                    )
<span class="line-number">149</span>                <span class="comment"># If one side <span class="keyword">is</span> a known macro, compare <span class="keyword">with</span> the other side</span>
<span class="line-number">150</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>elif</span> left_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:</span>
<span class="line-number">151</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) != right_val</span>
<span class="line-number">152</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>elif</span> right_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:</span>
<span class="line-number">153</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> left_val != self.get_macro_value(right_val)</span>
<span class="line-number">154</span>                <span class="comment"># If neither side <span class="keyword">is</span> a known macro, do string comparison</span>
<span class="line-number">155</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">156</span>                    <span class=<span class="string">"keyword"</span>>return</span> left_val != right_val
<span class="line-number">157</span>
<span class="line-number">158</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">">"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
</pre>
<h4>Line 156</h4>
<pre>
<span class="line-number">151</span>                    <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(left_val) != right_val
<span class="line-number">152</span>                <span class=<span class="string">"keyword"</span>>elif</span> right_val <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">153</span>                    <span class=<span class="string">"keyword"</span>>return</span> left_val != self.get_macro_value(right_val)
<span class="line-number">154</span>                <span class="comment"># If neither side <span class="keyword">is</span> a known macro, do string comparison</span>
<span class="line-number">155</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">156</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> left_val != right_val</span>
<span class="line-number">157</span>
<span class="line-number">158</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">">"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
<span class="line-number">159</span>                left, right = condition.split(<span class="string">">"</span>, 1)
<span class="line-number">160</span>                <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">161</span>                    left_val = self.<span class="function">_evaluate_operand</span>(left.<span class="function">strip</span>())
</pre>
<h4>Lines 166-189</h4>
<pre>
<span class="line-number">161</span>                    left_val = self.<span class="function">_evaluate_operand</span>(left.<span class="function">strip</span>())
<span class="line-number">162</span>                    right_val = self.<span class="function">_evaluate_operand</span>(right.<span class="function">strip</span>())
<span class="line-number">163</span>                    <span class=<span class="string">"keyword"</span>>return</span> float(left_val) > float(right_val)
<span class="line-number">164</span>                <span class=<span class="string">"keyword"</span>>except</span> ValueError:
<span class="line-number">165</span>                    <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">166</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"<"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:</span>
<span class="line-number">167</span><span class="uncovered">                left, right = condition.split(<span class="string">"<"</span>, 1)</span>
<span class="line-number">168</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>try</span>:</span>
<span class="line-number">169</span><span class="uncovered">                    left_val = self.<span class="function">_evaluate_operand</span>(left.<span class="function">strip</span>())</span>
<span class="line-number">170</span><span class="uncovered">                    right_val = self.<span class="function">_evaluate_operand</span>(right.<span class="function">strip</span>())</span>
<span class="line-number">171</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> float(left_val) < float(right_val)</span>
<span class="line-number">172</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>except</span> ValueError:</span>
<span class="line-number">173</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">174</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">">="</span> <span class=<span class="string">"keyword"</span>>in</span> condition:</span>
<span class="line-number">175</span><span class="uncovered">                left, right = condition.split(<span class="string">">="</span>, 1)</span>
<span class="line-number">176</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>try</span>:</span>
<span class="line-number">177</span><span class="uncovered">                    left_val = self.<span class="function">_evaluate_operand</span>(left.<span class="function">strip</span>())</span>
<span class="line-number">178</span><span class="uncovered">                    right_val = self.<span class="function">_evaluate_operand</span>(right.<span class="function">strip</span>())</span>
<span class="line-number">179</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> float(left_val) >= float(right_val)</span>
<span class="line-number">180</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>except</span> ValueError:</span>
<span class="line-number">181</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">182</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"<="</span> <span class=<span class="string">"keyword"</span>>in</span> condition:</span>
<span class="line-number">183</span><span class="uncovered">                left, right = condition.split(<span class="string">"<="</span>, 1)</span>
<span class="line-number">184</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>try</span>:</span>
<span class="line-number">185</span><span class="uncovered">                    left_val = self.<span class="function">_evaluate_operand</span>(left.<span class="function">strip</span>())</span>
<span class="line-number">186</span><span class="uncovered">                    right_val = self.<span class="function">_evaluate_operand</span>(right.<span class="function">strip</span>())</span>
<span class="line-number">187</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> float(left_val) <= float(right_val)</span>
<span class="line-number">188</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>except</span> ValueError:</span>
<span class="line-number">189</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">190</span>
<span class="line-number">191</span>            <span class="comment"># Handle logical operators</span>
<span class="line-number">192</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"&&"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
<span class="line-number">193</span>                parts = condition.split(<span class="string">"&&"</span>)
<span class="line-number">194</span>                <span class=<span class="string">"keyword"</span>>return</span> all(
</pre>
<h4>Lines 192-194</h4>
<pre>
<span class="line-number">187</span>                    <span class=<span class="string">"keyword"</span>>return</span> float(left_val) <= float(right_val)
<span class="line-number">188</span>                <span class=<span class="string">"keyword"</span>>except</span> ValueError:
<span class="line-number">189</span>                    <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">190</span>
<span class="line-number">191</span>            <span class="comment"># Handle logical operators</span>
<span class="line-number">192</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"&&"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:</span>
<span class="line-number">193</span><span class="uncovered">                parts = condition.split(<span class="string">"&&"</span>)</span>
<span class="line-number">194</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> all(</span>
<span class="line-number">195</span>                    self._evaluate_simple_expression(part.strip()) <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> parts
<span class="line-number">196</span>                )
<span class="line-number">197</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"||"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
<span class="line-number">198</span>                parts = condition.split(<span class="string">"||"</span>)
<span class="line-number">199</span>                <span class=<span class="string">"keyword"</span>>return</span> any(
</pre>
<h4>Lines 197-199</h4>
<pre>
<span class="line-number">192</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"&&"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
<span class="line-number">193</span>                parts = condition.split(<span class="string">"&&"</span>)
<span class="line-number">194</span>                <span class=<span class="string">"keyword"</span>>return</span> all(
<span class="line-number">195</span>                    self._evaluate_simple_expression(part.strip()) <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> parts
<span class="line-number">196</span>                )
<span class="line-number">197</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"||"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:</span>
<span class="line-number">198</span><span class="uncovered">                parts = condition.split(<span class="string">"||"</span>)</span>
<span class="line-number">199</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> any(</span>
<span class="line-number">200</span>                    self._evaluate_simple_expression(part.strip()) <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> parts
<span class="line-number">201</span>                )
<span class="line-number">202</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"!"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
<span class="line-number">203</span>                <span class="comment"># Simple negation</span>
<span class="line-number">204</span>                negated = condition.replace(<span class="string">"!"</span>, <span class="string">""</span>).strip()
</pre>
<h4>Line 202</h4>
<pre>
<span class="line-number">197</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"||"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
<span class="line-number">198</span>                parts = condition.split(<span class="string">"||"</span>)
<span class="line-number">199</span>                <span class=<span class="string">"keyword"</span>>return</span> any(
<span class="line-number">200</span>                    self._evaluate_simple_expression(part.strip()) <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> parts
<span class="line-number">201</span>                )
<span class="line-number">202</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"!"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:</span>
<span class="line-number">203</span>                <span class="comment"># Simple negation</span>
<span class="line-number">204</span>                negated = condition.replace(<span class="string">"!"</span>, <span class="string">""</span>).strip()
<span class="line-number">205</span>                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>not</span> self._evaluate_simple_expression(negated)
<span class="line-number">206</span>
<span class="line-number">207</span>            <span class="comment"># If it's just a macro name, check <span class="keyword">if</span> it's defined</span>
</pre>
<h4>Lines 204-205</h4>
<pre>
<span class="line-number">199</span>                <span class=<span class="string">"keyword"</span>>return</span> any(
<span class="line-number">200</span>                    self._evaluate_simple_expression(part.strip()) <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> parts
<span class="line-number">201</span>                )
<span class="line-number">202</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"!"</span> <span class=<span class="string">"keyword"</span>>in</span> condition:
<span class="line-number">203</span>                <span class="comment"># Simple negation</span>
<span class="line-number">204</span><span class="uncovered">                negated = condition.replace(<span class="string">"!"</span>, <span class="string">""</span>).strip()</span>
<span class="line-number">205</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>not</span> self._evaluate_simple_expression(negated)</span>
<span class="line-number">206</span>
<span class="line-number">207</span>            <span class="comment"># If it's just a macro name, check <span class="keyword">if</span> it's defined</span>
<span class="line-number">208</span>            <span class=<span class="string">"keyword"</span>>if</span> condition <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">209</span>                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">210</span>
</pre>
<h4>Lines 208-209</h4>
<pre>
<span class="line-number">203</span>                <span class="comment"># Simple negation</span>
<span class="line-number">204</span>                negated = condition.replace(<span class="string">"!"</span>, <span class="string">""</span>).strip()
<span class="line-number">205</span>                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>not</span> self._evaluate_simple_expression(negated)
<span class="line-number">206</span>
<span class="line-number">207</span>            <span class="comment"># If it's just a macro name, check <span class="keyword">if</span> it's defined</span>
<span class="line-number">208</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> condition <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:</span>
<span class="line-number">209</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">210</span>
<span class="line-number">211</span>            <span class="comment"># Try to evaluate <span class="keyword">as</span> a number</span>
<span class="line-number">212</span>            <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">213</span>                <span class=<span class="string">"keyword"</span>>return</span> bool(int(condition))
<span class="line-number">214</span>            <span class=<span class="string">"keyword"</span>>except</span> ValueError:
</pre>
<h4>Lines 212-215</h4>
<pre>
<span class="line-number">207</span>            <span class="comment"># If it's just a macro name, check <span class="keyword">if</span> it's defined</span>
<span class="line-number">208</span>            <span class=<span class="string">"keyword"</span>>if</span> condition <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">209</span>                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">210</span>
<span class="line-number">211</span>            <span class="comment"># Try to evaluate <span class="keyword">as</span> a number</span>
<span class="line-number">212</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>try</span>:</span>
<span class="line-number">213</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> bool(int(condition))</span>
<span class="line-number">214</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>except</span> ValueError:</span>
<span class="line-number">215</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>pass</span></span>
<span class="line-number">216</span>
<span class="line-number">217</span>            <span class="comment"># Default to <span class="keyword">True</span> <span class="keyword">for</span> unknown conditions (backward compatibility)</span>
<span class="line-number">218</span>            <span class="comment"># This ensures existing tests <span class="keyword">continue</span> to work</span>
<span class="line-number">219</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">220</span>
</pre>
<h4>Line 219</h4>
<pre>
<span class="line-number">214</span>            <span class=<span class="string">"keyword"</span>>except</span> ValueError:
<span class="line-number">215</span>                <span class=<span class="string">"keyword"</span>>pass</span>
<span class="line-number">216</span>
<span class="line-number">217</span>            <span class="comment"># Default to <span class="keyword">True</span> <span class="keyword">for</span> unknown conditions (backward compatibility)</span>
<span class="line-number">218</span>            <span class="comment"># This ensures existing tests <span class="keyword">continue</span> to work</span>
<span class="line-number">219</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">220</span>
<span class="line-number">221</span>        <span class=<span class="string">"keyword"</span>>except</span> ValueError <span class=<span class="string">"keyword"</span>>as</span> e:
<span class="line-number">222</span>            self.logger.<span class="function">warning</span>(
<span class="line-number">223</span>                <span class="string">"Error evaluating preprocessor condition <span class="string">'%s'</span>: %s"</span>, condition, e
<span class="line-number">224</span>            )
</pre>
<h4>Lines 221-222</h4>
<pre>
<span class="line-number">216</span>
<span class="line-number">217</span>            <span class="comment"># Default to <span class="keyword">True</span> <span class="keyword">for</span> unknown conditions (backward compatibility)</span>
<span class="line-number">218</span>            <span class="comment"># This ensures existing tests <span class="keyword">continue</span> to work</span>
<span class="line-number">219</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">220</span>
<span class="line-number">221</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>except</span> ValueError <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">222</span><span class="uncovered">            self.logger.<span class="function">warning</span>(</span>
<span class="line-number">223</span>                <span class="string">"Error evaluating preprocessor condition <span class="string">'%s'</span>: %s"</span>, condition, e
<span class="line-number">224</span>            )
<span class="line-number">225</span>            <span class="comment"># Default to <span class="keyword">True</span> <span class="keyword">for</span> unknown conditions (backward compatibility)</span>
<span class="line-number">226</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">227</span>
</pre>
<h4>Line 226</h4>
<pre>
<span class="line-number">221</span>        <span class=<span class="string">"keyword"</span>>except</span> ValueError <span class=<span class="string">"keyword"</span>>as</span> e:
<span class="line-number">222</span>            self.logger.<span class="function">warning</span>(
<span class="line-number">223</span>                <span class="string">"Error evaluating preprocessor condition <span class="string">'%s'</span>: %s"</span>, condition, e
<span class="line-number">224</span>            )
<span class="line-number">225</span>            <span class="comment"># Default to <span class="keyword">True</span> <span class="keyword">for</span> unknown conditions (backward compatibility)</span>
<span class="line-number">226</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">227</span>
<span class="line-number">228</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _evaluate_operand(self, operand: str) -> str:
<span class="line-number">229</span>        <span class="string">""</span><span class="string">"Evaluate an operand, expanding macros <span class="</span>keyword<span class="string">">if</span> they are defined."</span><span class="string">""</span>
<span class="line-number">230</span>        operand = operand.<span class="function">strip</span>()
<span class="line-number">231</span>
</pre>
<h4>Line 234</h4>
<pre>
<span class="line-number">229</span>        <span class="string">""</span><span class="string">"Evaluate an operand, expanding macros <span class="</span>keyword<span class="string">">if</span> they are defined."</span><span class="string">""</span>
<span class="line-number">230</span>        operand = operand.<span class="function">strip</span>()
<span class="line-number">231</span>
<span class="line-number">232</span>        <span class="comment"># If it's a defined macro, <span class="keyword">return</span> its value</span>
<span class="line-number">233</span>        <span class=<span class="string">"keyword"</span>>if</span> operand <span class=<span class="string">"keyword"</span>>in</span> self.defined_macros:
<span class="line-number">234</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> self.get_macro_value(operand)</span>
<span class="line-number">235</span>
<span class="line-number">236</span>        <span class="comment"># Otherwise, <span class="keyword">return</span> the operand <span class="keyword">as</span>-<span class="keyword">is</span></span>
<span class="line-number">237</span>        <span class=<span class="string">"keyword"</span>>return</span> operand
<span class="line-number">238</span>
<span class="line-number">239</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> parse_preprocessor_blocks(self, tokens: List[Token]) -> List[PreprocessorBlock]:
</pre>
<h4>Line 300</h4>
<pre>
<span class="line-number">295</span>                    <span class=<span class="string">"keyword"</span>>if</span> stack:
<span class="line-number">296</span>                        <span class="comment"># End current block</span>
<span class="line-number">297</span>                        current_block = stack.<span class="function">pop</span>()
<span class="line-number">298</span>                        current_block.end_token = i
<span class="line-number">299</span>
<span class="line-number">300</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>elif</span> directive == PreprocessorDirective.DEFINE:</span>
<span class="line-number">301</span>                    <span class="comment"># Handle #define</span>
<span class="line-number">302</span>                    macro_name, macro_value = self.<span class="function">_parse_define</span>(token.value)
<span class="line-number">303</span>                    self.<span class="function">add_define</span>(macro_name, macro_value)
<span class="line-number">304</span>
<span class="line-number">305</span>                <span class=<span class="string">"keyword"</span>>elif</span> directive == PreprocessorDirective.UNDEF:
</pre>
<h4>Lines 302-303</h4>
<pre>
<span class="line-number">297</span>                        current_block = stack.<span class="function">pop</span>()
<span class="line-number">298</span>                        current_block.end_token = i
<span class="line-number">299</span>
<span class="line-number">300</span>                <span class=<span class="string">"keyword"</span>>elif</span> directive == PreprocessorDirective.DEFINE:
<span class="line-number">301</span>                    <span class="comment"># Handle #define</span>
<span class="line-number">302</span><span class="uncovered">                    macro_name, macro_value = self.<span class="function">_parse_define</span>(token.value)</span>
<span class="line-number">303</span><span class="uncovered">                    self.<span class="function">add_define</span>(macro_name, macro_value)</span>
<span class="line-number">304</span>
<span class="line-number">305</span>                <span class=<span class="string">"keyword"</span>>elif</span> directive == PreprocessorDirective.UNDEF:
<span class="line-number">306</span>                    <span class="comment"># Handle #undef</span>
<span class="line-number">307</span>                    macro_name = self.<span class="function">_parse_undef</span>(token.value)
<span class="line-number">308</span>                    self.<span class="function">add_undef</span>(macro_name)
</pre>
<h4>Line 305</h4>
<pre>
<span class="line-number">300</span>                <span class=<span class="string">"keyword"</span>>elif</span> directive == PreprocessorDirective.DEFINE:
<span class="line-number">301</span>                    <span class="comment"># Handle #define</span>
<span class="line-number">302</span>                    macro_name, macro_value = self.<span class="function">_parse_define</span>(token.value)
<span class="line-number">303</span>                    self.<span class="function">add_define</span>(macro_name, macro_value)
<span class="line-number">304</span>
<span class="line-number">305</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>elif</span> directive == PreprocessorDirective.UNDEF:</span>
<span class="line-number">306</span>                    <span class="comment"># Handle #undef</span>
<span class="line-number">307</span>                    macro_name = self.<span class="function">_parse_undef</span>(token.value)
<span class="line-number">308</span>                    self.<span class="function">add_undef</span>(macro_name)
<span class="line-number">309</span>
<span class="line-number">310</span>            i += <span class="number">1</span>
</pre>
<h4>Lines 307-308</h4>
<pre>
<span class="line-number">302</span>                    macro_name, macro_value = self.<span class="function">_parse_define</span>(token.value)
<span class="line-number">303</span>                    self.<span class="function">add_define</span>(macro_name, macro_value)
<span class="line-number">304</span>
<span class="line-number">305</span>                <span class=<span class="string">"keyword"</span>>elif</span> directive == PreprocessorDirective.UNDEF:
<span class="line-number">306</span>                    <span class="comment"># Handle #undef</span>
<span class="line-number">307</span><span class="uncovered">                    macro_name = self.<span class="function">_parse_undef</span>(token.value)</span>
<span class="line-number">308</span><span class="uncovered">                    self.<span class="function">add_undef</span>(macro_name)</span>
<span class="line-number">309</span>
<span class="line-number">310</span>            i += <span class="number">1</span>
<span class="line-number">311</span>
<span class="line-number">312</span>        <span class=<span class="string">"keyword"</span>>return</span> blocks
<span class="line-number">313</span>
</pre>
<h4>Lines 329-332</h4>
<pre>
<span class="line-number">324</span>            <span class=<span class="string">"keyword"</span>>return</span> PreprocessorDirective.ELIF
<span class="line-number">325</span>        <span class="keyword">elif</span> value.startswith("<span class="comment">#<span class="keyword">else</span>"):</span>
<span class="line-number">326</span>            <span class=<span class="string">"keyword"</span>>return</span> PreprocessorDirective.ELSE
<span class="line-number">327</span>        <span class="keyword">elif</span> value.startswith("<span class="comment">#endif"):</span>
<span class="line-number">328</span>            <span class=<span class="string">"keyword"</span>>return</span> PreprocessorDirective.ENDIF
<span class="line-number">329</span><span class="uncovered">        <span class="keyword">elif</span> value.startswith("<span class="comment">#define"):</span></span>
<span class="line-number">330</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> PreprocessorDirective.DEFINE</span>
<span class="line-number">331</span><span class="uncovered">        <span class="keyword">elif</span> value.startswith("<span class="comment">#undef"):</span></span>
<span class="line-number">332</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> PreprocessorDirective.UNDEF</span>
<span class="line-number">333</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">334</span>            <span class="keyword">return</span> PreprocessorDirective.IF  <span class="comment"># Default</span>
<span class="line-number">335</span>
<span class="line-number">336</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _extract_condition(self, value: str, directive: PreprocessorDirective) -> str:
<span class="line-number">337</span>        <span class="string">""</span><span class="string">"Extract the condition <span class="</span>keyword<span class="string">">from</span> a preprocessor directive."</span><span class="string">""</span>
</pre>
<h4>Line 334</h4>
<pre>
<span class="line-number">329</span>        <span class="keyword">elif</span> value.startswith("<span class="comment">#define"):</span>
<span class="line-number">330</span>            <span class=<span class="string">"keyword"</span>>return</span> PreprocessorDirective.DEFINE
<span class="line-number">331</span>        <span class="keyword">elif</span> value.startswith("<span class="comment">#undef"):</span>
<span class="line-number">332</span>            <span class=<span class="string">"keyword"</span>>return</span> PreprocessorDirective.UNDEF
<span class="line-number">333</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">334</span><span class="uncovered">            <span class="keyword">return</span> PreprocessorDirective.IF  <span class="comment"># Default</span></span>
<span class="line-number">335</span>
<span class="line-number">336</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _extract_condition(self, value: str, directive: PreprocessorDirective) -> str:
<span class="line-number">337</span>        <span class="string">""</span><span class="string">"Extract the condition <span class="</span>keyword<span class="string">">from</span> a preprocessor directive."</span><span class="string">""</span>
<span class="line-number">338</span>        value = value.<span class="function">strip</span>()
<span class="line-number">339</span>
</pre>
<h4>Line 353</h4>
<pre>
<span class="line-number">348</span>            <span class=<span class="string">"keyword"</span>>return</span> match.group(1).strip() <span class=<span class="string">"keyword"</span>>if</span> match <span class=<span class="string">"keyword"</span>>else</span> <span class="string">""</span>
<span class="line-number">349</span>        <span class=<span class="string">"keyword"</span>>elif</span> directive == PreprocessorDirective.ELIF:
<span class="line-number">350</span>            match = re.search(r"<span class="comment">#<span class="keyword">elif</span>\s+(.+)", value)</span>
<span class="line-number">351</span>            <span class=<span class="string">"keyword"</span>>return</span> match.group(1).strip() <span class=<span class="string">"keyword"</span>>if</span> match <span class=<span class="string">"keyword"</span>>else</span> <span class="string">""</span>
<span class="line-number">352</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">353</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class="string">""</span></span>
<span class="line-number">354</span>
<span class="line-number">355</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_define(self, value: str) -> Tuple[str, str]:
<span class="line-number">356</span>        """Parse <span class="comment">#define directive."""</span>
<span class="line-number">357</span>        value = value.<span class="function">strip</span>()
<span class="line-number">358</span>        match = re.search(r"<span class="comment">#define\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*(.+)", value)</span>
</pre>
<h4>Lines 357-363</h4>
<pre>
<span class="line-number">352</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">353</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class="string">""</span>
<span class="line-number">354</span>
<span class="line-number">355</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_define(self, value: str) -> Tuple[str, str]:
<span class="line-number">356</span>        """Parse <span class="comment">#define directive."""</span>
<span class="line-number">357</span><span class="uncovered">        value = value.<span class="function">strip</span>()</span>
<span class="line-number">358</span><span class="uncovered">        match = re.search(r"<span class="comment">#define\s+([a-zA-Z_][a-zA-Z0-9_]*)\s*(.+)", value)</span></span>
<span class="line-number">359</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>if</span> match:</span>
<span class="line-number">360</span><span class="uncovered">            name = match.<span class="function">group</span>(<span class="number">1</span>)</span>
<span class="line-number">361</span><span class="uncovered">            macro_value = match.<span class="function">group</span>(<span class="number">2</span>).<span class="function">strip</span>()</span>
<span class="line-number">362</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> name, macro_value</span>
<span class="line-number">363</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> <span class="string">""</span>, <span class="string">""</span></span>
<span class="line-number">364</span>
<span class="line-number">365</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_undef(self, value: str) -> str:
<span class="line-number">366</span>        """Parse <span class="comment">#undef directive."""</span>
<span class="line-number">367</span>        value = value.<span class="function">strip</span>()
<span class="line-number">368</span>        match = re.search(r"<span class="comment">#undef\s+([a-zA-Z_][a-zA-Z0-9_]*)", value)</span>
</pre>
<h4>Lines 367-369</h4>
<pre>
<span class="line-number">362</span>            <span class=<span class="string">"keyword"</span>>return</span> name, macro_value
<span class="line-number">363</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class="string">""</span>, <span class="string">""</span>
<span class="line-number">364</span>
<span class="line-number">365</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_undef(self, value: str) -> str:
<span class="line-number">366</span>        """Parse <span class="comment">#undef directive."""</span>
<span class="line-number">367</span><span class="uncovered">        value = value.<span class="function">strip</span>()</span>
<span class="line-number">368</span><span class="uncovered">        match = re.search(r"<span class="comment">#undef\s+([a-zA-Z_][a-zA-Z0-9_]*)", value)</span></span>
<span class="line-number">369</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> match.group(1) <span class=<span class="string">"keyword"</span>>if</span> match <span class=<span class="string">"keyword"</span>>else</span> <span class="string">""</span></span>
<span class="line-number">370</span>
<span class="line-number">371</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _should_activate_block(
<span class="line-number">372</span>        self,
<span class="line-number">373</span>        directive: PreprocessorDirective,
<span class="line-number">374</span>        condition: str,
</pre>
<h4>Lines 394-395</h4>
<pre>
<span class="line-number">389</span>            <span class="comment"># For #<span class="keyword">elif</span>, we need to check <span class="keyword">if</span> no previous branch was taken</span>
<span class="line-number">390</span>            <span class=<span class="string">"keyword"</span>>if</span> stack:
<span class="line-number">391</span>                parent = stack[-<span class="number">1</span>]
<span class="line-number">392</span>                <span class="comment"># Check <span class="keyword">if</span> any previous child was active</span>
<span class="line-number">393</span>                <span class=<span class="string">"keyword"</span>>for</span> child <span class=<span class="string">"keyword"</span>>in</span> parent.children:
<span class="line-number">394</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>if</span> child.is_active:</span>
<span class="line-number">395</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">396</span>                <span class=<span class="string">"keyword"</span>>return</span> self.evaluate_condition(condition)
<span class="line-number">397</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">398</span>        <span class=<span class="string">"keyword"</span>>elif</span> directive == PreprocessorDirective.ELSE:
<span class="line-number">399</span>            <span class="comment"># For #<span class="keyword">else</span>, we need to check <span class="keyword">if</span> no previous branch was taken</span>
<span class="line-number">400</span>            <span class=<span class="string">"keyword"</span>>if</span> stack:
</pre>
<h4>Line 397</h4>
<pre>
<span class="line-number">392</span>                <span class="comment"># Check <span class="keyword">if</span> any previous child was active</span>
<span class="line-number">393</span>                <span class=<span class="string">"keyword"</span>>for</span> child <span class=<span class="string">"keyword"</span>>in</span> parent.children:
<span class="line-number">394</span>                    <span class=<span class="string">"keyword"</span>>if</span> child.is_active:
<span class="line-number">395</span>                        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">396</span>                <span class=<span class="string">"keyword"</span>>return</span> self.evaluate_condition(condition)
<span class="line-number">397</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">398</span>        <span class=<span class="string">"keyword"</span>>elif</span> directive == PreprocessorDirective.ELSE:
<span class="line-number">399</span>            <span class="comment"># For #<span class="keyword">else</span>, we need to check <span class="keyword">if</span> no previous branch was taken</span>
<span class="line-number">400</span>            <span class=<span class="string">"keyword"</span>>if</span> stack:
<span class="line-number">401</span>                parent = stack[-<span class="number">1</span>]
<span class="line-number">402</span>                <span class="comment"># Check <span class="keyword">if</span> any previous child was active</span>
</pre>
<h4>Lines 404-405</h4>
<pre>
<span class="line-number">399</span>            <span class="comment"># For #<span class="keyword">else</span>, we need to check <span class="keyword">if</span> no previous branch was taken</span>
<span class="line-number">400</span>            <span class=<span class="string">"keyword"</span>>if</span> stack:
<span class="line-number">401</span>                parent = stack[-<span class="number">1</span>]
<span class="line-number">402</span>                <span class="comment"># Check <span class="keyword">if</span> any previous child was active</span>
<span class="line-number">403</span>                <span class=<span class="string">"keyword"</span>>for</span> child <span class=<span class="string">"keyword"</span>>in</span> parent.children:
<span class="line-number">404</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>if</span> child.is_active:</span>
<span class="line-number">405</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">406</span>                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">407</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">408</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">409</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">410</span>
</pre>
<h4>Line 407</h4>
<pre>
<span class="line-number">402</span>                <span class="comment"># Check <span class="keyword">if</span> any previous child was active</span>
<span class="line-number">403</span>                <span class=<span class="string">"keyword"</span>>for</span> child <span class=<span class="string">"keyword"</span>>in</span> parent.children:
<span class="line-number">404</span>                    <span class=<span class="string">"keyword"</span>>if</span> child.is_active:
<span class="line-number">405</span>                        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">406</span>                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">407</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">408</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">409</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">410</span>
<span class="line-number">411</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> filter_tokens(self, tokens: List[Token]) -> List[Token]:
<span class="line-number">412</span>        <span class="string">""</span><span class="string">"Filter tokens based on preprocessor blocks, keeping only active content."</span><span class="string">""</span>
</pre>
<h4>Line 409</h4>
<pre>
<span class="line-number">404</span>                    <span class=<span class="string">"keyword"</span>>if</span> child.is_active:
<span class="line-number">405</span>                        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">406</span>                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">407</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">408</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">409</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">410</span>
<span class="line-number">411</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> filter_tokens(self, tokens: List[Token]) -> List[Token]:
<span class="line-number">412</span>        <span class="string">""</span><span class="string">"Filter tokens based on preprocessor blocks, keeping only active content."</span><span class="string">""</span>
<span class="line-number">413</span>        blocks = self.<span class="function">parse_preprocessor_blocks</span>(tokens)
<span class="line-number">414</span>        filtered_tokens = []
</pre>
<h4>Lines 471-472</h4>
<pre>
<span class="line-number">466</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> process_file(
<span class="line-number">467</span>        self, tokens: List[Token], defines: Optional[Dict[str, str]] = <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">468</span>    ) -> List[Token]:
<span class="line-number">469</span>        <span class="string">""</span><span class="string">"Process a file's tokens through the preprocessor."</span><span class="string">""</span>
<span class="line-number">470</span>        <span class=<span class="string">"keyword"</span>>if</span> defines:
<span class="line-number">471</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>for</span> name, value <span class=<span class="string">"keyword"</span>>in</span> defines.items():</span>
<span class="line-number">472</span><span class="uncovered">                self.evaluator.<span class="function">add_define</span>(name, value)</span>
<span class="line-number">473</span>
<span class="line-number">474</span>        <span class="comment"># Filter tokens based on preprocessor directives</span>
<span class="line-number">475</span>        filtered_tokens = self.evaluator.<span class="function">filter_tokens</span>(tokens)
<span class="line-number">476</span>
<span class="line-number">477</span>        self.logger.<span class="function">debug</span>(
</pre>
<h4>Lines 488-491</h4>
<pre>
<span class="line-number">483</span>        """Extract <span class="comment">#define directives <span class="keyword">from</span> tokens <span class="keyword">and</span> add them to the evaluator."""</span>
<span class="line-number">484</span>        <span class=<span class="string">"keyword"</span>>for</span> token <span class=<span class="string">"keyword"</span>>in</span> tokens:
<span class="line-number">485</span>            <span class=<span class="string">"keyword"</span>>if</span> token.type == TokenType.PREPROCESSOR <span class=<span class="string">"keyword"</span>>and</span> token.value.startswith(
<span class="line-number">486</span>                "<span class="comment">#define"</span>
<span class="line-number">487</span>            ):
<span class="line-number">488</span><span class="uncovered">                name, value = self.evaluator.<span class="function">_parse_define</span>(token.value)</span>
<span class="line-number">489</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>if</span> name:</span>
<span class="line-number">490</span><span class="uncovered">                    self.evaluator.<span class="function">add_define</span>(name, value)</span>
<span class="line-number">491</span><span class="uncovered">                    self.logger.debug(<span class="string">"Preprocessor: Added define %s = %s"</span>, name, value)</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/verifier.py - 84.17% coverage (117/139 lines)
</div>
<h4>Line 67</h4>
<pre>
<span class="line-number"> 62</span>
<span class="line-number"> 63</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _verify_file(self, file_path: str, file_model: FileModel) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number"> 64</span>        <span class="string">""</span><span class="string">"Verify a single file model"</span><span class="string">""</span>
<span class="line-number"> 65</span>        <span class="comment"># Verify file-level data</span>
<span class="line-number"> 66</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> file_model.file_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> file_model.file_path.strip():
<span class="line-number"> 67</span><span class="uncovered">            self.issues.append(f<span class="string">"File path <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)</span>
<span class="line-number"> 68</span>
<span class="line-number"> 69</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> file_model.relative_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> file_model.relative_path.strip():
<span class="line-number"> 70</span>            self.issues.append(f<span class="string">"Relative path <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number"> 71</span>
<span class="line-number"> 72</span>        <span class="comment"># Verify structs</span>
</pre>
<h4>Line 70</h4>
<pre>
<span class="line-number"> 65</span>        <span class="comment"># Verify file-level data</span>
<span class="line-number"> 66</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> file_model.file_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> file_model.file_path.strip():
<span class="line-number"> 67</span>            self.issues.append(f<span class="string">"File path <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number"> 68</span>
<span class="line-number"> 69</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> file_model.relative_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> file_model.relative_path.strip():
<span class="line-number"> 70</span><span class="uncovered">            self.issues.append(f<span class="string">"Relative path <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)</span>
<span class="line-number"> 71</span>
<span class="line-number"> 72</span>        <span class="comment"># Verify structs</span>
<span class="line-number"> 73</span>        <span class=<span class="string">"keyword"</span>>for</span> struct_name, struct <span class=<span class="string">"keyword"</span>>in</span> file_model.structs.items():
<span class="line-number"> 74</span>            self.<span class="function">_verify_struct</span>(file_path, struct_name, struct)
<span class="line-number"> 75</span>
</pre>
<h4>Line 111</h4>
<pre>
<span class="line-number">106</span>            self._verify_field(file_path, f<span class="string">"struct {struct_name}"</span>, field)
<span class="line-number">107</span>
<span class="line-number">108</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _verify_enum(self, file_path: str, enum_name: str, enum: Enum) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">109</span>        <span class="string">""</span><span class="string">"Verify an enum definition"</span><span class="string">""</span>
<span class="line-number">110</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(enum_name):
<span class="line-number">111</span><span class="uncovered">            self.issues.append(f<span class="string">"Invalid enum name <span class="string">'{enum_name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)</span>
<span class="line-number">112</span>
<span class="line-number">113</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> enum.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> enum.name.strip():
<span class="line-number">114</span>            self.issues.append(f<span class="string">"Enum name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number">115</span>
<span class="line-number">116</span>        <span class="comment"># Verify enum values</span>
</pre>
<h4>Line 114</h4>
<pre>
<span class="line-number">109</span>        <span class="string">""</span><span class="string">"Verify an enum definition"</span><span class="string">""</span>
<span class="line-number">110</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(enum_name):
<span class="line-number">111</span>            self.issues.append(f<span class="string">"Invalid enum name <span class="string">'{enum_name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number">112</span>
<span class="line-number">113</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> enum.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> enum.name.strip():
<span class="line-number">114</span><span class="uncovered">            self.issues.append(f<span class="string">"Enum name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)</span>
<span class="line-number">115</span>
<span class="line-number">116</span>        <span class="comment"># Verify enum values</span>
<span class="line-number">117</span>        <span class=<span class="string">"keyword"</span>>for</span> enum_value <span class=<span class="string">"keyword"</span>>in</span> enum.values:
<span class="line-number">118</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> enum_value.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> enum_value.name.strip():
<span class="line-number">119</span>                self.issues.<span class="function">append</span>(
</pre>
<h4>Line 119</h4>
<pre>
<span class="line-number">114</span>            self.issues.append(f<span class="string">"Enum name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number">115</span>
<span class="line-number">116</span>        <span class="comment"># Verify enum values</span>
<span class="line-number">117</span>        <span class=<span class="string">"keyword"</span>>for</span> enum_value <span class=<span class="string">"keyword"</span>>in</span> enum.values:
<span class="line-number">118</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> enum_value.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> enum_value.name.strip():
<span class="line-number">119</span><span class="uncovered">                self.issues.<span class="function">append</span>(</span>
<span class="line-number">120</span>                    f<span class="string">"Enum value name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> enum {enum_name} <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">121</span>                )
<span class="line-number">122</span>            <span class=<span class="string">"keyword"</span>>elif</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(enum_value.name):
<span class="line-number">123</span>                self.issues.<span class="function">append</span>(
<span class="line-number">124</span>                    f<span class="string">"Invalid enum value name <span class="string">'{enum_value.name}'</span> <span class="</span>keyword<span class="string">">in</span> enum {enum_name} <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
</pre>
<h4>Line 123</h4>
<pre>
<span class="line-number">118</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> enum_value.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> enum_value.name.strip():
<span class="line-number">119</span>                self.issues.<span class="function">append</span>(
<span class="line-number">120</span>                    f<span class="string">"Enum value name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> enum {enum_name} <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">121</span>                )
<span class="line-number">122</span>            <span class=<span class="string">"keyword"</span>>elif</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(enum_value.name):
<span class="line-number">123</span><span class="uncovered">                self.issues.<span class="function">append</span>(</span>
<span class="line-number">124</span>                    f<span class="string">"Invalid enum value name <span class="string">'{enum_value.name}'</span> <span class="</span>keyword<span class="string">">in</span> enum {enum_name} <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">125</span>                )
<span class="line-number">126</span>
<span class="line-number">127</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _verify_union(self, file_path: str, union_name: str, union: Union) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">128</span>        <span class="string">""</span><span class="string">"Verify a union definition"</span><span class="string">""</span>
</pre>
<h4>Line 130</h4>
<pre>
<span class="line-number">125</span>                )
<span class="line-number">126</span>
<span class="line-number">127</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _verify_union(self, file_path: str, union_name: str, union: Union) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">128</span>        <span class="string">""</span><span class="string">"Verify a union definition"</span><span class="string">""</span>
<span class="line-number">129</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(union_name):
<span class="line-number">130</span><span class="uncovered">            self.issues.append(f<span class="string">"Invalid union name <span class="string">'{union_name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)</span>
<span class="line-number">131</span>
<span class="line-number">132</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> union.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> union.name.strip():
<span class="line-number">133</span>            self.issues.append(f<span class="string">"Union name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number">134</span>
<span class="line-number">135</span>        <span class="comment"># Verify fields</span>
</pre>
<h4>Line 133</h4>
<pre>
<span class="line-number">128</span>        <span class="string">""</span><span class="string">"Verify a union definition"</span><span class="string">""</span>
<span class="line-number">129</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(union_name):
<span class="line-number">130</span>            self.issues.append(f<span class="string">"Invalid union name <span class="string">'{union_name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number">131</span>
<span class="line-number">132</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> union.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> union.name.strip():
<span class="line-number">133</span><span class="uncovered">            self.issues.append(f<span class="string">"Union name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)</span>
<span class="line-number">134</span>
<span class="line-number">135</span>        <span class="comment"># Verify fields</span>
<span class="line-number">136</span>        <span class=<span class="string">"keyword"</span>>for</span> field <span class=<span class="string">"keyword"</span>>in</span> union.fields:
<span class="line-number">137</span>            self._verify_field(file_path, f<span class="string">"union {union_name}"</span>, field)
<span class="line-number">138</span>
</pre>
<h4>Line 142</h4>
<pre>
<span class="line-number">137</span>            self._verify_field(file_path, f<span class="string">"union {union_name}"</span>, field)
<span class="line-number">138</span>
<span class="line-number">139</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _verify_function(self, file_path: str, function: Function) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">140</span>        <span class="string">""</span><span class="string">"Verify a function definition"</span><span class="string">""</span>
<span class="line-number">141</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> function.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> function.name.strip():
<span class="line-number">142</span><span class="uncovered">            self.issues.append(f<span class="string">"Function name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)</span>
<span class="line-number">143</span>        <span class=<span class="string">"keyword"</span>>elif</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(function.name):
<span class="line-number">144</span>            self.issues.<span class="function">append</span>(
<span class="line-number">145</span>                f<span class="string">"Invalid function name <span class="string">'{function.name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">146</span>            )
<span class="line-number">147</span>
</pre>
<h4>Line 144</h4>
<pre>
<span class="line-number">139</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _verify_function(self, file_path: str, function: Function) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">140</span>        <span class="string">""</span><span class="string">"Verify a function definition"</span><span class="string">""</span>
<span class="line-number">141</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> function.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> function.name.strip():
<span class="line-number">142</span>            self.issues.append(f<span class="string">"Function name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number">143</span>        <span class=<span class="string">"keyword"</span>>elif</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(function.name):
<span class="line-number">144</span><span class="uncovered">            self.issues.<span class="function">append</span>(</span>
<span class="line-number">145</span>                f<span class="string">"Invalid function name <span class="string">'{function.name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">146</span>            )
<span class="line-number">147</span>
<span class="line-number">148</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> function.return_type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> function.return_type.strip():
<span class="line-number">149</span>            self.issues.<span class="function">append</span>(
</pre>
<h4>Line 149</h4>
<pre>
<span class="line-number">144</span>            self.issues.<span class="function">append</span>(
<span class="line-number">145</span>                f<span class="string">"Invalid function name <span class="string">'{function.name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">146</span>            )
<span class="line-number">147</span>
<span class="line-number">148</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> function.return_type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> function.return_type.strip():
<span class="line-number">149</span><span class="uncovered">            self.issues.<span class="function">append</span>(</span>
<span class="line-number">150</span>                f<span class="string">"Function <span class="</span>keyword<span class="string">">return</span> type <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">for</span> <span class="string">'{function.name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">151</span>            )
<span class="line-number">152</span>
<span class="line-number">153</span>        <span class="comment"># Verify parameters (skip variadic parameter '...')</span>
<span class="line-number">154</span>        <span class=<span class="string">"keyword"</span>>for</span> param <span class=<span class="string">"keyword"</span>>in</span> function.parameters:
</pre>
<h4>Line 166</h4>
<pre>
<span class="line-number">161</span>        self._verify_field(file_path, <span class="string">"<span class="</span>keyword<span class="string">">global</span>"</span>, global_var)
<span class="line-number">162</span>
<span class="line-number">163</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _verify_alias(self, file_path: str, alias_name: str, alias: Alias) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">164</span>        <span class="string">""</span><span class="string">"Verify a type alias (typedef)"</span><span class="string">""</span>
<span class="line-number">165</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(alias_name):
<span class="line-number">166</span><span class="uncovered">            self.issues.append(f<span class="string">"Invalid alias name <span class="string">'{alias_name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)</span>
<span class="line-number">167</span>
<span class="line-number">168</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> alias.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> alias.name.strip():
<span class="line-number">169</span>            self.issues.append(f<span class="string">"Alias name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number">170</span>
<span class="line-number">171</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> alias.original_type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> alias.original_type.strip():
</pre>
<h4>Line 169</h4>
<pre>
<span class="line-number">164</span>        <span class="string">""</span><span class="string">"Verify a type alias (typedef)"</span><span class="string">""</span>
<span class="line-number">165</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(alias_name):
<span class="line-number">166</span>            self.issues.append(f<span class="string">"Invalid alias name <span class="string">'{alias_name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number">167</span>
<span class="line-number">168</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> alias.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> alias.name.strip():
<span class="line-number">169</span><span class="uncovered">            self.issues.append(f<span class="string">"Alias name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)</span>
<span class="line-number">170</span>
<span class="line-number">171</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> alias.original_type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> alias.original_type.strip():
<span class="line-number">172</span>            self.issues.<span class="function">append</span>(
<span class="line-number">173</span>                f<span class="string">"Alias original type <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">for</span> <span class="string">'{alias_name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">174</span>            )
</pre>
<h4>Line 172</h4>
<pre>
<span class="line-number">167</span>
<span class="line-number">168</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> alias.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> alias.name.strip():
<span class="line-number">169</span>            self.issues.append(f<span class="string">"Alias name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)
<span class="line-number">170</span>
<span class="line-number">171</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> alias.original_type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> alias.original_type.strip():
<span class="line-number">172</span><span class="uncovered">            self.issues.<span class="function">append</span>(</span>
<span class="line-number">173</span>                f<span class="string">"Alias original type <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">for</span> <span class="string">'{alias_name}'</span> <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">174</span>            )
<span class="line-number">175</span>
<span class="line-number">176</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _verify_field(self, file_path: str, context: str, field: Field) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">177</span>        <span class="string">""</span><span class="string">"Verify a field (struct field, function parameter, <span class="</span>keyword<span class="string">">global</span> variable)"</span><span class="string">""</span>
</pre>
<h4>Line 180</h4>
<pre>
<span class="line-number">175</span>
<span class="line-number">176</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _verify_field(self, file_path: str, context: str, field: Field) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">177</span>        <span class="string">""</span><span class="string">"Verify a field (struct field, function parameter, <span class="</span>keyword<span class="string">">global</span> variable)"</span><span class="string">""</span>
<span class="line-number">178</span>        <span class="comment"># Check <span class="keyword">for</span> invalid names</span>
<span class="line-number">179</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> field.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> field.name.strip():
<span class="line-number">180</span><span class="uncovered">            self.issues.append(f<span class="string">"Field name <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">in</span> {context} <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>)</span>
<span class="line-number">181</span>        <span class=<span class="string">"keyword"</span>>elif</span> <span class=<span class="string">"keyword"</span>>not</span> self._is_valid_identifier(field.name):
<span class="line-number">182</span>            self.issues.<span class="function">append</span>(
<span class="line-number">183</span>                f<span class="string">"Invalid field name <span class="string">'{field.name}'</span> <span class="</span>keyword<span class="string">">in</span> {context} <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">184</span>            )
<span class="line-number">185</span>
</pre>
<h4>Line 188</h4>
<pre>
<span class="line-number">183</span>                f<span class="string">"Invalid field name <span class="string">'{field.name}'</span> <span class="</span>keyword<span class="string">">in</span> {context} <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">184</span>            )
<span class="line-number">185</span>
<span class="line-number">186</span>        <span class="comment"># Check <span class="keyword">for</span> invalid types</span>
<span class="line-number">187</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> field.type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> field.type.strip():
<span class="line-number">188</span><span class="uncovered">            self.issues.<span class="function">append</span>(</span>
<span class="line-number">189</span>                f<span class="string">"Field type <span class="</span>keyword<span class="string">">is</span> empty <span class="</span>keyword<span class="string">">for</span> <span class="string">'{field.name}'</span> <span class="</span>keyword<span class="string">">in</span> {context} <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
<span class="line-number">190</span>            )
<span class="line-number">191</span>        <span class=<span class="string">"keyword"</span>>elif</span> self._is_suspicious_type(field.type):
<span class="line-number">192</span>            self.issues.<span class="function">append</span>(
<span class="line-number">193</span>                f<span class="string">"Suspicious field type <span class="string">'{field.type}'</span> <span class="</span>keyword<span class="string">">for</span> <span class="string">'{field.name}'</span> <span class="</span>keyword<span class="string">">in</span> {context} <span class="</span>keyword<span class="string">">in</span> {file_path}"</span>
</pre>
<h4>Line 213</h4>
<pre>
<span class="line-number">208</span>        <span class=<span class="string">"keyword"</span>>return</span> bool(re.match(r<span class="string">"^[a-zA-Z_][a-zA-Z0-9_]*$"</span>, name.strip()))
<span class="line-number">209</span>
<span class="line-number">210</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _is_suspicious_type(self, type_str: str) -> bool:
<span class="line-number">211</span>        <span class="string">""</span><span class="string">"Check <span class="</span>keyword<span class="string">">if</span> a type string looks suspicious"</span><span class="string">""</span>
<span class="line-number">212</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> type_str <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> type_str.strip():
<span class="line-number">213</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">214</span>
<span class="line-number">215</span>        type_str = type_str.<span class="function">strip</span>()
<span class="line-number">216</span>
<span class="line-number">217</span>        <span class="comment"># Check <span class="keyword">for</span> obvious parsing errors</span>
<span class="line-number">218</span>        suspicious_patterns = [
</pre>
<h4>Line 227</h4>
<pre>
<span class="line-number">222</span>            r"^[\[\]\{\}\(\)\s\\\n]*[\[\]\{\}\(\)\s\\\n]*[\[\]\{\}\(\)\s\\\n]*$",  <span class="comment"># Excessive brackets/whitespace</span>
<span class="line-number">223</span>        ]
<span class="line-number">224</span>
<span class="line-number">225</span>        <span class=<span class="string">"keyword"</span>>for</span> pattern <span class=<span class="string">"keyword"</span>>in</span> suspicious_patterns:
<span class="line-number">226</span>            <span class=<span class="string">"keyword"</span>>if</span> re.match(pattern, type_str):
<span class="line-number">227</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">228</span>
<span class="line-number">229</span>        <span class="comment"># Check <span class="keyword">for</span> unbalanced brackets</span>
<span class="line-number">230</span>        <span class=<span class="string">"keyword"</span>>if</span> self._has_unbalanced_brackets(type_str):
<span class="line-number">231</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">232</span>
</pre>
<h4>Line 235</h4>
<pre>
<span class="line-number">230</span>        <span class=<span class="string">"keyword"</span>>if</span> self._has_unbalanced_brackets(type_str):
<span class="line-number">231</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">232</span>
<span class="line-number">233</span>        <span class="comment"># Check <span class="keyword">for</span> excessive newlines <span class="keyword">or</span> backslashes</span>
<span class="line-number">234</span>        <span class=<span class="string">"keyword"</span>>if</span> type_str.count(<span class="string">"\n"</span>) > 5 <span class=<span class="string">"keyword"</span>>or</span> type_str.count(<span class="string">"\\"</span>) > 10:
<span class="line-number">235</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">236</span>
<span class="line-number">237</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">238</span>
<span class="line-number">239</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _is_suspicious_value(self, value: str) -> bool:
<span class="line-number">240</span>        <span class="string">""</span><span class="string">"Check <span class="</span>keyword<span class="string">">if</span> a value string looks suspicious"</span><span class="string">""</span>
</pre>
<h4>Line 242</h4>
<pre>
<span class="line-number">237</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">238</span>
<span class="line-number">239</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _is_suspicious_value(self, value: str) -> bool:
<span class="line-number">240</span>        <span class="string">""</span><span class="string">"Check <span class="</span>keyword<span class="string">">if</span> a value string looks suspicious"</span><span class="string">""</span>
<span class="line-number">241</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> value <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> value.strip():
<span class="line-number">242</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">243</span>
<span class="line-number">244</span>        value = value.<span class="function">strip</span>()
<span class="line-number">245</span>
<span class="line-number">246</span>        <span class="comment"># Check <span class="keyword">for</span> obvious parsing errors</span>
<span class="line-number">247</span>        suspicious_patterns = [
</pre>
<h4>Line 254</h4>
<pre>
<span class="line-number">249</span>            r"^[\[\]\{\}\(\)\s\\\n]*[\[\]\{\}\(\)\s\\\n]+$",  <span class="comment"># Mostly brackets <span class="keyword">and</span> whitespace</span>
<span class="line-number">250</span>        ]
<span class="line-number">251</span>
<span class="line-number">252</span>        <span class=<span class="string">"keyword"</span>>for</span> pattern <span class=<span class="string">"keyword"</span>>in</span> suspicious_patterns:
<span class="line-number">253</span>            <span class=<span class="string">"keyword"</span>>if</span> re.match(pattern, value):
<span class="line-number">254</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">255</span>
<span class="line-number">256</span>        <span class="comment"># Check <span class="keyword">for</span> unbalanced brackets</span>
<span class="line-number">257</span>        <span class=<span class="string">"keyword"</span>>if</span> self._has_unbalanced_brackets(value):
<span class="line-number">258</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">259</span>
</pre>
<h4>Line 262</h4>
<pre>
<span class="line-number">257</span>        <span class=<span class="string">"keyword"</span>>if</span> self._has_unbalanced_brackets(value):
<span class="line-number">258</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">259</span>
<span class="line-number">260</span>        <span class="comment"># Check <span class="keyword">for</span> excessive newlines <span class="keyword">or</span> backslashes</span>
<span class="line-number">261</span>        <span class=<span class="string">"keyword"</span>>if</span> value.count(<span class="string">"\n"</span>) > 3 <span class=<span class="string">"keyword"</span>>or</span> value.count(<span class="string">"\\"</span>) > 5:
<span class="line-number">262</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">263</span>
<span class="line-number">264</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">265</span>
<span class="line-number">266</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _has_unbalanced_brackets(self, text: str) -> bool:
<span class="line-number">267</span>        <span class="string">""</span><span class="string">"Check <span class="</span>keyword<span class="string">">if</span> text has unbalanced brackets"</span><span class="string">""</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/generator.py - 85.91% coverage (250/291 lines)
</div>
<h4>Line 79</h4>
<pre>
<span class="line-number"> 74</span>                <span class=<span class="string">"keyword"</span>>return</span> file_name
<span class="line-number"> 75</span>
<span class="line-number"> 76</span>            <span class="comment"># Try matching by filename</span>
<span class="line-number"> 77</span>            filename = <span class="function">Path</span>(file_name).name
<span class="line-number"> 78</span>            <span class=<span class="string">"keyword"</span>>if</span> filename <span class=<span class="string">"keyword"</span>>in</span> project_model.files:
<span class="line-number"> 79</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span> filename</span>
<span class="line-number"> 80</span>
<span class="line-number"> 81</span>            <span class="comment"># Try matching by relative path</span>
<span class="line-number"> 82</span>            <span class=<span class="string">"keyword"</span>>for</span> key <span class=<span class="string">"keyword"</span>>in</span> project_model.files.keys():
<span class="line-number"> 83</span>                <span class=<span class="string">"keyword"</span>>if</span> Path(key).name == filename:
<span class="line-number"> 84</span>                    <span class=<span class="string">"keyword"</span>>return</span> key
</pre>
<h4>Line 91</h4>
<pre>
<span class="line-number"> 86</span>            <span class="comment"># If <span class="keyword">not</span> found, <span class="keyword">return</span> the filename (will be handled gracefully)</span>
<span class="line-number"> 87</span>            <span class=<span class="string">"keyword"</span>>return</span> filename
<span class="line-number"> 88</span>
<span class="line-number"> 89</span>        <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> add_file_to_tree(file_name: str, depth: int):
<span class="line-number"> 90</span>            <span class=<span class="string">"keyword"</span>>if</span> depth > include_depth <span class=<span class="string">"keyword"</span>>or</span> file_name <span class=<span class="string">"keyword"</span>>in</span> visited:
<span class="line-number"> 91</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>return</span></span>
<span class="line-number"> 92</span>
<span class="line-number"> 93</span>            visited.<span class="function">add</span>(file_name)
<span class="line-number"> 94</span>            file_key = <span class="function">find_file_key</span>(file_name)
<span class="line-number"> 95</span>
<span class="line-number"> 96</span>            <span class=<span class="string">"keyword"</span>>if</span> file_key <span class=<span class="string">"keyword"</span>>in</span> project_model.files:
</pre>
<h4>Line 152</h4>
<pre>
<span class="line-number">147</span>        <span class="comment"># Find the UML ID <span class="keyword">for</span> this file using filename</span>
<span class="line-number">148</span>        filename = <span class="function">Path</span>(file_model.relative_path).name
<span class="line-number">149</span>        uml_id = uml_ids.<span class="function">get</span>(filename)
<span class="line-number">150</span>
<span class="line-number">151</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> uml_id:
<span class="line-number">152</span><span class="uncovered">            <span class="keyword">return</span>  <span class="comment"># Skip <span class="keyword">if</span> no UML ID found</span></span>
<span class="line-number">153</span>
<span class="line-number">154</span>        lines.append(f'<span class="keyword">class</span> "{basename}" <span class="keyword">as</span> {uml_id} <<source>> <span class="comment">#LightBlue')</span>
<span class="line-number">155</span>        lines.append(<span class="string">"{"</span>)
<span class="line-number">156</span>
<span class="line-number">157</span>        <span class="comment"># Add macros</span>
</pre>
<h4>Lines 163-165</h4>
<pre>
<span class="line-number">158</span>        <span class=<span class="string">"keyword"</span>>if</span> file_model.macros:
<span class="line-number">159</span>            lines.append(<span class="string">"    -- Macros --"</span>)
<span class="line-number">160</span>            <span class=<span class="string">"keyword"</span>>for</span> macro <span class=<span class="string">"keyword"</span>>in</span> sorted(file_model.macros):
<span class="line-number">161</span>                <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"("</span> <span class=<span class="string">"keyword"</span>>in</span> macro <span class=<span class="string">"keyword"</span>>and</span> <span class="string">")"</span> <span class=<span class="string">"keyword"</span>>in</span> macro:
<span class="line-number">162</span>                    <span class="comment"># Function-like macro</span>
<span class="line-number">163</span><span class="uncovered">                    macro_name = macro.split("(")[0].replace("<span class="comment">#define ", "")</span></span>
<span class="line-number">164</span><span class="uncovered">                    params = macro.split(<span class="string">"("</span>)[1].split(<span class="string">")"</span>)[0]</span>
<span class="line-number">165</span><span class="uncovered">                    lines.append(f"    - <span class="comment">#define {macro_name}({params})")</span></span>
<span class="line-number">166</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">167</span>                    <span class="comment"># Simple macro</span>
<span class="line-number">168</span>                    macro_name = macro.replace("<span class="comment">#define ", "")</span>
<span class="line-number">169</span>                    lines.append(f"    - <span class="comment">#define {macro_name}")</span>
<span class="line-number">170</span>
</pre>
<h4>Line 185</h4>
<pre>
<span class="line-number">180</span>            <span class=<span class="string">"keyword"</span>>for</span> func <span class=<span class="string">"keyword"</span>>in</span> sorted(file_model.functions, key=<span class=<span class="string">"keyword"</span>>lambda</span> x: x.name):
<span class="line-number">181</span>                <span class="keyword">if</span> <span class="keyword">not</span> func.is_declaration:  <span class="comment"># Only implementation, <span class="keyword">not</span> declarations</span>
<span class="line-number">182</span>                    params = []
<span class="line-number">183</span>                    <span class=<span class="string">"keyword"</span>>for</span> p <span class=<span class="string">"keyword"</span>>in</span> func.parameters:
<span class="line-number">184</span>                        <span class=<span class="string">"keyword"</span>>if</span> p.name == <span class="string">"..."</span> <span class=<span class="string">"keyword"</span>>and</span> p.type == <span class="string">"..."</span>:
<span class="line-number">185</span><span class="uncovered">                            params.append(<span class="string">"..."</span>)</span>
<span class="line-number">186</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">187</span>                            params.append(f<span class="string">"{p.type} {p.name}"</span>)
<span class="line-number">188</span>                    param_str = <span class="string">", "</span>.join(params)
<span class="line-number">189</span>                    lines.append(f<span class="string">"    {func.return_type} {func.name}({param_str})"</span>)
<span class="line-number">190</span>
</pre>
<h4>Line 205</h4>
<pre>
<span class="line-number">200</span>        <span class="comment"># Find the UML ID <span class="keyword">for</span> this file using filename</span>
<span class="line-number">201</span>        filename = <span class="function">Path</span>(file_model.relative_path).name
<span class="line-number">202</span>        uml_id = uml_ids.<span class="function">get</span>(filename)
<span class="line-number">203</span>
<span class="line-number">204</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> uml_id:
<span class="line-number">205</span><span class="uncovered">            <span class="keyword">return</span>  <span class="comment"># Skip <span class="keyword">if</span> no UML ID found</span></span>
<span class="line-number">206</span>
<span class="line-number">207</span>        lines.append(f'<span class="keyword">class</span> "{basename}" <span class="keyword">as</span> {uml_id} <<header>> <span class="comment">#LightGreen')</span>
<span class="line-number">208</span>        lines.append(<span class="string">"{"</span>)
<span class="line-number">209</span>
<span class="line-number">210</span>        <span class="comment"># Add macros</span>
</pre>
<h4>Lines 216-218</h4>
<pre>
<span class="line-number">211</span>        <span class=<span class="string">"keyword"</span>>if</span> file_model.macros:
<span class="line-number">212</span>            lines.append(<span class="string">"    -- Macros --"</span>)
<span class="line-number">213</span>            <span class=<span class="string">"keyword"</span>>for</span> macro <span class=<span class="string">"keyword"</span>>in</span> sorted(file_model.macros):
<span class="line-number">214</span>                <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"("</span> <span class=<span class="string">"keyword"</span>>in</span> macro <span class=<span class="string">"keyword"</span>>and</span> <span class="string">")"</span> <span class=<span class="string">"keyword"</span>>in</span> macro:
<span class="line-number">215</span>                    <span class="comment"># Function-like macro</span>
<span class="line-number">216</span><span class="uncovered">                    macro_name = macro.split("(")[0].replace("<span class="comment">#define ", "")</span></span>
<span class="line-number">217</span><span class="uncovered">                    params = macro.split(<span class="string">"("</span>)[1].split(<span class="string">")"</span>)[0]</span>
<span class="line-number">218</span><span class="uncovered">                    lines.append(f"    + <span class="comment">#define {macro_name}({params})")</span></span>
<span class="line-number">219</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">220</span>                    <span class="comment"># Simple macro</span>
<span class="line-number">221</span>                    macro_name = macro.replace("<span class="comment">#define ", "")</span>
<span class="line-number">222</span>                    lines.append(f"    + <span class="comment">#define {macro_name}")</span>
<span class="line-number">223</span>
</pre>
<h4>Line 274</h4>
<pre>
<span class="line-number">269</span>                    f'<span class="keyword">class</span> "{enum_name}" <span class="keyword">as</span> {uml_id} <<typedef>> <span class="comment">#LightYellow'</span>
<span class="line-number">270</span>                )
<span class="line-number">271</span>                lines.append(<span class="string">"{"</span>)
<span class="line-number">272</span>                <span class=<span class="string">"keyword"</span>>for</span> value <span class=<span class="string">"keyword"</span>>in</span> sorted(enum_data.values, key=<span class=<span class="string">"keyword"</span>>lambda</span> x: x.name):
<span class="line-number">273</span>                    <span class=<span class="string">"keyword"</span>>if</span> value.value:
<span class="line-number">274</span><span class="uncovered">                        lines.append(f<span class="string">"    + {value.name} = {value.value}"</span>)</span>
<span class="line-number">275</span>                    <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">276</span>                        lines.append(f<span class="string">"    + {value.name}"</span>)
<span class="line-number">277</span>                lines.append(<span class="string">"}"</span>)
<span class="line-number">278</span>                lines.append(<span class="string">""</span>)
<span class="line-number">279</span>
</pre>
<h4>Line 298</h4>
<pre>
<span class="line-number">293</span>                <span class=<span class="string">"keyword"</span>>for</span> i, line <span class=<span class="string">"keyword"</span>>in</span> enumerate(alias_lines):
<span class="line-number">294</span>                    line = line.<span class="function">strip</span>()
<span class="line-number">295</span>
<span class="line-number">296</span>                    <span class=<span class="string">"keyword"</span>>if</span> i == 0:
<span class="line-number">297</span>                        lines.append(f<span class="string">"    + {line}"</span>)
<span class="line-number">298</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>elif</span> line.startswith(<span class="string">"struct {"</span>):</span>
<span class="line-number">299</span>                        <span class="comment"># Start collecting nested struct content</span>
<span class="line-number">300</span>                        inside_struct = <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">301</span>                        nested_content = []
<span class="line-number">302</span>                    <span class=<span class="string">"keyword"</span>>elif</span> line == <span class="string">"}"</span>:
<span class="line-number">303</span>                        <span class=<span class="string">"keyword"</span>>if</span> inside_struct:
</pre>
<h4>Lines 300-303</h4>
<pre>
<span class="line-number">295</span>
<span class="line-number">296</span>                    <span class=<span class="string">"keyword"</span>>if</span> i == 0:
<span class="line-number">297</span>                        lines.append(f<span class="string">"    + {line}"</span>)
<span class="line-number">298</span>                    <span class=<span class="string">"keyword"</span>>elif</span> line.startswith(<span class="string">"struct {"</span>):
<span class="line-number">299</span>                        <span class="comment"># Start collecting nested struct content</span>
<span class="line-number">300</span><span class="uncovered">                        inside_struct = <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">301</span><span class="uncovered">                        nested_content = []</span>
<span class="line-number">302</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>elif</span> line == <span class="string">"}"</span>:</span>
<span class="line-number">303</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>if</span> inside_struct:</span>
<span class="line-number">304</span>                            <span class="comment"># Close nested struct <span class="keyword">with</span> flattened content</span>
<span class="line-number">305</span>                            <span class=<span class="string">"keyword"</span>>if</span> nested_content:
<span class="line-number">306</span>                                content_str = <span class="string">"; "</span>.join(nested_content)
<span class="line-number">307</span>                                lines.append(f<span class="string">"    + struct {{ {content_str} }}"</span>)
<span class="line-number">308</span>                            <span class=<span class="string">"keyword"</span>>else</span>:
</pre>
<h4>Lines 305-307</h4>
<pre>
<span class="line-number">300</span>                        inside_struct = <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">301</span>                        nested_content = []
<span class="line-number">302</span>                    <span class=<span class="string">"keyword"</span>>elif</span> line == <span class="string">"}"</span>:
<span class="line-number">303</span>                        <span class=<span class="string">"keyword"</span>>if</span> inside_struct:
<span class="line-number">304</span>                            <span class="comment"># Close nested struct <span class="keyword">with</span> flattened content</span>
<span class="line-number">305</span><span class="uncovered">                            <span class=<span class="string">"keyword"</span>>if</span> nested_content:</span>
<span class="line-number">306</span><span class="uncovered">                                content_str = <span class="string">"; "</span>.join(nested_content)</span>
<span class="line-number">307</span><span class="uncovered">                                lines.append(f<span class="string">"    + struct {{ {content_str} }}"</span>)</span>
<span class="line-number">308</span>                            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">309</span>                                lines.append(f<span class="string">"    + struct {{ }}"</span>)
<span class="line-number">310</span>                            inside_struct = <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">311</span>                            nested_content = []
<span class="line-number">312</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
</pre>
<h4>Lines 309-311</h4>
<pre>
<span class="line-number">304</span>                            <span class="comment"># Close nested struct <span class="keyword">with</span> flattened content</span>
<span class="line-number">305</span>                            <span class=<span class="string">"keyword"</span>>if</span> nested_content:
<span class="line-number">306</span>                                content_str = <span class="string">"; "</span>.join(nested_content)
<span class="line-number">307</span>                                lines.append(f<span class="string">"    + struct {{ {content_str} }}"</span>)
<span class="line-number">308</span>                            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">309</span><span class="uncovered">                                lines.append(f<span class="string">"    + struct {{ }}"</span>)</span>
<span class="line-number">310</span><span class="uncovered">                            inside_struct = <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">311</span><span class="uncovered">                            nested_content = []</span>
<span class="line-number">312</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">313</span>                            lines.append(f<span class="string">"    }}"</span>)
<span class="line-number">314</span>                    <span class=<span class="string">"keyword"</span>>elif</span> line <span class=<span class="string">"keyword"</span>>and</span> line != <span class="string">"}"</span>:
<span class="line-number">315</span>                        <span class=<span class="string">"keyword"</span>>if</span> inside_struct:
<span class="line-number">316</span>                            nested_content.append(line)  <span class="comment"># Collect nested content</span>
</pre>
<h4>Lines 313-316</h4>
<pre>
<span class="line-number">308</span>                            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">309</span>                                lines.append(f<span class="string">"    + struct {{ }}"</span>)
<span class="line-number">310</span>                            inside_struct = <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">311</span>                            nested_content = []
<span class="line-number">312</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">313</span><span class="uncovered">                            lines.append(f<span class="string">"    }}"</span>)</span>
<span class="line-number">314</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>elif</span> line <span class=<span class="string">"keyword"</span>>and</span> line != <span class="string">"}"</span>:</span>
<span class="line-number">315</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>if</span> inside_struct:</span>
<span class="line-number">316</span><span class="uncovered">                            nested_content.append(line)  <span class="comment"># Collect nested content</span></span>
<span class="line-number">317</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">318</span>                            lines.append(f<span class="string">"+ {line}"</span>)
<span class="line-number">319</span>
<span class="line-number">320</span>                <span class="comment"># If we were inside a struct but didn't find a closing brace, add one</span>
<span class="line-number">321</span>                <span class=<span class="string">"keyword"</span>>if</span> inside_struct <span class=<span class="string">"keyword"</span>>and</span> nested_content:
</pre>
<h4>Line 318</h4>
<pre>
<span class="line-number">313</span>                            lines.append(f<span class="string">"    }}"</span>)
<span class="line-number">314</span>                    <span class=<span class="string">"keyword"</span>>elif</span> line <span class=<span class="string">"keyword"</span>>and</span> line != <span class="string">"}"</span>:
<span class="line-number">315</span>                        <span class=<span class="string">"keyword"</span>>if</span> inside_struct:
<span class="line-number">316</span>                            nested_content.append(line)  <span class="comment"># Collect nested content</span>
<span class="line-number">317</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">318</span><span class="uncovered">                            lines.append(f<span class="string">"+ {line}"</span>)</span>
<span class="line-number">319</span>
<span class="line-number">320</span>                <span class="comment"># If we were inside a struct but didn't find a closing brace, add one</span>
<span class="line-number">321</span>                <span class=<span class="string">"keyword"</span>>if</span> inside_struct <span class=<span class="string">"keyword"</span>>and</span> nested_content:
<span class="line-number">322</span>                    content_str = <span class="string">"; "</span>.join(nested_content)
<span class="line-number">323</span>                    lines.append(f<span class="string">"    + struct {{ {content_str} }}"</span>)
</pre>
<h4>Lines 322-323</h4>
<pre>
<span class="line-number">317</span>                        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">318</span>                            lines.append(f<span class="string">"+ {line}"</span>)
<span class="line-number">319</span>
<span class="line-number">320</span>                <span class="comment"># If we were inside a struct but didn't find a closing brace, add one</span>
<span class="line-number">321</span>                <span class=<span class="string">"keyword"</span>>if</span> inside_struct <span class=<span class="string">"keyword"</span>>and</span> nested_content:
<span class="line-number">322</span><span class="uncovered">                    content_str = <span class="string">"; "</span>.join(nested_content)</span>
<span class="line-number">323</span><span class="uncovered">                    lines.append(f<span class="string">"    + struct {{ {content_str} }}"</span>)</span>
<span class="line-number">324</span>                lines.append(<span class="string">"}"</span>)
<span class="line-number">325</span>                lines.append(<span class="string">""</span>)
<span class="line-number">326</span>
<span class="line-number">327</span>        <span class="comment"># Unions</span>
<span class="line-number">328</span>        <span class=<span class="string">"keyword"</span>>for</span> union_name, union_data <span class=<span class="string">"keyword"</span>>in</span> sorted(file_model.unions.items()):
</pre>
<h4>Line 347</h4>
<pre>
<span class="line-number">342</span>        field_text = f<span class="string">"{field.type} {field.name}"</span>
<span class="line-number">343</span>
<span class="line-number">344</span>        <span class="comment"># Check <span class="keyword">if</span> this <span class="keyword">is</span> a nested struct field</span>
<span class="line-number">345</span>        <span class=<span class="string">"keyword"</span>>if</span> field.type.startswith(<span class="string">"struct {"</span>) <span class=<span class="string">"keyword"</span>>and</span> <span class="string">'\n'</span> <span class=<span class="string">"keyword"</span>>in</span> field.type:
<span class="line-number">346</span>            <span class="comment"># Parse the nested struct content <span class="keyword">and</span> flatten it</span>
<span class="line-number">347</span><span class="uncovered">            struct_parts = field.type.split(<span class="string">'\n'</span>)</span>
<span class="line-number">348</span>
<span class="line-number">349</span>            <span class="comment"># For nested structs, flatten them to avoid PlantUML parsing issues</span>
<span class="line-number">350</span>            <span class="comment"># Format <span class="keyword">as</span>: + struct { field_type field_name }</span>
<span class="line-number">351</span>            nested_content = []
<span class="line-number">352</span>            <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> struct_parts[1:]:
</pre>
<h4>Lines 351-355</h4>
<pre>
<span class="line-number">346</span>            <span class="comment"># Parse the nested struct content <span class="keyword">and</span> flatten it</span>
<span class="line-number">347</span>            struct_parts = field.type.split(<span class="string">'\n'</span>)
<span class="line-number">348</span>
<span class="line-number">349</span>            <span class="comment"># For nested structs, flatten them to avoid PlantUML parsing issues</span>
<span class="line-number">350</span>            <span class="comment"># Format <span class="keyword">as</span>: + struct { field_type field_name }</span>
<span class="line-number">351</span><span class="uncovered">            nested_content = []</span>
<span class="line-number">352</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> struct_parts[1:]:</span>
<span class="line-number">353</span><span class="uncovered">                part = part.<span class="function">strip</span>()</span>
<span class="line-number">354</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>if</span> part <span class=<span class="string">"keyword"</span>>and</span> part != <span class="string">"}"</span>:</span>
<span class="line-number">355</span><span class="uncovered">                    nested_content.<span class="function">append</span>(part)</span>
<span class="line-number">356</span>
<span class="line-number">357</span>            <span class=<span class="string">"keyword"</span>>if</span> nested_content:
<span class="line-number">358</span>                <span class="comment"># Create a flattened representation</span>
<span class="line-number">359</span>                content_str = <span class="string">"; "</span>.join(nested_content)
<span class="line-number">360</span>                lines.append(f<span class="string">"{base_indent}+ struct {{ {content_str} }} {field.name}"</span>)
</pre>
<h4>Line 357</h4>
<pre>
<span class="line-number">352</span>            <span class=<span class="string">"keyword"</span>>for</span> part <span class=<span class="string">"keyword"</span>>in</span> struct_parts[1:]:
<span class="line-number">353</span>                part = part.<span class="function">strip</span>()
<span class="line-number">354</span>                <span class=<span class="string">"keyword"</span>>if</span> part <span class=<span class="string">"keyword"</span>>and</span> part != <span class="string">"}"</span>:
<span class="line-number">355</span>                    nested_content.<span class="function">append</span>(part)
<span class="line-number">356</span>
<span class="line-number">357</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> nested_content:</span>
<span class="line-number">358</span>                <span class="comment"># Create a flattened representation</span>
<span class="line-number">359</span>                content_str = <span class="string">"; "</span>.join(nested_content)
<span class="line-number">360</span>                lines.append(f<span class="string">"{base_indent}+ struct {{ {content_str} }} {field.name}"</span>)
<span class="line-number">361</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">362</span>                lines.append(f<span class="string">"{base_indent}+ struct {{ }} {field.name}"</span>)
</pre>
<h4>Lines 359-360</h4>
<pre>
<span class="line-number">354</span>                <span class=<span class="string">"keyword"</span>>if</span> part <span class=<span class="string">"keyword"</span>>and</span> part != <span class="string">"}"</span>:
<span class="line-number">355</span>                    nested_content.<span class="function">append</span>(part)
<span class="line-number">356</span>
<span class="line-number">357</span>            <span class=<span class="string">"keyword"</span>>if</span> nested_content:
<span class="line-number">358</span>                <span class="comment"># Create a flattened representation</span>
<span class="line-number">359</span><span class="uncovered">                content_str = <span class="string">"; "</span>.join(nested_content)</span>
<span class="line-number">360</span><span class="uncovered">                lines.append(f<span class="string">"{base_indent}+ struct {{ {content_str} }} {field.name}"</span>)</span>
<span class="line-number">361</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">362</span>                lines.append(f<span class="string">"{base_indent}+ struct {{ }} {field.name}"</span>)
<span class="line-number">363</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">364</span>            <span class="comment"># Handle regular multi-line field types</span>
<span class="line-number">365</span>            field_lines = field_text.split(<span class="string">'\n'</span>)
</pre>
<h4>Line 362</h4>
<pre>
<span class="line-number">357</span>            <span class=<span class="string">"keyword"</span>>if</span> nested_content:
<span class="line-number">358</span>                <span class="comment"># Create a flattened representation</span>
<span class="line-number">359</span>                content_str = <span class="string">"; "</span>.join(nested_content)
<span class="line-number">360</span>                lines.append(f<span class="string">"{base_indent}+ struct {{ {content_str} }} {field.name}"</span>)
<span class="line-number">361</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">362</span><span class="uncovered">                lines.append(f<span class="string">"{base_indent}+ struct {{ }} {field.name}"</span>)</span>
<span class="line-number">363</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">364</span>            <span class="comment"># Handle regular multi-line field types</span>
<span class="line-number">365</span>            field_lines = field_text.split(<span class="string">'\n'</span>)
<span class="line-number">366</span>            <span class=<span class="string">"keyword"</span>>for</span> i, line <span class=<span class="string">"keyword"</span>>in</span> enumerate(field_lines):
<span class="line-number">367</span>                <span class=<span class="string">"keyword"</span>>if</span> i == 0:
</pre>
<h4>Line 370</h4>
<pre>
<span class="line-number">365</span>            field_lines = field_text.split(<span class="string">'\n'</span>)
<span class="line-number">366</span>            <span class=<span class="string">"keyword"</span>>for</span> i, line <span class=<span class="string">"keyword"</span>>in</span> enumerate(field_lines):
<span class="line-number">367</span>                <span class=<span class="string">"keyword"</span>>if</span> i == 0:
<span class="line-number">368</span>                    lines.append(f<span class="string">"{base_indent}+ {line}"</span>)
<span class="line-number">369</span>                <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">370</span><span class="uncovered">                    lines.append(f<span class="string">"+ {line}"</span>)</span>
<span class="line-number">371</span>
<span class="line-number">372</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _generate_relationships(
<span class="line-number">373</span>        self,
<span class="line-number">374</span>        lines: List[str],
<span class="line-number">375</span>        include_tree: Dict[str, FileModel],
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/utils.py - 61.19% coverage (41/67 lines)
</div>
<h4>Line 13</h4>
<pre>
<span class="line-number">  8</span><span class=<span class="string">"keyword"</span>>from</span> typing <span class=<span class="string">"keyword"</span>>import</span> Dict, Optional
<span class="line-number">  9</span>
<span class="line-number"> 10</span><span class="comment"># Try to <span class="keyword">import</span> chardet, fallback to basic encoding detection <span class="keyword">if</span> <span class="keyword">not</span> available</span>
<span class="line-number"> 11</span><span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number"> 12</span>    <span class=<span class="string">"keyword"</span>>import</span> chardet
<span class="line-number"> 13</span><span class="uncovered">    CHARDET_AVAILABLE = <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number"> 14</span><span class=<span class="string">"keyword"</span>>except</span> ImportError:
<span class="line-number"> 15</span>    CHARDET_AVAILABLE = <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number"> 16</span>
<span class="line-number"> 17</span>
<span class="line-number"> 18</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> detect_file_encoding(file_path: Path) -> str:
</pre>
<h4>Lines 23-28</h4>
<pre>
<span class="line-number"> 18</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> detect_file_encoding(file_path: Path) -> str:
<span class="line-number"> 19</span>    <span class="string">""</span><span class="string">"Detect file encoding <span class="</span>keyword<span class="string">">with</span> platform-aware fallbacks"</span><span class="string">""</span>
<span class="line-number"> 20</span>    <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number"> 21</span>        <span class=<span class="string">"keyword"</span>>if</span> CHARDET_AVAILABLE:
<span class="line-number"> 22</span>            <span class="comment"># Try to detect encoding <span class="keyword">with</span> chardet</span>
<span class="line-number"> 23</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>with</span> open(file_path, <span class="string">"rb"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:</span>
<span class="line-number"> 24</span><span class="uncovered">                raw_data = f.read(1024)  <span class="comment"># Read first 1KB <span class="keyword">for</span> detection</span></span>
<span class="line-number"> 25</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>if</span> raw_data:</span>
<span class="line-number"> 26</span><span class="uncovered">                    result = chardet.<span class="function">detect</span>(raw_data)</span>
<span class="line-number"> 27</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>if</span> result <span class=<span class="string">"keyword"</span>>and</span> result[<span class="string">"confidence"</span>] > 0.7:</span>
<span class="line-number"> 28</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>return</span> result[<span class="string">"encoding"</span>]</span>
<span class="line-number"> 29</span>
<span class="line-number"> 30</span>        <span class="comment"># Fallback encodings <span class="keyword">in</span> order of preference</span>
<span class="line-number"> 31</span>        fallback_encodings = [<span class="string">"utf-8"</span>, <span class="string">"latin-1"</span>, <span class="string">"cp1252"</span>, <span class="string">"iso-8859-1"</span>]
<span class="line-number"> 32</span>
<span class="line-number"> 33</span>        <span class=<span class="string">"keyword"</span>>for</span> encoding <span class=<span class="string">"keyword"</span>>in</span> fallback_encodings:
</pre>
<h4>Line 39</h4>
<pre>
<span class="line-number"> 34</span>            <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number"> 35</span>                <span class=<span class="string">"keyword"</span>>with</span> open(file_path, <span class="string">"r"</span>, encoding=encoding) <span class=<span class="string">"keyword"</span>>as</span> f:
<span class="line-number"> 36</span>                    f.read(1024)  <span class="comment"># Test read</span>
<span class="line-number"> 37</span>                <span class=<span class="string">"keyword"</span>>return</span> encoding
<span class="line-number"> 38</span>            <span class=<span class="string">"keyword"</span>>except</span> (UnicodeDecodeError, UnicodeError):
<span class="line-number"> 39</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>continue</span></span>
<span class="line-number"> 40</span>
<span class="line-number"> 41</span>        <span class="comment"># Final fallback</span>
<span class="line-number"> 42</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class="string">"utf-8"</span>
<span class="line-number"> 43</span>
<span class="line-number"> 44</span>    <span class=<span class="string">"keyword"</span>>except</span> Exception <span class=<span class="string">"keyword"</span>>as</span> e:
</pre>
<h4>Line 42</h4>
<pre>
<span class="line-number"> 37</span>                <span class=<span class="string">"keyword"</span>>return</span> encoding
<span class="line-number"> 38</span>            <span class=<span class="string">"keyword"</span>>except</span> (UnicodeDecodeError, UnicodeError):
<span class="line-number"> 39</span>                <span class=<span class="string">"keyword"</span>>continue</span>
<span class="line-number"> 40</span>
<span class="line-number"> 41</span>        <span class="comment"># Final fallback</span>
<span class="line-number"> 42</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> <span class="string">"utf-8"</span></span>
<span class="line-number"> 43</span>
<span class="line-number"> 44</span>    <span class=<span class="string">"keyword"</span>>except</span> Exception <span class=<span class="string">"keyword"</span>>as</span> e:
<span class="line-number"> 45</span>        logging.warning(f<span class="string">"Failed to detect encoding <span class="</span>keyword<span class="string">">for</span> {file_path}: {e}"</span>)
<span class="line-number"> 46</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class="string">"utf-8"</span>
<span class="line-number"> 47</span>
</pre>
<h4>Line 51</h4>
<pre>
<span class="line-number"> 46</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class="string">"utf-8"</span>
<span class="line-number"> 47</span>
<span class="line-number"> 48</span>
<span class="line-number"> 49</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> get_filename_from_path(file_path: str) -> str:
<span class="line-number"> 50</span>    <span class="string">""</span><span class="string">"Extract filename <span class="</span>keyword<span class="string">">from</span> a file path (handles both absolute <span class="</span>keyword<span class="string">">and</span> relative paths)"</span><span class="string">""</span>
<span class="line-number"> 51</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>return</span> Path(file_path).name</span>
<span class="line-number"> 52</span>
<span class="line-number"> 53</span>
<span class="line-number"> 54</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> find_file_by_filename(filename: str, file_dict: Dict[str, any]) -> Optional[str]:
<span class="line-number"> 55</span>    <span class="string">""</span>"
<span class="line-number"> 56</span>    Find a file <span class=<span class="string">"keyword"</span>>in</span> a dictionary by matching its filename.
</pre>
<h4>Lines 66-67</h4>
<pre>
<span class="line-number"> 61</span>
<span class="line-number"> 62</span>    Returns:
<span class="line-number"> 63</span>        The matching file path key, <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>None</span> <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> found
<span class="line-number"> 64</span>    <span class="string">""</span>"
<span class="line-number"> 65</span>    <span class="comment"># First <span class="keyword">try</span> exact match</span>
<span class="line-number"> 66</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>if</span> filename <span class=<span class="string">"keyword"</span>>in</span> file_dict:</span>
<span class="line-number"> 67</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> filename</span>
<span class="line-number"> 68</span>
<span class="line-number"> 69</span>    <span class="comment"># Try matching by filename</span>
<span class="line-number"> 70</span>    <span class=<span class="string">"keyword"</span>>for</span> file_path <span class=<span class="string">"keyword"</span>>in</span> file_dict.keys():
<span class="line-number"> 71</span>        <span class=<span class="string">"keyword"</span>>if</span> Path(file_path).name == filename:
<span class="line-number"> 72</span>            <span class=<span class="string">"keyword"</span>>return</span> file_path
</pre>
<h4>Lines 70-72</h4>
<pre>
<span class="line-number"> 65</span>    <span class="comment"># First <span class="keyword">try</span> exact match</span>
<span class="line-number"> 66</span>    <span class=<span class="string">"keyword"</span>>if</span> filename <span class=<span class="string">"keyword"</span>>in</span> file_dict:
<span class="line-number"> 67</span>        <span class=<span class="string">"keyword"</span>>return</span> filename
<span class="line-number"> 68</span>
<span class="line-number"> 69</span>    <span class="comment"># Try matching by filename</span>
<span class="line-number"> 70</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>for</span> file_path <span class=<span class="string">"keyword"</span>>in</span> file_dict.keys():</span>
<span class="line-number"> 71</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>if</span> Path(file_path).name == filename:</span>
<span class="line-number"> 72</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> file_path</span>
<span class="line-number"> 73</span>
<span class="line-number"> 74</span>    <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number"> 75</span>
<span class="line-number"> 76</span>
<span class="line-number"> 77</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> normalize_file_path(file_path: str, project_root: str = <span class=<span class="string">"keyword"</span>>None</span>) -> str:
</pre>
<h4>Line 74</h4>
<pre>
<span class="line-number"> 69</span>    <span class="comment"># Try matching by filename</span>
<span class="line-number"> 70</span>    <span class=<span class="string">"keyword"</span>>for</span> file_path <span class=<span class="string">"keyword"</span>>in</span> file_dict.keys():
<span class="line-number"> 71</span>        <span class=<span class="string">"keyword"</span>>if</span> Path(file_path).name == filename:
<span class="line-number"> 72</span>            <span class=<span class="string">"keyword"</span>>return</span> file_path
<span class="line-number"> 73</span>
<span class="line-number"> 74</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number"> 75</span>
<span class="line-number"> 76</span>
<span class="line-number"> 77</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> normalize_file_path(file_path: str, project_root: str = <span class=<span class="string">"keyword"</span>>None</span>) -> str:
<span class="line-number"> 78</span>    <span class="string">""</span>"
<span class="line-number"> 79</span>    Normalize file path <span class=<span class="string">"keyword"</span>>for</span> consistent handling.
</pre>
<h4>Line 89</h4>
<pre>
<span class="line-number"> 84</span>        project_root: Optional project root <span class=<span class="string">"keyword"</span>>for</span> relative path conversion
<span class="line-number"> 85</span>
<span class="line-number"> 86</span>    Returns:
<span class="line-number"> 87</span>        Normalized file path
<span class="line-number"> 88</span>    <span class="string">""</span>"
<span class="line-number"> 89</span><span class="uncovered">    path_obj = <span class="function">Path</span>(file_path)</span>
<span class="line-number"> 90</span>
<span class="line-number"> 91</span>    <span class="comment"># If we have a project root <span class="keyword">and</span> the path <span class="keyword">is</span> absolute, <span class="keyword">try</span> to make it relative</span>
<span class="line-number"> 92</span>    <span class=<span class="string">"keyword"</span>>if</span> project_root <span class=<span class="string">"keyword"</span>>and</span> path_obj.is_absolute():
<span class="line-number"> 93</span>        <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number"> 94</span>            relative_path = path_obj.<span class="function">relative_to</span>(<span class="function">Path</span>(project_root))
</pre>
<h4>Lines 92-96</h4>
<pre>
<span class="line-number"> 87</span>        Normalized file path
<span class="line-number"> 88</span>    <span class="string">""</span>"
<span class="line-number"> 89</span>    path_obj = <span class="function">Path</span>(file_path)
<span class="line-number"> 90</span>
<span class="line-number"> 91</span>    <span class="comment"># If we have a project root <span class="keyword">and</span> the path <span class="keyword">is</span> absolute, <span class="keyword">try</span> to make it relative</span>
<span class="line-number"> 92</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>if</span> project_root <span class=<span class="string">"keyword"</span>>and</span> path_obj.is_absolute():</span>
<span class="line-number"> 93</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>try</span>:</span>
<span class="line-number"> 94</span><span class="uncovered">            relative_path = path_obj.<span class="function">relative_to</span>(<span class="function">Path</span>(project_root))</span>
<span class="line-number"> 95</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> str(relative_path)</span>
<span class="line-number"> 96</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>except</span> ValueError:</span>
<span class="line-number"> 97</span>            <span class="comment"># Path <span class="keyword">is</span> <span class="keyword">not</span> relative to project root, keep <span class="keyword">as</span> <span class="keyword">is</span></span>
<span class="line-number"> 98</span>            <span class=<span class="string">"keyword"</span>>pass</span>
<span class="line-number"> 99</span>
<span class="line-number">100</span>    <span class=<span class="string">"keyword"</span>>return</span> str(path_obj)
<span class="line-number">101</span>
</pre>
<h4>Line 98</h4>
<pre>
<span class="line-number"> 93</span>        <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number"> 94</span>            relative_path = path_obj.<span class="function">relative_to</span>(<span class="function">Path</span>(project_root))
<span class="line-number"> 95</span>            <span class=<span class="string">"keyword"</span>>return</span> str(relative_path)
<span class="line-number"> 96</span>        <span class=<span class="string">"keyword"</span>>except</span> ValueError:
<span class="line-number"> 97</span>            <span class="comment"># Path <span class="keyword">is</span> <span class="keyword">not</span> relative to project root, keep <span class="keyword">as</span> <span class="keyword">is</span></span>
<span class="line-number"> 98</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>pass</span></span>
<span class="line-number"> 99</span>
<span class="line-number">100</span>    <span class=<span class="string">"keyword"</span>>return</span> str(path_obj)
<span class="line-number">101</span>
<span class="line-number">102</span>
<span class="line-number">103</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> create_file_key(file_path: str, project_root: str = <span class=<span class="string">"keyword"</span>>None</span>) -> str:
</pre>
<h4>Line 100</h4>
<pre>
<span class="line-number"> 95</span>            <span class=<span class="string">"keyword"</span>>return</span> str(relative_path)
<span class="line-number"> 96</span>        <span class=<span class="string">"keyword"</span>>except</span> ValueError:
<span class="line-number"> 97</span>            <span class="comment"># Path <span class="keyword">is</span> <span class="keyword">not</span> relative to project root, keep <span class="keyword">as</span> <span class="keyword">is</span></span>
<span class="line-number"> 98</span>            <span class=<span class="string">"keyword"</span>>pass</span>
<span class="line-number"> 99</span>
<span class="line-number">100</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>return</span> str(path_obj)</span>
<span class="line-number">101</span>
<span class="line-number">102</span>
<span class="line-number">103</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> create_file_key(file_path: str, project_root: str = <span class=<span class="string">"keyword"</span>>None</span>) -> str:
<span class="line-number">104</span>    <span class="string">""</span>"
<span class="line-number">105</span>    Create a consistent file key <span class=<span class="string">"keyword"</span>>for</span> tracking.
</pre>
<h4>Line 115</h4>
<pre>
<span class="line-number">110</span>        project_root: Optional project root <span class=<span class="string">"keyword"</span>>for</span> normalization
<span class="line-number">111</span>
<span class="line-number">112</span>    Returns:
<span class="line-number">113</span>        A consistent file <span class="function">key</span>(filename)
<span class="line-number">114</span>    <span class="string">""</span>"
<span class="line-number">115</span><span class="uncovered">    <span class=<span class="string">"keyword"</span>>return</span> get_filename_from_path(file_path)</span>
<span class="line-number">116</span>
<span class="line-number">117</span>
<span class="line-number">118</span><span class="comment"># Backward compatibility functions <span class="keyword">for</span> existing tests</span>
<span class="line-number">119</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> get_acceptable_encodings() -> list:
<span class="line-number">120</span>    <span class="string">""</span>"
</pre>
<h4>Line 187</h4>
<pre>
<span class="line-number">182</span>    Returns:
<span class="line-number">183</span>        The default encoding name <span class=<span class="string">"keyword"</span>>for</span> the current platform.
<span class="line-number">184</span>    <span class="string">""</span>"
<span class="line-number">185</span>    <span class=<span class="string">"keyword"</span>>import</span> sys
<span class="line-number">186</span>    <span class=<span class="string">"keyword"</span>>if</span> sys.platform.startswith(<span class="string">"win"</span>):
<span class="line-number">187</span><span class="uncovered">        <span class="keyword">return</span> "windows-1252"  <span class="comment"># Common Windows default</span></span>
<span class="line-number">188</span>    <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">189</span>        <span class="keyword">return</span> "utf-8"  <span class="comment"># Common Unix/Linux default</span>
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/parser_tokenizer.py - 88.75% coverage (576/649 lines)
</div>
<h4>Line 222</h4>
<pre>
<span class="line-number">217</span>            <span class=<span class="string">"keyword"</span>>if</span> line_num < total_lines:
<span class="line-number">218</span>                tokens.append(Token(TokenType.NEWLINE, <span class="string">"\n"</span>, line_num, len(line)))
<span class="line-number">219</span>            line_num += <span class="number">1</span>
<span class="line-number">220</span>
<span class="line-number">221</span>        <span class=<span class="string">"keyword"</span>>if</span> in_multiline_string:
<span class="line-number">222</span><span class="uncovered">            tokens.<span class="function">append</span>(</span>
<span class="line-number">223</span>                <span class="function">Token</span>(
<span class="line-number">224</span>                    TokenType.STRING,
<span class="line-number">225</span>                    multiline_string_value,
<span class="line-number">226</span>                    multiline_string_start_line,
<span class="line-number">227</span>                    multiline_string_start_col,
</pre>
<h4>Line 231</h4>
<pre>
<span class="line-number">226</span>                    multiline_string_start_line,
<span class="line-number">227</span>                    multiline_string_start_col,
<span class="line-number">228</span>                )
<span class="line-number">229</span>            )
<span class="line-number">230</span>        <span class="keyword">if</span> in_multiline_comment:
<span class="line-number">231</span><span class="uncovered">            tokens.<span class="function">append</span>(</span>
<span class="line-number">232</span>                <span class="function">Token</span>(
<span class="line-number">233</span>                    TokenType.COMMENT,
<span class="line-number">234</span>                    multiline_comment_value,
<span class="line-number">235</span>                    multiline_comment_start_line,
<span class="line-number">236</span>                    multiline_comment_start_col,
</pre>
<h4>Line 309</h4>
<pre>
<span class="line-number">304</span>                <span class=<span class="string">"keyword"</span>>or</span> (pos > 1 <span class=<span class="string">"keyword"</span>>and</span> line[pos - 2 : pos] == <span class="string">"u8"</span> <span class=<span class="string">"keyword"</span>>and</span> line[pos] == <span class="string">'"'</span>)
<span class="line-number">305</span>            ):
<span class="line-number">306</span>                <span class="comment"># Handle string literals <span class="keyword">with</span> possible prefixes</span>
<span class="line-number">307</span>                string_start = pos
<span class="line-number">308</span>                <span class=<span class="string">"keyword"</span>>if</span> line[pos - 2 : pos] == <span class="string">"u8"</span>:
<span class="line-number">309</span><span class="uncovered">                    string_start -= 2</span>
<span class="line-number">310</span>                <span class=<span class="string">"keyword"</span>>elif</span> line[pos - 1] <span class=<span class="string">"keyword"</span>>in</span> [<span class="string">"L"</span>, <span class="string">"u"</span>, <span class="string">"U"</span>, <span class="string">"R"</span>]:
<span class="line-number">311</span>                    string_start -= 1
<span class="line-number">312</span>                pos += 1  <span class="comment"># Skip opening quote</span>
<span class="line-number">313</span>                <span class=<span class="string">"keyword"</span>>while</span> pos < len(line):
<span class="line-number">314</span>                    <span class=<span class="string">"keyword"</span>>if</span> line[pos] == <span class="string">'"'</span>:
</pre>
<h4>Line 311</h4>
<pre>
<span class="line-number">306</span>                <span class="comment"># Handle string literals <span class="keyword">with</span> possible prefixes</span>
<span class="line-number">307</span>                string_start = pos
<span class="line-number">308</span>                <span class=<span class="string">"keyword"</span>>if</span> line[pos - 2 : pos] == <span class="string">"u8"</span>:
<span class="line-number">309</span>                    string_start -= 2
<span class="line-number">310</span>                <span class=<span class="string">"keyword"</span>>elif</span> line[pos - 1] <span class=<span class="string">"keyword"</span>>in</span> [<span class="string">"L"</span>, <span class="string">"u"</span>, <span class="string">"U"</span>, <span class="string">"R"</span>]:
<span class="line-number">311</span><span class="uncovered">                    string_start -= 1</span>
<span class="line-number">312</span>                pos += 1  <span class="comment"># Skip opening quote</span>
<span class="line-number">313</span>                <span class=<span class="string">"keyword"</span>>while</span> pos < len(line):
<span class="line-number">314</span>                    <span class=<span class="string">"keyword"</span>>if</span> line[pos] == <span class="string">'"'</span>:
<span class="line-number">315</span>                        <span class="comment"># Found closing quote</span>
<span class="line-number">316</span>                        string_text = line[string_start : pos + 1]
</pre>
<h4>Lines 413-414</h4>
<pre>
<span class="line-number">408</span>        <span class=<span class="string">"keyword"</span>>while</span> i < len(tokens):
<span class="line-number">409</span>            token = tokens[i]
<span class="line-number">410</span>
<span class="line-number">411</span>            <span class=<span class="string">"keyword"</span>>if</span> token.type == TokenType.DEFINE <span class=<span class="string">"keyword"</span>>and</span> token.value.rstrip().endswith(<span class="string">"\\"</span>):
<span class="line-number">412</span>                <span class="comment"># Found a multi-line macro, merge <span class="keyword">with</span> subsequent lines</span>
<span class="line-number">413</span><span class="uncovered">                macro_content = token.value</span>
<span class="line-number">414</span><span class="uncovered">                current_line = token.line</span>
<span class="line-number">415</span>
<span class="line-number">416</span>                <span class="comment"># Continue merging lines until we find one that doesn't end <span class="keyword">with</span> backslash</span>
<span class="line-number">417</span>                <span class=<span class="string">"keyword"</span>>while</span> macro_content.rstrip().endswith(<span class="string">"\\"</span>):
<span class="line-number">418</span>                    <span class="comment"># Remove the backslash <span class="keyword">and</span> add a newline</span>
<span class="line-number">419</span>                    macro_content = macro_content.rstrip()[:-1] + <span class="string">"\n"</span>
</pre>
<h4>Line 417</h4>
<pre>
<span class="line-number">412</span>                <span class="comment"># Found a multi-line macro, merge <span class="keyword">with</span> subsequent lines</span>
<span class="line-number">413</span>                macro_content = token.value
<span class="line-number">414</span>                current_line = token.line
<span class="line-number">415</span>
<span class="line-number">416</span>                <span class="comment"># Continue merging lines until we find one that doesn't end <span class="keyword">with</span> backslash</span>
<span class="line-number">417</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>while</span> macro_content.rstrip().endswith(<span class="string">"\\"</span>):</span>
<span class="line-number">418</span>                    <span class="comment"># Remove the backslash <span class="keyword">and</span> add a newline</span>
<span class="line-number">419</span>                    macro_content = macro_content.rstrip()[:-1] + <span class="string">"\n"</span>
<span class="line-number">420</span>                    current_line += <span class="number">1</span>
<span class="line-number">421</span>
<span class="line-number">422</span>                    <span class="comment"># Find the next line content</span>
</pre>
<h4>Lines 419-420</h4>
<pre>
<span class="line-number">414</span>                current_line = token.line
<span class="line-number">415</span>
<span class="line-number">416</span>                <span class="comment"># Continue merging lines until we find one that doesn't end <span class="keyword">with</span> backslash</span>
<span class="line-number">417</span>                <span class=<span class="string">"keyword"</span>>while</span> macro_content.rstrip().endswith(<span class="string">"\\"</span>):
<span class="line-number">418</span>                    <span class="comment"># Remove the backslash <span class="keyword">and</span> add a newline</span>
<span class="line-number">419</span><span class="uncovered">                    macro_content = macro_content.rstrip()[:-1] + <span class="string">"\n"</span></span>
<span class="line-number">420</span><span class="uncovered">                    current_line += <span class="number">1</span></span>
<span class="line-number">421</span>
<span class="line-number">422</span>                    <span class="comment"># Find the next line content</span>
<span class="line-number">423</span>                    <span class=<span class="string">"keyword"</span>>if</span> current_line <= len(lines):
<span class="line-number">424</span>                        next_line = lines[current_line - <span class="number">1</span>]
<span class="line-number">425</span>                        macro_content += next_line
</pre>
<h4>Lines 423-425</h4>
<pre>
<span class="line-number">418</span>                    <span class="comment"># Remove the backslash <span class="keyword">and</span> add a newline</span>
<span class="line-number">419</span>                    macro_content = macro_content.rstrip()[:-1] + <span class="string">"\n"</span>
<span class="line-number">420</span>                    current_line += <span class="number">1</span>
<span class="line-number">421</span>
<span class="line-number">422</span>                    <span class="comment"># Find the next line content</span>
<span class="line-number">423</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>if</span> current_line <= len(lines):</span>
<span class="line-number">424</span><span class="uncovered">                        next_line = lines[current_line - <span class="number">1</span>]</span>
<span class="line-number">425</span><span class="uncovered">                        macro_content += next_line</span>
<span class="line-number">426</span>                    <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">427</span>                        <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">428</span>
<span class="line-number">429</span>                <span class="comment"># Create a new token <span class="keyword">with</span> the merged content</span>
<span class="line-number">430</span>                merged_tokens.<span class="function">append</span>(
</pre>
<h4>Line 427</h4>
<pre>
<span class="line-number">422</span>                    <span class="comment"># Find the next line content</span>
<span class="line-number">423</span>                    <span class=<span class="string">"keyword"</span>>if</span> current_line <= len(lines):
<span class="line-number">424</span>                        next_line = lines[current_line - <span class="number">1</span>]
<span class="line-number">425</span>                        macro_content += next_line
<span class="line-number">426</span>                    <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">427</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>break</span></span>
<span class="line-number">428</span>
<span class="line-number">429</span>                <span class="comment"># Create a new token <span class="keyword">with</span> the merged content</span>
<span class="line-number">430</span>                merged_tokens.<span class="function">append</span>(
<span class="line-number">431</span>                    <span class="function">Token</span>(TokenType.DEFINE, macro_content, token.line, token.column)
<span class="line-number">432</span>                )
</pre>
<h4>Line 430</h4>
<pre>
<span class="line-number">425</span>                        macro_content += next_line
<span class="line-number">426</span>                    <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">427</span>                        <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">428</span>
<span class="line-number">429</span>                <span class="comment"># Create a new token <span class="keyword">with</span> the merged content</span>
<span class="line-number">430</span><span class="uncovered">                merged_tokens.<span class="function">append</span>(</span>
<span class="line-number">431</span>                    <span class="function">Token</span>(TokenType.DEFINE, macro_content, token.line, token.column)
<span class="line-number">432</span>                )
<span class="line-number">433</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">434</span>                merged_tokens.<span class="function">append</span>(token)
<span class="line-number">435</span>
</pre>
<h4>Lines 532-533</h4>
<pre>
<span class="line-number">527</span>        <span class="string">""</span><span class="string">"Check <span class="</span>keyword<span class="string">">if</span> current token <span class="</span>keyword<span class="string">">is</span> of specified type"</span><span class="string">""</span>
<span class="line-number">528</span>        <span class=<span class="string">"keyword"</span>>return</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> self.tokens[self.pos].type == token_type
<span class="line-number">529</span>
<span class="line-number">530</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _peek_token(self, offset: int = 1) -> Optional[Token]:
<span class="line-number">531</span>        <span class="string">""</span><span class="string">"Peek at token at current position + offset"</span><span class="string">""</span>
<span class="line-number">532</span><span class="uncovered">        peek_pos = self.pos + offset</span>
<span class="line-number">533</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> self.tokens[peek_pos] <span class=<span class="string">"keyword"</span>>if</span> peek_pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>else</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">534</span>
<span class="line-number">535</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _advance(self) -> Optional[Token]:
<span class="line-number">536</span>        <span class="string">""</span><span class="string">"Advance to next token <span class="</span>keyword<span class="string">">and</span> <span class="</span>keyword<span class="string">">return</span> current"</span><span class="string">""</span>
<span class="line-number">537</span>        <span class=<span class="string">"keyword"</span>>if</span> self.pos < len(self.tokens):
<span class="line-number">538</span>            token = self.tokens[self.pos]
</pre>
<h4>Line 541</h4>
<pre>
<span class="line-number">536</span>        <span class="string">""</span><span class="string">"Advance to next token <span class="</span>keyword<span class="string">">and</span> <span class="</span>keyword<span class="string">">return</span> current"</span><span class="string">""</span>
<span class="line-number">537</span>        <span class=<span class="string">"keyword"</span>>if</span> self.pos < len(self.tokens):
<span class="line-number">538</span>            token = self.tokens[self.pos]
<span class="line-number">539</span>            self.pos += <span class="number">1</span>
<span class="line-number">540</span>            <span class=<span class="string">"keyword"</span>>return</span> token
<span class="line-number">541</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">542</span>
<span class="line-number">543</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _find_matching_brace(self, start_pos: int) -> Optional[int]:
<span class="line-number">544</span>        <span class="string">""</span><span class="string">"Find matching closing brace starting <span class="</span>keyword<span class="string">">from</span> open brace position"</span><span class="string">""</span>
<span class="line-number">545</span>        <span class=<span class="string">"keyword"</span>>if</span> (
<span class="line-number">546</span>            start_pos >= <span class="function">len</span>(self.tokens)
</pre>
<h4>Line 549</h4>
<pre>
<span class="line-number">544</span>        <span class="string">""</span><span class="string">"Find matching closing brace starting <span class="</span>keyword<span class="string">">from</span> open brace position"</span><span class="string">""</span>
<span class="line-number">545</span>        <span class=<span class="string">"keyword"</span>>if</span> (
<span class="line-number">546</span>            start_pos >= <span class="function">len</span>(self.tokens)
<span class="line-number">547</span>            <span class=<span class="string">"keyword"</span>>or</span> self.tokens[start_pos].type != TokenType.LBRACE
<span class="line-number">548</span>        ):
<span class="line-number">549</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">550</span>
<span class="line-number">551</span>        depth = <span class="number">1</span>
<span class="line-number">552</span>        pos = start_pos + <span class="number">1</span>
<span class="line-number">553</span>
<span class="line-number">554</span>        <span class=<span class="string">"keyword"</span>>while</span> pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> depth > 0:
</pre>
<h4>Line 569</h4>
<pre>
<span class="line-number">564</span>        <span class="string">""</span><span class="string">"Parse struct definition starting at current position"</span><span class="string">""</span>
<span class="line-number">565</span>        start_pos = self.pos
<span class="line-number">566</span>
<span class="line-number">567</span>        <span class="comment"># Consume 'struct' keyword</span>
<span class="line-number">568</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.STRUCT):
<span class="line-number">569</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">570</span>        self.<span class="function">_advance</span>()
<span class="line-number">571</span>
<span class="line-number">572</span>        <span class="comment"># Skip whitespace</span>
<span class="line-number">573</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> self._current_token_is(
<span class="line-number">574</span>            TokenType.WHITESPACE
</pre>
<h4>Line 597</h4>
<pre>
<span class="line-number">592</span>        <span class="comment"># Find matching closing brace</span>
<span class="line-number">593</span>        brace_pos = self.pos
<span class="line-number">594</span>        end_brace_pos = self.<span class="function">_find_matching_brace</span>(brace_pos)
<span class="line-number">595</span>
<span class="line-number">596</span>        <span class=<span class="string">"keyword"</span>>if</span> end_brace_pos <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">597</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">598</span>
<span class="line-number">599</span>        <span class="comment"># Look <span class="keyword">for</span> struct name after closing brace</span>
<span class="line-number">600</span>        name_pos = end_brace_pos + <span class="number">1</span>
<span class="line-number">601</span>        struct_name = struct_tag  <span class="comment"># Default to tag name</span>
<span class="line-number">602</span>
</pre>
<h4>Line 654</h4>
<pre>
<span class="line-number">649</span>        <span class="string">""</span><span class="string">"Parse typedef struct definition"</span><span class="string">""</span>
<span class="line-number">650</span>        start_pos = self.pos
<span class="line-number">651</span>
<span class="line-number">652</span>        <span class="comment"># Consume 'typedef'</span>
<span class="line-number">653</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.TYPEDEF):
<span class="line-number">654</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">655</span>        self.<span class="function">_advance</span>()
<span class="line-number">656</span>
<span class="line-number">657</span>        <span class="comment"># Look <span class="keyword">for</span> 'struct'</span>
<span class="line-number">658</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.STRUCT):
<span class="line-number">659</span>            <span class="comment"># Not a typedef struct, reset position</span>
</pre>
<h4>Line 670</h4>
<pre>
<span class="line-number">665</span>
<span class="line-number">666</span>        <span class="comment"># Skip whitespace</span>
<span class="line-number">667</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> self._current_token_is(
<span class="line-number">668</span>            TokenType.WHITESPACE
<span class="line-number">669</span>        ):
<span class="line-number">670</span><span class="uncovered">            self.pos += <span class="number">1</span></span>
<span class="line-number">671</span>
<span class="line-number">672</span>        <span class="comment"># Get struct tag name (optional)</span>
<span class="line-number">673</span>        struct_tag = <span class="string">""</span>
<span class="line-number">674</span>        <span class=<span class="string">"keyword"</span>>if</span> self._current_token_is(TokenType.IDENTIFIER):
<span class="line-number">675</span>            struct_tag = self.<span class="function">_advance</span>().value
</pre>
<h4>Line 681</h4>
<pre>
<span class="line-number">676</span>
<span class="line-number">677</span>        <span class="comment"># Skip whitespace</span>
<span class="line-number">678</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> self._current_token_is(
<span class="line-number">679</span>            TokenType.WHITESPACE
<span class="line-number">680</span>        ):
<span class="line-number">681</span><span class="uncovered">            self.pos += <span class="number">1</span></span>
<span class="line-number">682</span>
<span class="line-number">683</span>        <span class="comment"># Check <span class="keyword">if</span> this <span class="keyword">is</span> a forward declaration (no braces)</span>
<span class="line-number">684</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.LBRACE):
<span class="line-number">685</span>            <span class="comment"># This <span class="keyword">is</span> a forward declaration like "typedef struct Node* NodePtr;"</span>
<span class="line-number">686</span>            <span class="comment"># Not a struct definition, so skip it</span>
</pre>
<h4>Lines 693-694</h4>
<pre>
<span class="line-number">688</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">689</span>
<span class="line-number">690</span>        <span class="comment"># Find matching closing brace</span>
<span class="line-number">691</span>        end_brace_pos = self.<span class="function">_find_matching_brace</span>(self.pos)
<span class="line-number">692</span>        <span class=<span class="string">"keyword"</span>>if</span> end_brace_pos <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">693</span><span class="uncovered">            self.pos = start_pos + <span class="number">1</span></span>
<span class="line-number">694</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">695</span>
<span class="line-number">696</span>        <span class="comment"># Look <span class="keyword">for</span> typedef name after closing brace</span>
<span class="line-number">697</span>        typedef_name = <span class="string">""</span>
<span class="line-number">698</span>        name_pos = end_brace_pos + <span class="number">1</span>
<span class="line-number">699</span>        <span class=<span class="string">"keyword"</span>>while</span> name_pos < len(self.tokens):
</pre>
<h4>Lines 703-705</h4>
<pre>
<span class="line-number">698</span>        name_pos = end_brace_pos + <span class="number">1</span>
<span class="line-number">699</span>        <span class=<span class="string">"keyword"</span>>while</span> name_pos < len(self.tokens):
<span class="line-number">700</span>            <span class=<span class="string">"keyword"</span>>if</span> self.tokens[name_pos].type == TokenType.IDENTIFIER:
<span class="line-number">701</span>                typedef_name = self.tokens[name_pos].value
<span class="line-number">702</span>                <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">703</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>elif</span> self.tokens[name_pos].type == TokenType.SEMICOLON:</span>
<span class="line-number">704</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>break</span></span>
<span class="line-number">705</span><span class="uncovered">            name_pos += <span class="number">1</span></span>
<span class="line-number">706</span>
<span class="line-number">707</span>        <span class="comment"># Find semicolon</span>
<span class="line-number">708</span>        <span class=<span class="string">"keyword"</span>>while</span> (
<span class="line-number">709</span>            name_pos < <span class="function">len</span>(self.tokens)
<span class="line-number">710</span>            <span class=<span class="string">"keyword"</span>>and</span> <span class=<span class="string">"keyword"</span>>not</span> self.tokens[name_pos].type == TokenType.SEMICOLON
</pre>
<h4>Line 723</h4>
<pre>
<span class="line-number">718</span>        <span class="string">""</span><span class="string">"Parse enum definition starting at current position"</span><span class="string">""</span>
<span class="line-number">719</span>        start_pos = self.pos
<span class="line-number">720</span>
<span class="line-number">721</span>        <span class="comment"># Consume 'enum' keyword</span>
<span class="line-number">722</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.ENUM):
<span class="line-number">723</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">724</span>        self.<span class="function">_advance</span>()
<span class="line-number">725</span>
<span class="line-number">726</span>        <span class="comment"># Skip whitespace</span>
<span class="line-number">727</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> self._current_token_is(
<span class="line-number">728</span>            TokenType.WHITESPACE
</pre>
<h4>Line 751</h4>
<pre>
<span class="line-number">746</span>        <span class="comment"># Find matching closing brace</span>
<span class="line-number">747</span>        brace_pos = self.pos
<span class="line-number">748</span>        end_brace_pos = self.<span class="function">_find_matching_brace</span>(brace_pos)
<span class="line-number">749</span>
<span class="line-number">750</span>        <span class=<span class="string">"keyword"</span>>if</span> end_brace_pos <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">751</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">752</span>
<span class="line-number">753</span>        <span class="comment"># Look <span class="keyword">for</span> enum name after closing brace</span>
<span class="line-number">754</span>        name_pos = end_brace_pos + <span class="number">1</span>
<span class="line-number">755</span>        enum_name = enum_tag  <span class="comment"># Default to tag name</span>
<span class="line-number">756</span>
</pre>
<h4>Line 779</h4>
<pre>
<span class="line-number">774</span>            <span class=<span class="string">"keyword"</span>>while</span> name_pos < len(self.tokens):
<span class="line-number">775</span>                <span class=<span class="string">"keyword"</span>>if</span> self.tokens[name_pos].type == TokenType.IDENTIFIER:
<span class="line-number">776</span>                    enum_name = self.tokens[name_pos].value
<span class="line-number">777</span>                    <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">778</span>                <span class=<span class="string">"keyword"</span>>elif</span> self.tokens[name_pos].type == TokenType.SEMICOLON:
<span class="line-number">779</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>break</span></span>
<span class="line-number">780</span>                name_pos += <span class="number">1</span>
<span class="line-number">781</span>        <span class=<span class="string">"keyword"</span>>elif</span> <span class=<span class="string">"keyword"</span>>not</span> enum_tag:
<span class="line-number">782</span>            <span class="comment"># Anonymous enum - check <span class="keyword">if</span> there's a variable name after the brace</span>
<span class="line-number">783</span>            <span class=<span class="string">"keyword"</span>>while</span> name_pos < len(self.tokens):
<span class="line-number">784</span>                <span class=<span class="string">"keyword"</span>>if</span> self.tokens[name_pos].type == TokenType.IDENTIFIER:
</pre>
<h4>Lines 788-790</h4>
<pre>
<span class="line-number">783</span>            <span class=<span class="string">"keyword"</span>>while</span> name_pos < len(self.tokens):
<span class="line-number">784</span>                <span class=<span class="string">"keyword"</span>>if</span> self.tokens[name_pos].type == TokenType.IDENTIFIER:
<span class="line-number">785</span>                    <span class="comment"># This <span class="keyword">is</span> a variable name, <span class="keyword">not</span> an enum name</span>
<span class="line-number">786</span>                    enum_name = <span class="string">""</span>
<span class="line-number">787</span>                    <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">788</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>elif</span> self.tokens[name_pos].type == TokenType.SEMICOLON:</span>
<span class="line-number">789</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>break</span></span>
<span class="line-number">790</span><span class="uncovered">                name_pos += <span class="number">1</span></span>
<span class="line-number">791</span>
<span class="line-number">792</span>        <span class="comment"># Find semicolon</span>
<span class="line-number">793</span>        self.pos = end_brace_pos + <span class="number">1</span>
<span class="line-number">794</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(
<span class="line-number">795</span>            TokenType.SEMICOLON
</pre>
<h4>Line 808</h4>
<pre>
<span class="line-number">803</span>        <span class="string">""</span><span class="string">"Parse typedef enum definition"</span><span class="string">""</span>
<span class="line-number">804</span>        start_pos = self.pos
<span class="line-number">805</span>
<span class="line-number">806</span>        <span class="comment"># Consume 'typedef'</span>
<span class="line-number">807</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.TYPEDEF):
<span class="line-number">808</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">809</span>        self.<span class="function">_advance</span>()
<span class="line-number">810</span>
<span class="line-number">811</span>        <span class="comment"># Look <span class="keyword">for</span> 'enum'</span>
<span class="line-number">812</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.ENUM):
<span class="line-number">813</span>            <span class="comment"># Not a typedef enum, reset position</span>
</pre>
<h4>Lines 820-821</h4>
<pre>
<span class="line-number">815</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">816</span>
<span class="line-number">817</span>        <span class="comment"># Parse the enum part - this will <span class="keyword">return</span> the tag name (e.g., StatusEnum_tag)</span>
<span class="line-number">818</span>        enum_info = self.<span class="function">_parse_enum</span>()
<span class="line-number">819</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> enum_info:
<span class="line-number">820</span><span class="uncovered">            self.pos = start_pos + <span class="number">1</span></span>
<span class="line-number">821</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">822</span>
<span class="line-number">823</span>        <span class="comment"># For typedef enums, we want to <span class="keyword">return</span> the tag name, <span class="keyword">not</span> the typedef name</span>
<span class="line-number">824</span>        <span class="comment"># The typedef name will be handled separately <span class="keyword">in</span> the parser</span>
<span class="line-number">825</span>        <span class=<span class="string">"keyword"</span>>return</span> enum_info
<span class="line-number">826</span>
</pre>
<h4>Line 946</h4>
<pre>
<span class="line-number">941</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">942</span>
<span class="line-number">943</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _is_function_declaration(self, end_pos: int) -> bool:
<span class="line-number">944</span>        <span class="string">""</span><span class="string">"Check <span class="</span>keyword<span class="string">">if</span> the function at end_pos <span class="</span>keyword<span class="string">">is</span> a declaration (ends <span class="</span>keyword<span class="string">">with</span> ;) <span class="</span>keyword<span class="string">">or</span> definition (ends <span class="</span>keyword<span class="string">">with</span> })"</span><span class="string">""</span>
<span class="line-number">945</span>        <span class=<span class="string">"keyword"</span>>if</span> end_pos >= len(self.tokens):
<span class="line-number">946</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">947</span>
<span class="line-number">948</span>        <span class="comment"># Look backwards <span class="keyword">from</span> end_pos to find the last significant token</span>
<span class="line-number">949</span>        pos = end_pos
<span class="line-number">950</span>        <span class=<span class="string">"keyword"</span>>while</span> pos >= 0:
<span class="line-number">951</span>            token_type = self.tokens[pos].type
</pre>
<h4>Line 958</h4>
<pre>
<span class="line-number">953</span>                TokenType.WHITESPACE,
<span class="line-number">954</span>                TokenType.COMMENT,
<span class="line-number">955</span>                TokenType.NEWLINE,
<span class="line-number">956</span>            ]:
<span class="line-number">957</span>                <span class=<span class="string">"keyword"</span>>return</span> token_type == TokenType.SEMICOLON
<span class="line-number">958</span><span class="uncovered">            pos -= <span class="number">1</span></span>
<span class="line-number">959</span>
<span class="line-number">960</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">961</span>
<span class="line-number">962</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _find_function_end(self, start_pos: int) -> Optional[int]:
<span class="line-number">963</span>        <span class="string">""</span><span class="string">"Find end of function declaration <span class="</span>keyword<span class="string">">or</span> definition"</span><span class="string">""</span>
</pre>
<h4>Line 960</h4>
<pre>
<span class="line-number">955</span>                TokenType.NEWLINE,
<span class="line-number">956</span>            ]:
<span class="line-number">957</span>                <span class=<span class="string">"keyword"</span>>return</span> token_type == TokenType.SEMICOLON
<span class="line-number">958</span>            pos -= <span class="number">1</span>
<span class="line-number">959</span>
<span class="line-number">960</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">961</span>
<span class="line-number">962</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _find_function_end(self, start_pos: int) -> Optional[int]:
<span class="line-number">963</span>        <span class="string">""</span><span class="string">"Find end of function declaration <span class="</span>keyword<span class="string">">or</span> definition"</span><span class="string">""</span>
<span class="line-number">964</span>        pos = start_pos
<span class="line-number">965</span>
</pre>
<h4>Line 968</h4>
<pre>
<span class="line-number">963</span>        <span class="string">""</span><span class="string">"Find end of function declaration <span class="</span>keyword<span class="string">">or</span> definition"</span><span class="string">""</span>
<span class="line-number">964</span>        pos = start_pos
<span class="line-number">965</span>
<span class="line-number">966</span>        <span class="comment"># Find matching closing parenthesis</span>
<span class="line-number">967</span>        <span class=<span class="string">"keyword"</span>>if</span> pos >= len(self.tokens) <span class=<span class="string">"keyword"</span>>or</span> self.tokens[pos].type != TokenType.LPAREN:
<span class="line-number">968</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">969</span>
<span class="line-number">970</span>        depth = <span class="number">1</span>
<span class="line-number">971</span>        pos += <span class="number">1</span>
<span class="line-number">972</span>
<span class="line-number">973</span>        <span class=<span class="string">"keyword"</span>>while</span> pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> depth > 0:
</pre>
<h4>Line 993</h4>
<pre>
<span class="line-number">988</span>                <span class="comment"># Function definition - find matching brace</span>
<span class="line-number">989</span>                end_brace = self.<span class="function">_find_matching_brace</span>(pos)
<span class="line-number">990</span>                <span class=<span class="string">"keyword"</span>>return</span> end_brace <span class=<span class="string">"keyword"</span>>if</span> end_brace <span class=<span class="string">"keyword"</span>>else</span> pos
<span class="line-number">991</span>            pos += <span class="number">1</span>
<span class="line-number">992</span>
<span class="line-number">993</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">994</span>
<span class="line-number">995</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_union(self) -> Optional[Tuple[int, int, str]]:
<span class="line-number">996</span>        <span class="string">""</span><span class="string">"Parse union definition"</span><span class="string">""</span>
<span class="line-number">997</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.UNION):
<span class="line-number">998</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
</pre>
<h4>Line 998</h4>
<pre>
<span class="line-number">993</span>        <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">994</span>
<span class="line-number">995</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_union(self) -> Optional[Tuple[int, int, str]]:
<span class="line-number">996</span>        <span class="string">""</span><span class="string">"Parse union definition"</span><span class="string">""</span>
<span class="line-number">997</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.UNION):
<span class="line-number">998</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">999</span>
<span class="line-number">1000</span>        start_pos = self.pos
<span class="line-number">1001</span>        self._advance()  <span class="comment"># Consumes 'union'</span>
<span class="line-number">1002</span>
<span class="line-number">1003</span>        <span class="comment"># Skip whitespace</span>
</pre>
<h4>Line 1007</h4>
<pre>
<span class="line-number">1002</span>
<span class="line-number">1003</span>        <span class="comment"># Skip whitespace</span>
<span class="line-number">1004</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> self._current_token_is(
<span class="line-number">1005</span>            TokenType.WHITESPACE
<span class="line-number">1006</span>        ):
<span class="line-number">1007</span><span class="uncovered">            self.pos += <span class="number">1</span></span>
<span class="line-number">1008</span>
<span class="line-number">1009</span>        <span class="comment"># Get union tag name (optional <span class="keyword">for</span> anonymous unions)</span>
<span class="line-number">1010</span>        union_tag = <span class="string">""</span>
<span class="line-number">1011</span>        <span class=<span class="string">"keyword"</span>>if</span> self._current_token_is(TokenType.IDENTIFIER):
<span class="line-number">1012</span>            union_tag = self.<span class="function">_advance</span>().value
</pre>
<h4>Line 1026</h4>
<pre>
<span class="line-number">1021</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">1022</span>
<span class="line-number">1023</span>        <span class="comment"># Find matching closing brace</span>
<span class="line-number">1024</span>        end_pos = self.<span class="function">_find_matching_brace</span>(self.pos)
<span class="line-number">1025</span>        <span class=<span class="string">"keyword"</span>>if</span> end_pos <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">1026</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">1027</span>
<span class="line-number">1028</span>        <span class="comment"># Look <span class="keyword">for</span> union name after closing brace (<span class="keyword">for</span> typedefs <span class="keyword">or</span> named unions)</span>
<span class="line-number">1029</span>        union_name = union_tag  <span class="comment"># Default to tag name</span>
<span class="line-number">1030</span>
<span class="line-number">1031</span>        <span class="comment"># Skip to semicolon</span>
</pre>
<h4>Lines 1036-1039</h4>
<pre>
<span class="line-number">1031</span>        <span class="comment"># Skip to semicolon</span>
<span class="line-number">1032</span>        self.pos = end_pos + <span class="number">1</span>
<span class="line-number">1033</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(
<span class="line-number">1034</span>            TokenType.SEMICOLON
<span class="line-number">1035</span>        ):
<span class="line-number">1036</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>if</span> self._current_token_is(TokenType.IDENTIFIER):</span>
<span class="line-number">1037</span><span class="uncovered">                union_name = self.<span class="function">_advance</span>().value</span>
<span class="line-number">1038</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>break</span></span>
<span class="line-number">1039</span><span class="uncovered">            self.pos += <span class="number">1</span></span>
<span class="line-number">1040</span>
<span class="line-number">1041</span>        <span class=<span class="string">"keyword"</span>>return</span> (start_pos, end_pos, union_name)
<span class="line-number">1042</span>
<span class="line-number">1043</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_typedef_union(self) -> Optional[Tuple[int, int, str]]:
<span class="line-number">1044</span>        <span class="string">""</span><span class="string">"Parse typedef union definition"</span><span class="string">""</span>
</pre>
<h4>Line 1046</h4>
<pre>
<span class="line-number">1041</span>        <span class=<span class="string">"keyword"</span>>return</span> (start_pos, end_pos, union_name)
<span class="line-number">1042</span>
<span class="line-number">1043</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _parse_typedef_union(self) -> Optional[Tuple[int, int, str]]:
<span class="line-number">1044</span>        <span class="string">""</span><span class="string">"Parse typedef union definition"</span><span class="string">""</span>
<span class="line-number">1045</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.TYPEDEF):
<span class="line-number">1046</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">1047</span>
<span class="line-number">1048</span>        start_pos = self.pos
<span class="line-number">1049</span>        self._advance()  <span class="comment"># Consumes 'typedef'</span>
<span class="line-number">1050</span>
<span class="line-number">1051</span>        <span class="comment"># Skip whitespace</span>
</pre>
<h4>Line 1055</h4>
<pre>
<span class="line-number">1050</span>
<span class="line-number">1051</span>        <span class="comment"># Skip whitespace</span>
<span class="line-number">1052</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> self._current_token_is(
<span class="line-number">1053</span>            TokenType.WHITESPACE
<span class="line-number">1054</span>        ):
<span class="line-number">1055</span><span class="uncovered">            self.pos += <span class="number">1</span></span>
<span class="line-number">1056</span>
<span class="line-number">1057</span>        <span class="comment"># Check <span class="keyword">if</span> next token <span class="keyword">is</span> 'union'</span>
<span class="line-number">1058</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(TokenType.UNION):
<span class="line-number">1059</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">1060</span>
</pre>
<h4>Line 1067</h4>
<pre>
<span class="line-number">1062</span>
<span class="line-number">1063</span>        <span class="comment"># Skip whitespace</span>
<span class="line-number">1064</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> self._current_token_is(
<span class="line-number">1065</span>            TokenType.WHITESPACE
<span class="line-number">1066</span>        ):
<span class="line-number">1067</span><span class="uncovered">            self.pos += <span class="number">1</span></span>
<span class="line-number">1068</span>
<span class="line-number">1069</span>        <span class="comment"># Get union tag name (optional)</span>
<span class="line-number">1070</span>        union_tag = <span class="string">""</span>
<span class="line-number">1071</span>        <span class=<span class="string">"keyword"</span>>if</span> self._current_token_is(TokenType.IDENTIFIER):
<span class="line-number">1072</span>            union_tag = self.<span class="function">_advance</span>().value
</pre>
<h4>Line 1072</h4>
<pre>
<span class="line-number">1067</span>            self.pos += <span class="number">1</span>
<span class="line-number">1068</span>
<span class="line-number">1069</span>        <span class="comment"># Get union tag name (optional)</span>
<span class="line-number">1070</span>        union_tag = <span class="string">""</span>
<span class="line-number">1071</span>        <span class=<span class="string">"keyword"</span>>if</span> self._current_token_is(TokenType.IDENTIFIER):
<span class="line-number">1072</span><span class="uncovered">            union_tag = self.<span class="function">_advance</span>().value</span>
<span class="line-number">1073</span>
<span class="line-number">1074</span>        <span class="comment"># Find opening brace</span>
<span class="line-number">1075</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(
<span class="line-number">1076</span>            TokenType.LBRACE
<span class="line-number">1077</span>        ):
</pre>
<h4>Line 1078</h4>
<pre>
<span class="line-number">1073</span>
<span class="line-number">1074</span>        <span class="comment"># Find opening brace</span>
<span class="line-number">1075</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(
<span class="line-number">1076</span>            TokenType.LBRACE
<span class="line-number">1077</span>        ):
<span class="line-number">1078</span><span class="uncovered">            self.pos += <span class="number">1</span></span>
<span class="line-number">1079</span>
<span class="line-number">1080</span>        <span class=<span class="string">"keyword"</span>>if</span> self.pos >= len(self.tokens):
<span class="line-number">1081</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">1082</span>
<span class="line-number">1083</span>        <span class="comment"># Find matching closing brace</span>
</pre>
<h4>Line 1081</h4>
<pre>
<span class="line-number">1076</span>            TokenType.LBRACE
<span class="line-number">1077</span>        ):
<span class="line-number">1078</span>            self.pos += <span class="number">1</span>
<span class="line-number">1079</span>
<span class="line-number">1080</span>        <span class=<span class="string">"keyword"</span>>if</span> self.pos >= len(self.tokens):
<span class="line-number">1081</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">1082</span>
<span class="line-number">1083</span>        <span class="comment"># Find matching closing brace</span>
<span class="line-number">1084</span>        end_pos = self.<span class="function">_find_matching_brace</span>(self.pos)
<span class="line-number">1085</span>        <span class=<span class="string">"keyword"</span>>if</span> end_pos <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">1086</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
</pre>
<h4>Line 1086</h4>
<pre>
<span class="line-number">1081</span>            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">1082</span>
<span class="line-number">1083</span>        <span class="comment"># Find matching closing brace</span>
<span class="line-number">1084</span>        end_pos = self.<span class="function">_find_matching_brace</span>(self.pos)
<span class="line-number">1085</span>        <span class=<span class="string">"keyword"</span>>if</span> end_pos <span class=<span class="string">"keyword"</span>>is</span> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">1086</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>None</span></span>
<span class="line-number">1087</span>
<span class="line-number">1088</span>        <span class="comment"># Look <span class="keyword">for</span> typedef name after closing brace</span>
<span class="line-number">1089</span>        typedef_name = <span class="string">""</span>
<span class="line-number">1090</span>        self.pos = end_pos + <span class="number">1</span>
<span class="line-number">1091</span>        <span class=<span class="string">"keyword"</span>>while</span> self.pos < len(self.tokens) <span class=<span class="string">"keyword"</span>>and</span> <span class=<span class="string">"keyword"</span>>not</span> self._current_token_is(
</pre>
<h4>Line 1097</h4>
<pre>
<span class="line-number">1092</span>            TokenType.SEMICOLON
<span class="line-number">1093</span>        ):
<span class="line-number">1094</span>            <span class=<span class="string">"keyword"</span>>if</span> self._current_token_is(TokenType.IDENTIFIER):
<span class="line-number">1095</span>                typedef_name = self.<span class="function">_advance</span>().value
<span class="line-number">1096</span>                <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">1097</span><span class="uncovered">            self.pos += <span class="number">1</span></span>
<span class="line-number">1098</span>
<span class="line-number">1099</span>        <span class=<span class="string">"keyword"</span>>return</span> (start_pos, end_pos, typedef_name)
<span class="line-number">1100</span>
<span class="line-number">1101</span>
<span class="line-number">1102</span><span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> extract_token_range(tokens: List[Token], start: int, end: int) -> str:
</pre>
<h4>Line 1126</h4>
<pre>
<span class="line-number">1121</span>    fields = []
<span class="line-number">1122</span>    pos = struct_start
<span class="line-number">1123</span>    <span class=<span class="string">"keyword"</span>>while</span> pos <= struct_end <span class=<span class="string">"keyword"</span>>and</span> tokens[pos].type != TokenType.LBRACE:
<span class="line-number">1124</span>        pos += <span class="number">1</span>
<span class="line-number">1125</span>    <span class=<span class="string">"keyword"</span>>if</span> pos > struct_end:
<span class="line-number">1126</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> fields</span>
<span class="line-number">1127</span>    pos += 1  <span class="comment"># Skip opening brace</span>
<span class="line-number">1128</span>
<span class="line-number">1129</span>    <span class="comment"># Find the closing brace position</span>
<span class="line-number">1130</span>    closing_brace_pos = pos
<span class="line-number">1131</span>    <span class=<span class="string">"keyword"</span>>while</span> (
</pre>
<h4>Line 1155</h4>
<pre>
<span class="line-number">1150</span>                <span class=<span class="string">"keyword"</span>>and</span> field_tokens[0].type == TokenType.STRUCT
<span class="line-number">1151</span>                <span class=<span class="string">"keyword"</span>>and</span> field_tokens[1].type == TokenType.LBRACE
<span class="line-number">1152</span>            ):
<span class="line-number">1153</span>                <span class="comment"># This <span class="keyword">is</span> a nested anonymous struct</span>
<span class="line-number">1154</span>                <span class="comment"># Find the struct name (last token before semicolon)</span>
<span class="line-number">1155</span><span class="uncovered">                field_name = field_tokens[-<span class="number">1</span>].value</span>
<span class="line-number">1156</span>                <span class="comment"># Create a simplified type representation <span class="keyword">for</span> nested struct</span>
<span class="line-number">1157</span>                field_type = <span class="string">"struct { ... }"</span>
<span class="line-number">1158</span>                <span class=<span class="string">"keyword"</span>>if</span> (
<span class="line-number">1159</span>                    field_name
<span class="line-number">1160</span>                    <span class=<span class="string">"keyword"</span>>and</span> field_name.strip()
</pre>
<h4>Lines 1157-1158</h4>
<pre>
<span class="line-number">1152</span>            ):
<span class="line-number">1153</span>                <span class="comment"># This <span class="keyword">is</span> a nested anonymous struct</span>
<span class="line-number">1154</span>                <span class="comment"># Find the struct name (last token before semicolon)</span>
<span class="line-number">1155</span>                field_name = field_tokens[-<span class="number">1</span>].value
<span class="line-number">1156</span>                <span class="comment"># Create a simplified type representation <span class="keyword">for</span> nested struct</span>
<span class="line-number">1157</span><span class="uncovered">                field_type = <span class="string">"struct { ... }"</span></span>
<span class="line-number">1158</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>if</span> (</span>
<span class="line-number">1159</span>                    field_name
<span class="line-number">1160</span>                    <span class=<span class="string">"keyword"</span>>and</span> field_name.strip()
<span class="line-number">1161</span>                    <span class=<span class="string">"keyword"</span>>and</span> field_name <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> [<span class="string">"["</span>, <span class="string">"]"</span>, <span class="string">";"</span>, <span class="string">"}"</span>]
<span class="line-number">1162</span>                ):
<span class="line-number">1163</span>                    stripped_name = field_name.<span class="function">strip</span>()
</pre>
<h4>Lines 1163-1165</h4>
<pre>
<span class="line-number">1158</span>                <span class=<span class="string">"keyword"</span>>if</span> (
<span class="line-number">1159</span>                    field_name
<span class="line-number">1160</span>                    <span class=<span class="string">"keyword"</span>>and</span> field_name.strip()
<span class="line-number">1161</span>                    <span class=<span class="string">"keyword"</span>>and</span> field_name <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> [<span class="string">"["</span>, <span class="string">"]"</span>, <span class="string">";"</span>, <span class="string">"}"</span>]
<span class="line-number">1162</span>                ):
<span class="line-number">1163</span><span class="uncovered">                    stripped_name = field_name.<span class="function">strip</span>()</span>
<span class="line-number">1164</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>if</span> stripped_name:</span>
<span class="line-number">1165</span><span class="uncovered">                        fields.<span class="function">append</span>((stripped_name, field_type))</span>
<span class="line-number">1166</span>                        <span class="comment"># Skip parsing the nested struct's fields <span class="keyword">as</span> separate fields</span>
<span class="line-number">1167</span>                        <span class=<span class="string">"keyword"</span>>continue</span>
<span class="line-number">1168</span>            <span class="comment"># Check <span class="keyword">if</span> this <span class="keyword">is</span> a nested struct field <span class="keyword">with</span> more complex structure</span>
<span class="line-number">1169</span>            <span class=<span class="string">"keyword"</span>>elif</span> (
<span class="line-number">1170</span>                <span class="function">len</span>(field_tokens) >= <span class="number">4</span>
</pre>
<h4>Line 1167</h4>
<pre>
<span class="line-number">1162</span>                ):
<span class="line-number">1163</span>                    stripped_name = field_name.<span class="function">strip</span>()
<span class="line-number">1164</span>                    <span class=<span class="string">"keyword"</span>>if</span> stripped_name:
<span class="line-number">1165</span>                        fields.<span class="function">append</span>((stripped_name, field_type))
<span class="line-number">1166</span>                        <span class="comment"># Skip parsing the nested struct's fields <span class="keyword">as</span> separate fields</span>
<span class="line-number">1167</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>continue</span></span>
<span class="line-number">1168</span>            <span class="comment"># Check <span class="keyword">if</span> this <span class="keyword">is</span> a nested struct field <span class="keyword">with</span> more complex structure</span>
<span class="line-number">1169</span>            <span class=<span class="string">"keyword"</span>>elif</span> (
<span class="line-number">1170</span>                <span class="function">len</span>(field_tokens) >= <span class="number">4</span>
<span class="line-number">1171</span>                <span class=<span class="string">"keyword"</span>>and</span> field_tokens[0].type == TokenType.STRUCT
<span class="line-number">1172</span>                <span class=<span class="string">"keyword"</span>>and</span> field_tokens[1].type == TokenType.LBRACE
</pre>
<h4>Lines 1176-1178</h4>
<pre>
<span class="line-number">1171</span>                <span class=<span class="string">"keyword"</span>>and</span> field_tokens[0].type == TokenType.STRUCT
<span class="line-number">1172</span>                <span class=<span class="string">"keyword"</span>>and</span> field_tokens[1].type == TokenType.LBRACE
<span class="line-number">1173</span>                <span class=<span class="string">"keyword"</span>>and</span> field_tokens[-1].type == TokenType.IDENTIFIER
<span class="line-number">1174</span>            ):
<span class="line-number">1175</span>                <span class="comment"># This <span class="keyword">is</span> a nested anonymous struct <span class="keyword">with</span> a name</span>
<span class="line-number">1176</span><span class="uncovered">                field_name = field_tokens[-<span class="number">1</span>].value</span>
<span class="line-number">1177</span><span class="uncovered">                field_type = <span class="string">"struct { ... }"</span></span>
<span class="line-number">1178</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>if</span> (</span>
<span class="line-number">1179</span>                    field_name
<span class="line-number">1180</span>                    <span class=<span class="string">"keyword"</span>>and</span> field_name.strip()
<span class="line-number">1181</span>                    <span class=<span class="string">"keyword"</span>>and</span> field_name <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> [<span class="string">"["</span>, <span class="string">"]"</span>, <span class="string">";"</span>, <span class="string">"}"</span>]
<span class="line-number">1182</span>                ):
<span class="line-number">1183</span>                    stripped_name = field_name.<span class="function">strip</span>()
</pre>
<h4>Lines 1183-1185</h4>
<pre>
<span class="line-number">1178</span>                <span class=<span class="string">"keyword"</span>>if</span> (
<span class="line-number">1179</span>                    field_name
<span class="line-number">1180</span>                    <span class=<span class="string">"keyword"</span>>and</span> field_name.strip()
<span class="line-number">1181</span>                    <span class=<span class="string">"keyword"</span>>and</span> field_name <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> [<span class="string">"["</span>, <span class="string">"]"</span>, <span class="string">";"</span>, <span class="string">"}"</span>]
<span class="line-number">1182</span>                ):
<span class="line-number">1183</span><span class="uncovered">                    stripped_name = field_name.<span class="function">strip</span>()</span>
<span class="line-number">1184</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>if</span> stripped_name:</span>
<span class="line-number">1185</span><span class="uncovered">                        fields.<span class="function">append</span>((stripped_name, field_type))</span>
<span class="line-number">1186</span>                        <span class="comment"># Skip parsing the nested struct's fields <span class="keyword">as</span> separate fields</span>
<span class="line-number">1187</span>                        <span class=<span class="string">"keyword"</span>>continue</span>
<span class="line-number">1188</span>            <span class="comment"># Array field: type name [ size ]</span>
<span class="line-number">1189</span>            <span class=<span class="string">"keyword"</span>>elif</span> (
<span class="line-number">1190</span>                <span class="function">len</span>(field_tokens) >= <span class="number">4</span>
</pre>
<h4>Line 1187</h4>
<pre>
<span class="line-number">1182</span>                ):
<span class="line-number">1183</span>                    stripped_name = field_name.<span class="function">strip</span>()
<span class="line-number">1184</span>                    <span class=<span class="string">"keyword"</span>>if</span> stripped_name:
<span class="line-number">1185</span>                        fields.<span class="function">append</span>((stripped_name, field_type))
<span class="line-number">1186</span>                        <span class="comment"># Skip parsing the nested struct's fields <span class="keyword">as</span> separate fields</span>
<span class="line-number">1187</span><span class="uncovered">                        <span class=<span class="string">"keyword"</span>>continue</span></span>
<span class="line-number">1188</span>            <span class="comment"># Array field: type name [ size ]</span>
<span class="line-number">1189</span>            <span class=<span class="string">"keyword"</span>>elif</span> (
<span class="line-number">1190</span>                <span class="function">len</span>(field_tokens) >= <span class="number">4</span>
<span class="line-number">1191</span>                <span class=<span class="string">"keyword"</span>>and</span> field_tokens[-3].type == TokenType.LBRACKET
<span class="line-number">1192</span>                <span class=<span class="string">"keyword"</span>>and</span> field_tokens[-1].type == TokenType.RBRACKET
</pre>
<h4>Line 1240</h4>
<pre>
<span class="line-number">1235</span>    values = []
<span class="line-number">1236</span>    pos = enum_start
<span class="line-number">1237</span>    <span class=<span class="string">"keyword"</span>>while</span> pos <= enum_end <span class=<span class="string">"keyword"</span>>and</span> tokens[pos].type != TokenType.LBRACE:
<span class="line-number">1238</span>        pos += <span class="number">1</span>
<span class="line-number">1239</span>    <span class=<span class="string">"keyword"</span>>if</span> pos > enum_end:
<span class="line-number">1240</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> values</span>
<span class="line-number">1241</span>    pos += 1  <span class="comment"># Skip opening brace</span>
<span class="line-number">1242</span>    current_value = []
<span class="line-number">1243</span>    <span class=<span class="string">"keyword"</span>>while</span> pos <= enum_end <span class=<span class="string">"keyword"</span>>and</span> tokens[pos].type != TokenType.RBRACE:
<span class="line-number">1244</span>        token = tokens[pos]
<span class="line-number">1245</span>        <span class=<span class="string">"keyword"</span>>if</span> token.type == TokenType.COMMA:
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/models.py - 86.54% coverage (225/260 lines)
</div>
<h4>Line 27</h4>
<pre>
<span class="line-number"> 22</span>        <span class=<span class="string">"keyword"</span>>return</span> f<span class="string">"Field(name={self.name}, type={self.type})"</span>
<span class="line-number"> 23</span>
<span class="line-number"> 24</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number"> 25</span>        <span class="string">""</span><span class="string">"Validate field data after initialization"</span><span class="string">""</span>
<span class="line-number"> 26</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.name, str):
<span class="line-number"> 27</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(</span>
<span class="line-number"> 28</span>                f<span class="string">"Field name must be a string, got {type(self.name)}: {repr(self.name)}"</span>
<span class="line-number"> 29</span>            )
<span class="line-number"> 30</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.type, str):
<span class="line-number"> 31</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(
<span class="line-number"> 32</span>                f<span class="string">"Field type must be a non-empty string, got {type(self.type)}: {repr(self.type)}"</span>
</pre>
<h4>Line 31</h4>
<pre>
<span class="line-number"> 26</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.name, str):
<span class="line-number"> 27</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(
<span class="line-number"> 28</span>                f<span class="string">"Field name must be a string, got {type(self.name)}: {repr(self.name)}"</span>
<span class="line-number"> 29</span>            )
<span class="line-number"> 30</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.type, str):
<span class="line-number"> 31</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(</span>
<span class="line-number"> 32</span>                f<span class="string">"Field type must be a non-empty string, got {type(self.type)}: {repr(self.type)}"</span>
<span class="line-number"> 33</span>            )
<span class="line-number"> 34</span>
<span class="line-number"> 35</span>        <span class="comment"># Additional validation: ensure name <span class="keyword">and</span> type are <span class="keyword">not</span> just whitespace</span>
<span class="line-number"> 36</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name.strip():
</pre>
<h4>Line 37</h4>
<pre>
<span class="line-number"> 32</span>                f<span class="string">"Field type must be a non-empty string, got {type(self.type)}: {repr(self.type)}"</span>
<span class="line-number"> 33</span>            )
<span class="line-number"> 34</span>
<span class="line-number"> 35</span>        <span class="comment"># Additional validation: ensure name <span class="keyword">and</span> type are <span class="keyword">not</span> just whitespace</span>
<span class="line-number"> 36</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name.strip():
<span class="line-number"> 37</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(</span>
<span class="line-number"> 38</span>                f<span class="string">"Field name cannot be empty <span class="</span>keyword<span class="string">">or</span> whitespace, got: {repr(self.name)}"</span>
<span class="line-number"> 39</span>            )
<span class="line-number"> 40</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.type.strip():
<span class="line-number"> 41</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(
<span class="line-number"> 42</span>                f<span class="string">"Field type cannot be empty <span class="</span>keyword<span class="string">">or</span> whitespace, got: {repr(self.type)}"</span>
</pre>
<h4>Line 41</h4>
<pre>
<span class="line-number"> 36</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name.strip():
<span class="line-number"> 37</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(
<span class="line-number"> 38</span>                f<span class="string">"Field name cannot be empty <span class="</span>keyword<span class="string">">or</span> whitespace, got: {repr(self.name)}"</span>
<span class="line-number"> 39</span>            )
<span class="line-number"> 40</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.type.strip():
<span class="line-number"> 41</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(</span>
<span class="line-number"> 42</span>                f<span class="string">"Field type cannot be empty <span class="</span>keyword<span class="string">">or</span> whitespace, got: {repr(self.type)}"</span>
<span class="line-number"> 43</span>            )
<span class="line-number"> 44</span>
<span class="line-number"> 45</span>
<span class="line-number"> 46</span><span class="comment"># TypedefRelation <span class="keyword">class</span> removed - tag names moved to struct/enum/union</span>
</pre>
<h4>Line 60</h4>
<pre>
<span class="line-number"> 55</span>    depth: int
<span class="line-number"> 56</span>
<span class="line-number"> 57</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number"> 58</span>        <span class="string">""</span><span class="string">"Validate include relation data after initialization"</span><span class="string">""</span>
<span class="line-number"> 59</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.source_file <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.source_file, str):
<span class="line-number"> 60</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Source file must be a non-empty string"</span>)</span>
<span class="line-number"> 61</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.included_file <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.included_file, str):
<span class="line-number"> 62</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Included file must be a non-empty string"</span>)
<span class="line-number"> 63</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.depth, int) <span class=<span class="string">"keyword"</span>>or</span> self.depth < 0:
<span class="line-number"> 64</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Depth must be a non-negative integer"</span>)
<span class="line-number"> 65</span>
</pre>
<h4>Line 62</h4>
<pre>
<span class="line-number"> 57</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number"> 58</span>        <span class="string">""</span><span class="string">"Validate include relation data after initialization"</span><span class="string">""</span>
<span class="line-number"> 59</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.source_file <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.source_file, str):
<span class="line-number"> 60</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Source file must be a non-empty string"</span>)
<span class="line-number"> 61</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.included_file <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.included_file, str):
<span class="line-number"> 62</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Included file must be a non-empty string"</span>)</span>
<span class="line-number"> 63</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.depth, int) <span class=<span class="string">"keyword"</span>>or</span> self.depth < 0:
<span class="line-number"> 64</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Depth must be a non-negative integer"</span>)
<span class="line-number"> 65</span>
<span class="line-number"> 66</span>
<span class="line-number"> 67</span>@dataclass
</pre>
<h4>Line 64</h4>
<pre>
<span class="line-number"> 59</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.source_file <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.source_file, str):
<span class="line-number"> 60</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Source file must be a non-empty string"</span>)
<span class="line-number"> 61</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.included_file <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.included_file, str):
<span class="line-number"> 62</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Included file must be a non-empty string"</span>)
<span class="line-number"> 63</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.depth, int) <span class=<span class="string">"keyword"</span>>or</span> self.depth < 0:
<span class="line-number"> 64</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Depth must be a non-negative integer"</span>)</span>
<span class="line-number"> 65</span>
<span class="line-number"> 66</span>
<span class="line-number"> 67</span>@dataclass
<span class="line-number"> 68</span><span class=<span class="string">"keyword"</span>>class</span> Function:
<span class="line-number"> 69</span>    <span class="string">""</span><span class="string">"Represents a function"</span><span class="string">""</span>
</pre>
<h4>Line 80</h4>
<pre>
<span class="line-number"> 75</span>    is_declaration: bool = <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number"> 76</span>
<span class="line-number"> 77</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number"> 78</span>        <span class="string">""</span><span class="string">"Validate function data after initialization"</span><span class="string">""</span>
<span class="line-number"> 79</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.name, str):
<span class="line-number"> 80</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Function name must be a non-empty string"</span>)</span>
<span class="line-number"> 81</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.return_type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.return_type, str):
<span class="line-number"> 82</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Function <span class="</span>keyword<span class="string">">return</span> type must be a non-empty string"</span>)
<span class="line-number"> 83</span>
<span class="line-number"> 84</span>        <span class="comment"># Convert parameters to Field objects <span class="keyword">if</span> they're dictionaries</span>
<span class="line-number"> 85</span>        <span class=<span class="string">"keyword"</span>>if</span> self.parameters:
</pre>
<h4>Line 82</h4>
<pre>
<span class="line-number"> 77</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number"> 78</span>        <span class="string">""</span><span class="string">"Validate function data after initialization"</span><span class="string">""</span>
<span class="line-number"> 79</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.name, str):
<span class="line-number"> 80</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Function name must be a non-empty string"</span>)
<span class="line-number"> 81</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.return_type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.return_type, str):
<span class="line-number"> 82</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Function <span class="</span>keyword<span class="string">">return</span> type must be a non-empty string"</span>)</span>
<span class="line-number"> 83</span>
<span class="line-number"> 84</span>        <span class="comment"># Convert parameters to Field objects <span class="keyword">if</span> they're dictionaries</span>
<span class="line-number"> 85</span>        <span class=<span class="string">"keyword"</span>>if</span> self.parameters:
<span class="line-number"> 86</span>            converted_params = []
<span class="line-number"> 87</span>            <span class=<span class="string">"keyword"</span>>for</span> param <span class=<span class="string">"keyword"</span>>in</span> self.parameters:
</pre>
<h4>Line 110</h4>
<pre>
<span class="line-number">105</span>    )  <span class="comment"># Non-primitive types used by this struct</span>
<span class="line-number">106</span>
<span class="line-number">107</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">108</span>        <span class="string">""</span><span class="string">"Validate struct data after initialization"</span><span class="string">""</span>
<span class="line-number">109</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.name, str):
<span class="line-number">110</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Struct name must be a non-empty string"</span>)</span>
<span class="line-number">111</span>
<span class="line-number">112</span>
<span class="line-number">113</span>@dataclass
<span class="line-number">114</span><span class=<span class="string">"keyword"</span>>class</span> EnumValue:
<span class="line-number">115</span>    name: str
</pre>
<h4>Line 120</h4>
<pre>
<span class="line-number">115</span>    name: str
<span class="line-number">116</span>    value: Optional[str] = <span class=<span class="string">"keyword"</span>>None</span>
<span class="line-number">117</span>
<span class="line-number">118</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">119</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.name, str):
<span class="line-number">120</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Enum value name must be a non-empty string"</span>)</span>
<span class="line-number">121</span>
<span class="line-number">122</span>
<span class="line-number">123</span>@dataclass
<span class="line-number">124</span><span class=<span class="string">"keyword"</span>>class</span> Enum:
<span class="line-number">125</span>    <span class="string">""</span><span class="string">"Represents a C enum"</span><span class="string">""</span>
</pre>
<h4>Line 133</h4>
<pre>
<span class="line-number">128</span>    values: List[EnumValue] = <span class="function">field</span>(default_factory=list)
<span class="line-number">129</span>    tag_name: str = ""  <span class="comment"># Tag name <span class="keyword">for</span> typedef enums</span>
<span class="line-number">130</span>
<span class="line-number">131</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">132</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.name, str):
<span class="line-number">133</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Enum name must be a non-empty string"</span>)</span>
<span class="line-number">134</span>        <span class="comment"># Convert any string values to EnumValue</span>
<span class="line-number">135</span>        self.values = [
<span class="line-number">136</span>            v <span class=<span class="string">"keyword"</span>>if</span> isinstance(v, EnumValue) <span class=<span class="string">"keyword"</span>>else</span> EnumValue(v) <span class=<span class="string">"keyword"</span>>for</span> v <span class=<span class="string">"keyword"</span>>in</span> self.values
<span class="line-number">137</span>        ]
<span class="line-number">138</span>
</pre>
<h4>Line 154</h4>
<pre>
<span class="line-number">149</span>    )  <span class="comment"># Non-primitive types used by this union</span>
<span class="line-number">150</span>
<span class="line-number">151</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">152</span>        <span class="string">""</span><span class="string">"Validate union data after initialization"</span><span class="string">""</span>
<span class="line-number">153</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.name, str):
<span class="line-number">154</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Union name must be a non-empty string"</span>)</span>
<span class="line-number">155</span>
<span class="line-number">156</span>
<span class="line-number">157</span>@dataclass
<span class="line-number">158</span><span class=<span class="string">"keyword"</span>>class</span> Alias:
<span class="line-number">159</span>    <span class="string">""</span><span class="string">"Represents a type alias (typedef)"</span><span class="string">""</span>
</pre>
<h4>Line 170</h4>
<pre>
<span class="line-number">165</span>    )  <span class="comment"># Non-primitive types used by this alias</span>
<span class="line-number">166</span>
<span class="line-number">167</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">168</span>        <span class="string">""</span><span class="string">"Validate alias data after initialization"</span><span class="string">""</span>
<span class="line-number">169</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.name, str):
<span class="line-number">170</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Alias name must be a non-empty string"</span>)</span>
<span class="line-number">171</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.original_type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.original_type, str):
<span class="line-number">172</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Original type must be a non-empty string"</span>)
<span class="line-number">173</span>
<span class="line-number">174</span>
<span class="line-number">175</span>@dataclass
</pre>
<h4>Line 172</h4>
<pre>
<span class="line-number">167</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">168</span>        <span class="string">""</span><span class="string">"Validate alias data after initialization"</span><span class="string">""</span>
<span class="line-number">169</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.name, str):
<span class="line-number">170</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Alias name must be a non-empty string"</span>)
<span class="line-number">171</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.original_type <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.original_type, str):
<span class="line-number">172</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Original type must be a non-empty string"</span>)</span>
<span class="line-number">173</span>
<span class="line-number">174</span>
<span class="line-number">175</span>@dataclass
<span class="line-number">176</span><span class=<span class="string">"keyword"</span>>class</span> FileModel:
<span class="line-number">177</span>    <span class="string">""</span><span class="string">"Represents a parsed C/C++ file"</span><span class="string">""</span>
</pre>
<h4>Line 196</h4>
<pre>
<span class="line-number">191</span>    include_relations: List[IncludeRelation] = <span class="function">field</span>(default_factory=list)
<span class="line-number">192</span>
<span class="line-number">193</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">194</span>        <span class="string">""</span><span class="string">"Validate file model data after initialization"</span><span class="string">""</span>
<span class="line-number">195</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.file_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.file_path, str):
<span class="line-number">196</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"File path must be a non-empty string"</span>)</span>
<span class="line-number">197</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.relative_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.relative_path, str):
<span class="line-number">198</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Relative path must be a non-empty string"</span>)
<span class="line-number">199</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.project_root <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.project_root, str):
<span class="line-number">200</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Project root must be a non-empty string"</span>)
<span class="line-number">201</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.encoding_used <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.encoding_used, str):
</pre>
<h4>Line 198</h4>
<pre>
<span class="line-number">193</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">194</span>        <span class="string">""</span><span class="string">"Validate file model data after initialization"</span><span class="string">""</span>
<span class="line-number">195</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.file_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.file_path, str):
<span class="line-number">196</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"File path must be a non-empty string"</span>)
<span class="line-number">197</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.relative_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.relative_path, str):
<span class="line-number">198</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Relative path must be a non-empty string"</span>)</span>
<span class="line-number">199</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.project_root <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.project_root, str):
<span class="line-number">200</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Project root must be a non-empty string"</span>)
<span class="line-number">201</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.encoding_used <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.encoding_used, str):
<span class="line-number">202</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Encoding must be a non-empty string"</span>)
<span class="line-number">203</span>
</pre>
<h4>Line 200</h4>
<pre>
<span class="line-number">195</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.file_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.file_path, str):
<span class="line-number">196</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"File path must be a non-empty string"</span>)
<span class="line-number">197</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.relative_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.relative_path, str):
<span class="line-number">198</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Relative path must be a non-empty string"</span>)
<span class="line-number">199</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.project_root <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.project_root, str):
<span class="line-number">200</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Project root must be a non-empty string"</span>)</span>
<span class="line-number">201</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.encoding_used <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.encoding_used, str):
<span class="line-number">202</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Encoding must be a non-empty string"</span>)
<span class="line-number">203</span>
<span class="line-number">204</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> to_dict(self) -> dict:
<span class="line-number">205</span>        <span class="string">""</span><span class="string">"Convert to dictionary <span class="</span>keyword<span class="string">">for</span> JSON serialization"</span><span class="string">""</span>
</pre>
<h4>Line 202</h4>
<pre>
<span class="line-number">197</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.relative_path <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.relative_path, str):
<span class="line-number">198</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Relative path must be a non-empty string"</span>)
<span class="line-number">199</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.project_root <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.project_root, str):
<span class="line-number">200</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Project root must be a non-empty string"</span>)
<span class="line-number">201</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.encoding_used <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.encoding_used, str):
<span class="line-number">202</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Encoding must be a non-empty string"</span>)</span>
<span class="line-number">203</span>
<span class="line-number">204</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> to_dict(self) -> dict:
<span class="line-number">205</span>        <span class="string">""</span><span class="string">"Convert to dictionary <span class="</span>keyword<span class="string">">for</span> JSON serialization"</span><span class="string">""</span>
<span class="line-number">206</span>        data = <span class="function">asdict</span>(self)
<span class="line-number">207</span>        <span class="comment"># Convert set to list <span class="keyword">for</span> JSON serialization <span class="keyword">and</span> sort <span class="keyword">for</span> consistency</span>
</pre>
<h4>Line 278</h4>
<pre>
<span class="line-number">273</span>                    methods=methods,
<span class="line-number">274</span>                    tag_name=struct_data.get(<span class="string">"tag_name"</span>, <span class="string">""</span>),
<span class="line-number">275</span>                    uses=struct_data.get(<span class="string">"uses"</span>, []),
<span class="line-number">276</span>                )
<span class="line-number">277</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">278</span><span class="uncovered">                structs[name] = struct_data</span>
<span class="line-number">279</span>
<span class="line-number">280</span>        <span class="comment"># Convert enums back to Enum objects</span>
<span class="line-number">281</span>        enums_data = data.get(<span class="string">"enums"</span>, {})
<span class="line-number">282</span>        enums = {}
<span class="line-number">283</span>        <span class=<span class="string">"keyword"</span>>for</span> name, enum_data <span class=<span class="string">"keyword"</span>>in</span> enums_data.items():
</pre>
<h4>Line 291</h4>
<pre>
<span class="line-number">286</span>                    EnumValue(**val) <span class=<span class="string">"keyword"</span>>if</span> isinstance(val, dict) <span class=<span class="string">"keyword"</span>>else</span> EnumValue(val)
<span class="line-number">287</span>                    <span class=<span class="string">"keyword"</span>>for</span> val <span class=<span class="string">"keyword"</span>>in</span> enum_data.get(<span class="string">"values"</span>, [])
<span class="line-number">288</span>                ]
<span class="line-number">289</span>                enums[name] = Enum(name=enum_data.get(<span class="string">"name"</span>, name), values=values)
<span class="line-number">290</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">291</span><span class="uncovered">                enums[name] = enum_data</span>
<span class="line-number">292</span>
<span class="line-number">293</span>        <span class="comment"># typedef_relations removed - tag names are now <span class="keyword">in</span> struct/enum/union</span>
<span class="line-number">294</span>
<span class="line-number">295</span>        <span class="comment"># Convert include_relations back to IncludeRelation objects</span>
<span class="line-number">296</span>        include_relations_data = data.get(<span class="string">"include_relations"</span>, [])
</pre>
<h4>Line 318</h4>
<pre>
<span class="line-number">313</span>                    fields=fields,
<span class="line-number">314</span>                    tag_name=union_data.get(<span class="string">"tag_name"</span>, <span class="string">""</span>),
<span class="line-number">315</span>                    uses=union_data.get(<span class="string">"uses"</span>, []),
<span class="line-number">316</span>                )
<span class="line-number">317</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">318</span><span class="uncovered">                unions[name] = union_data</span>
<span class="line-number">319</span>
<span class="line-number">320</span>        <span class="comment"># Convert aliases back to Alias objects</span>
<span class="line-number">321</span>        aliases_data = data.get(<span class="string">"aliases"</span>, {})
<span class="line-number">322</span>        aliases = {}
<span class="line-number">323</span>        <span class=<span class="string">"keyword"</span>>for</span> name, alias_data <span class=<span class="string">"keyword"</span>>in</span> aliases_data.items():
</pre>
<h4>Line 332</h4>
<pre>
<span class="line-number">327</span>                    original_type=alias_data.get(<span class="string">"original_type"</span>, <span class="string">""</span>),
<span class="line-number">328</span>                    uses=alias_data.get(<span class="string">"uses"</span>, []),
<span class="line-number">329</span>                )
<span class="line-number">330</span>            <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number">331</span>                <span class="comment"># Handle legacy format where aliases was Dict[str, str]</span>
<span class="line-number">332</span><span class="uncovered">                aliases[name] = <span class="function">Alias</span>(name=name, original_type=alias_data, uses=[])</span>
<span class="line-number">333</span>
<span class="line-number">334</span>        <span class="comment"># Create new data dict <span class="keyword">with</span> converted objects</span>
<span class="line-number">335</span>        new_data = data.<span class="function">copy</span>()
<span class="line-number">336</span>        new_data[<span class="string">"includes"</span>] = includes
<span class="line-number">337</span>        new_data[<span class="string">"globals"</span>] = globals
</pre>
<h4>Line 349</h4>
<pre>
<span class="line-number">344</span>
<span class="line-number">345</span>        <span class=<span class="string">"keyword"</span>>return</span> cls(**new_data)
<span class="line-number">346</span>
<span class="line-number">347</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> get_summary(self) -> dict:
<span class="line-number">348</span>        <span class="string">""</span><span class="string">"Get a summary of the file contents"</span><span class="string">""</span>
<span class="line-number">349</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> {</span>
<span class="line-number">350</span>            <span class="string">"file_path"</span>: self.file_path,
<span class="line-number">351</span>            <span class="string">"structs_count"</span>: len(self.structs),
<span class="line-number">352</span>            <span class="string">"enums_count"</span>: len(self.enums),
<span class="line-number">353</span>            <span class="string">"functions_count"</span>: len(self.functions),
<span class="line-number">354</span>            <span class="string">"globals_count"</span>: len(self.globals),
</pre>
<h4>Line 372</h4>
<pre>
<span class="line-number">367</span>    files: Dict[str, FileModel] = <span class="function">field</span>(default_factory=dict)
<span class="line-number">368</span>
<span class="line-number">369</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">370</span>        <span class="string">""</span><span class="string">"Validate project model data after initialization"</span><span class="string">""</span>
<span class="line-number">371</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.project_name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.project_name, str):
<span class="line-number">372</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Project name must be a non-empty string"</span>)</span>
<span class="line-number">373</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.project_root <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.project_root, str):
<span class="line-number">374</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Project root must be a non-empty string"</span>)
<span class="line-number">375</span>
<span class="line-number">376</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> save(self, file_path: str) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">377</span>        <span class="string">""</span><span class="string">"Save model to JSON file"</span><span class="string">""</span>
</pre>
<h4>Line 374</h4>
<pre>
<span class="line-number">369</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">370</span>        <span class="string">""</span><span class="string">"Validate project model data after initialization"</span><span class="string">""</span>
<span class="line-number">371</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.project_name <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.project_name, str):
<span class="line-number">372</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Project name must be a non-empty string"</span>)
<span class="line-number">373</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> self.project_root <span class=<span class="string">"keyword"</span>>or</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(self.project_root, str):
<span class="line-number">374</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Project root must be a non-empty string"</span>)</span>
<span class="line-number">375</span>
<span class="line-number">376</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> save(self, file_path: str) -> <span class=<span class="string">"keyword"</span>>None</span>:
<span class="line-number">377</span>        <span class="string">""</span><span class="string">"Save model to JSON file"</span><span class="string">""</span>
<span class="line-number">378</span>        data = {
<span class="line-number">379</span>            <span class="string">"project_name"</span>: self.project_name,
</pre>
<h4>Lines 390-391</h4>
<pre>
<span class="line-number">385</span>        }
<span class="line-number">386</span>
<span class="line-number">387</span>        <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">388</span>            <span class=<span class="string">"keyword"</span>>with</span> open(file_path, <span class="string">"w"</span>, encoding=<span class="string">"utf-8"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:
<span class="line-number">389</span>                json.dump(data, f, indent=2, ensure_ascii=<span class=<span class="string">"keyword"</span>>False</span>, sort_keys=<span class=<span class="string">"keyword"</span>>True</span>)
<span class="line-number">390</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>except</span> Exception <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">391</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(f<span class="string">"Failed to save model to {file_path}: {e}"</span>) <span class=<span class="string">"keyword"</span>>from</span> e</span>
<span class="line-number">392</span>
<span class="line-number">393</span>    @classmethod
<span class="line-number">394</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> from_dict(cls, data: dict) -> <span class="string">"ProjectModel"</span>:
<span class="line-number">395</span>        <span class="string">""</span><span class="string">"Create <span class="</span>keyword<span class="string">">from</span> dictionary"</span><span class="string">""</span>
<span class="line-number">396</span>        files = {
</pre>
<h4>Lines 414-415</h4>
<pre>
<span class="line-number">409</span>        <span class="string">""</span><span class="string">"Load model <span class="</span>keyword<span class="string">">from</span> JSON file"</span><span class="string">""</span>
<span class="line-number">410</span>        <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">411</span>            <span class=<span class="string">"keyword"</span>>with</span> open(file_path, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:
<span class="line-number">412</span>                data = json.<span class="function">load</span>(f)
<span class="line-number">413</span>            <span class=<span class="string">"keyword"</span>>return</span> cls.from_dict(data)
<span class="line-number">414</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>except</span> Exception <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">415</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(f<span class="string">"Failed to load model <span class="</span>keyword<span class="string">">from</span> {file_path}: {e}"</span>) <span class=<span class="string">"keyword"</span>>from</span> e</span>
<span class="line-number">416</span>
<span class="line-number">417</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> get_summary(self) -> dict:
<span class="line-number">418</span>        <span class="string">""</span><span class="string">"Get a summary of the project"</span><span class="string">""</span>
<span class="line-number">419</span>        total_structs = sum(len(f.structs) <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> self.files.values())
<span class="line-number">420</span>        total_enums = sum(len(f.enums) <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> self.files.values())
</pre>
<h4>Lines 419-422</h4>
<pre>
<span class="line-number">414</span>        <span class=<span class="string">"keyword"</span>>except</span> Exception <span class=<span class="string">"keyword"</span>>as</span> e:
<span class="line-number">415</span>            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(f<span class="string">"Failed to load model <span class="</span>keyword<span class="string">">from</span> {file_path}: {e}"</span>) <span class=<span class="string">"keyword"</span>>from</span> e
<span class="line-number">416</span>
<span class="line-number">417</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> get_summary(self) -> dict:
<span class="line-number">418</span>        <span class="string">""</span><span class="string">"Get a summary of the project"</span><span class="string">""</span>
<span class="line-number">419</span><span class="uncovered">        total_structs = sum(len(f.structs) <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> self.files.values())</span>
<span class="line-number">420</span><span class="uncovered">        total_enums = sum(len(f.enums) <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> self.files.values())</span>
<span class="line-number">421</span><span class="uncovered">        total_functions = sum(len(f.functions) <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> self.files.values())</span>
<span class="line-number">422</span><span class="uncovered">        total_globals = sum(len(f.globals) <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> self.files.values())</span>
<span class="line-number">423</span>
<span class="line-number">424</span>        <span class=<span class="string">"keyword"</span>>return</span> {
<span class="line-number">425</span>            <span class="string">"project_name"</span>: self.project_name,
<span class="line-number">426</span>            <span class="string">"project_root"</span>: self.project_root,
<span class="line-number">427</span>            <span class="string">"files_count"</span>: len(self.files),
</pre>
<h4>Line 424</h4>
<pre>
<span class="line-number">419</span>        total_structs = sum(len(f.structs) <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> self.files.values())
<span class="line-number">420</span>        total_enums = sum(len(f.enums) <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> self.files.values())
<span class="line-number">421</span>        total_functions = sum(len(f.functions) <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> self.files.values())
<span class="line-number">422</span>        total_globals = sum(len(f.globals) <span class=<span class="string">"keyword"</span>>for</span> f <span class=<span class="string">"keyword"</span>>in</span> self.files.values())
<span class="line-number">423</span>
<span class="line-number">424</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>return</span> {</span>
<span class="line-number">425</span>            <span class="string">"project_name"</span>: self.project_name,
<span class="line-number">426</span>            <span class="string">"project_root"</span>: self.project_root,
<span class="line-number">427</span>            <span class="string">"files_count"</span>: len(self.files),
<span class="line-number">428</span>            <span class="string">"total_structs"</span>: total_structs,
<span class="line-number">429</span>            <span class="string">"total_enums"</span>: total_enums,
</pre>
</div>
<div class="file-section">
<div class="file-header">
/workspace/c_to_plantuml/config.py - 89.00% coverage (178/200 lines)
</div>
<h4>Line 54</h4>
<pre>
<span class="line-number"> 49</span>        <span class="comment"># Initialize <span class="keyword">with</span> default values first</span>
<span class="line-number"> 50</span>        object.<span class="function">__init__</span>(self)
<span class="line-number"> 51</span>
<span class="line-number"> 52</span>        <span class="comment"># Ensure all dataclass fields are initialized <span class="keyword">with</span> defaults</span>
<span class="line-number"> 53</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"project_name"</span>):
<span class="line-number"> 54</span><span class="uncovered">            self.project_name = <span class="string">"Unknown_Project"</span></span>
<span class="line-number"> 55</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"source_folders"</span>):
<span class="line-number"> 56</span>            self.source_folders = []
<span class="line-number"> 57</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"output_dir"</span>):
<span class="line-number"> 58</span>            self.output_dir = <span class="string">"./output"</span>
<span class="line-number"> 59</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"model_output_path"</span>):
</pre>
<h4>Line 58</h4>
<pre>
<span class="line-number"> 53</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"project_name"</span>):
<span class="line-number"> 54</span>            self.project_name = <span class="string">"Unknown_Project"</span>
<span class="line-number"> 55</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"source_folders"</span>):
<span class="line-number"> 56</span>            self.source_folders = []
<span class="line-number"> 57</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"output_dir"</span>):
<span class="line-number"> 58</span><span class="uncovered">            self.output_dir = <span class="string">"./output"</span></span>
<span class="line-number"> 59</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"model_output_path"</span>):
<span class="line-number"> 60</span>            self.model_output_path = <span class="string">"model.json"</span>
<span class="line-number"> 61</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"recursive_search"</span>):
<span class="line-number"> 62</span>            self.recursive_search = <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number"> 63</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"include_depth"</span>):
</pre>
<h4>Line 60</h4>
<pre>
<span class="line-number"> 55</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"source_folders"</span>):
<span class="line-number"> 56</span>            self.source_folders = []
<span class="line-number"> 57</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"output_dir"</span>):
<span class="line-number"> 58</span>            self.output_dir = <span class="string">"./output"</span>
<span class="line-number"> 59</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"model_output_path"</span>):
<span class="line-number"> 60</span><span class="uncovered">            self.model_output_path = <span class="string">"model.json"</span></span>
<span class="line-number"> 61</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"recursive_search"</span>):
<span class="line-number"> 62</span>            self.recursive_search = <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number"> 63</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"include_depth"</span>):
<span class="line-number"> 64</span>            self.include_depth = <span class="number">1</span>
<span class="line-number"> 65</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"file_filters"</span>):
</pre>
<h4>Line 62</h4>
<pre>
<span class="line-number"> 57</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"output_dir"</span>):
<span class="line-number"> 58</span>            self.output_dir = <span class="string">"./output"</span>
<span class="line-number"> 59</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"model_output_path"</span>):
<span class="line-number"> 60</span>            self.model_output_path = <span class="string">"model.json"</span>
<span class="line-number"> 61</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"recursive_search"</span>):
<span class="line-number"> 62</span><span class="uncovered">            self.recursive_search = <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number"> 63</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"include_depth"</span>):
<span class="line-number"> 64</span>            self.include_depth = <span class="number">1</span>
<span class="line-number"> 65</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"file_filters"</span>):
<span class="line-number"> 66</span>            self.file_filters = {}
<span class="line-number"> 67</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"element_filters"</span>):
</pre>
<h4>Line 64</h4>
<pre>
<span class="line-number"> 59</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"model_output_path"</span>):
<span class="line-number"> 60</span>            self.model_output_path = <span class="string">"model.json"</span>
<span class="line-number"> 61</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"recursive_search"</span>):
<span class="line-number"> 62</span>            self.recursive_search = <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number"> 63</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"include_depth"</span>):
<span class="line-number"> 64</span><span class="uncovered">            self.include_depth = <span class="number">1</span></span>
<span class="line-number"> 65</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"file_filters"</span>):
<span class="line-number"> 66</span>            self.file_filters = {}
<span class="line-number"> 67</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"element_filters"</span>):
<span class="line-number"> 68</span>            self.element_filters = {}
<span class="line-number"> 69</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> hasattr(self, <span class="string">"transformations"</span>):
</pre>
<h4>Lines 89-92</h4>
<pre>
<span class="line-number"> 84</span>            <span class=<span class="string">"keyword"</span>>for</span> key, value <span class=<span class="string">"keyword"</span>>in</span> data.items():
<span class="line-number"> 85</span>                <span class=<span class="string">"keyword"</span>>if</span> hasattr(self, key):
<span class="line-number"> 86</span>                    <span class="function">setattr</span>(self, key, value)
<span class="line-number"> 87</span>        <span class=<span class="string">"keyword"</span>>elif</span> len(kwargs) == 1 <span class=<span class="string">"keyword"</span>>and</span> isinstance(next(iter(kwargs.values())), dict):
<span class="line-number"> 88</span>            <span class="comment"># Handle case where a single dict <span class="keyword">is</span> passed <span class="keyword">as</span> keyword argument</span>
<span class="line-number"> 89</span><span class="uncovered">            data = <span class="function">next</span>(<span class="function">iter</span>(kwargs.<span class="function">values</span>()))</span>
<span class="line-number"> 90</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>for</span> key, value <span class=<span class="string">"keyword"</span>>in</span> data.items():</span>
<span class="line-number"> 91</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>if</span> hasattr(self, key):</span>
<span class="line-number"> 92</span><span class="uncovered">                    <span class="function">setattr</span>(self, key, value)</span>
<span class="line-number"> 93</span>        <span class=<span class="string">"keyword"</span>>else</span>:
<span class="line-number"> 94</span>            <span class="comment"># Handle normal keyword arguments</span>
<span class="line-number"> 95</span>            <span class=<span class="string">"keyword"</span>>for</span> key, value <span class=<span class="string">"keyword"</span>>in</span> kwargs.items():
<span class="line-number"> 96</span>                <span class=<span class="string">"keyword"</span>>if</span> hasattr(self, key):
<span class="line-number"> 97</span>                    <span class="function">setattr</span>(self, key, value)
</pre>
<h4>Line 104</h4>
<pre>
<span class="line-number"> 99</span>        <span class="comment"># Compile patterns after initialization</span>
<span class="line-number">100</span>        self.<span class="function">_compile_patterns</span>()
<span class="line-number">101</span>
<span class="line-number">102</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __post_init__(self):
<span class="line-number">103</span>        <span class="string">""</span><span class="string">"Compile regex patterns after initialization"</span><span class="string">""</span>
<span class="line-number">104</span><span class="uncovered">        self.<span class="function">_compile_patterns</span>()</span>
<span class="line-number">105</span>
<span class="line-number">106</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> _compile_patterns(self):
<span class="line-number">107</span>        <span class="string">""</span><span class="string">"Compile regex patterns <span class="</span>keyword<span class="string">">for</span> filtering"</span><span class="string">""</span>
<span class="line-number">108</span>        <span class="comment"># Compile file filter patterns <span class="keyword">with</span> error handling</span>
<span class="line-number">109</span>        self.file_include_patterns = []
</pre>
<h4>Lines 148-149</h4>
<pre>
<span class="line-number">143</span>            <span class=<span class="string">"keyword"</span>>for</span> pattern <span class=<span class="string">"keyword"</span>>in</span> filters.get(<span class="string">"exclude"</span>, []):
<span class="line-number">144</span>                <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">145</span>                    self.element_exclude_patterns[element_type].<span class="function">append</span>(
<span class="line-number">146</span>                        re.<span class="function">compile</span>(pattern)
<span class="line-number">147</span>                    )
<span class="line-number">148</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>except</span> re.error <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">149</span><span class="uncovered">                    self.logger.<span class="function">warning</span>(</span>
<span class="line-number">150</span>                        <span class="string">"Invalid %s exclude pattern <span class="string">'%s'</span>: %s"</span>, element_type, pattern, e
<span class="line-number">151</span>                    )
<span class="line-number">152</span>                    <span class="comment"># Skip invalid patterns</span>
<span class="line-number">153</span>
<span class="line-number">154</span>    @classmethod
</pre>
<h4>Line 158</h4>
<pre>
<span class="line-number">153</span>
<span class="line-number">154</span>    @classmethod
<span class="line-number">155</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> load(cls, config_file: str) -> <span class="string">"Config"</span>:
<span class="line-number">156</span>        <span class="string">""</span><span class="string">"Load configuration <span class="</span>keyword<span class="string">">from</span> JSON file"</span><span class="string">""</span>
<span class="line-number">157</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> Path(config_file).exists():
<span class="line-number">158</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> FileNotFoundError(f<span class="string">"Configuration file <span class="</span>keyword<span class="string">">not</span> found: {config_file}"</span>)</span>
<span class="line-number">159</span>
<span class="line-number">160</span>        <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">161</span>            <span class=<span class="string">"keyword"</span>>with</span> open(config_file, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:
<span class="line-number">162</span>                data = json.<span class="function">load</span>(f)
<span class="line-number">163</span>
</pre>
<h4>Line 166</h4>
<pre>
<span class="line-number">161</span>            <span class=<span class="string">"keyword"</span>>with</span> open(config_file, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:
<span class="line-number">162</span>                data = json.<span class="function">load</span>(f)
<span class="line-number">163</span>
<span class="line-number">164</span>            <span class="comment"># Handle backward compatibility: project_roots -> source_folders</span>
<span class="line-number">165</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"project_roots"</span> <span class=<span class="string">"keyword"</span>>in</span> data <span class=<span class="string">"keyword"</span>>and</span> <span class="string">"source_folders"</span> <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> data:
<span class="line-number">166</span><span class="uncovered">                data[<span class="string">"source_folders"</span>] = data.pop(<span class="string">"project_roots"</span>)</span>
<span class="line-number">167</span>
<span class="line-number">168</span>            <span class="comment"># Validate required fields</span>
<span class="line-number">169</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"source_folders"</span> <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> data:
<span class="line-number">170</span>                <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Configuration must contain <span class="string">'source_folders'</span> field"</span>)
<span class="line-number">171</span>
</pre>
<h4>Line 170</h4>
<pre>
<span class="line-number">165</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"project_roots"</span> <span class=<span class="string">"keyword"</span>>in</span> data <span class=<span class="string">"keyword"</span>>and</span> <span class="string">"source_folders"</span> <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> data:
<span class="line-number">166</span>                data[<span class="string">"source_folders"</span>] = data.pop(<span class="string">"project_roots"</span>)
<span class="line-number">167</span>
<span class="line-number">168</span>            <span class="comment"># Validate required fields</span>
<span class="line-number">169</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"source_folders"</span> <span class=<span class="string">"keyword"</span>>not</span> <span class=<span class="string">"keyword"</span>>in</span> data:
<span class="line-number">170</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"Configuration must contain <span class="string">'source_folders'</span> field"</span>)</span>
<span class="line-number">171</span>
<span class="line-number">172</span>            <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(data[<span class="string">"source_folders"</span>], list):
<span class="line-number">173</span>                <span class=<span class="string">"keyword"</span>>raise</span> ValueError(<span class="string">"<span class="string">'source_folders'</span> must be a list"</span>)
<span class="line-number">174</span>
<span class="line-number">175</span>            <span class=<span class="string">"keyword"</span>>return</span> cls(**data)
</pre>
<h4>Lines 199-200</h4>
<pre>
<span class="line-number">194</span>        }
<span class="line-number">195</span>
<span class="line-number">196</span>        <span class=<span class="string">"keyword"</span>>try</span>:
<span class="line-number">197</span>            <span class=<span class="string">"keyword"</span>>with</span> open(config_file, <span class="string">"w"</span>, encoding=<span class="string">"utf-8"</span>) <span class=<span class="string">"keyword"</span>>as</span> f:
<span class="line-number">198</span>                json.dump(data, f, indent=2, ensure_ascii=<span class=<span class="string">"keyword"</span>>False</span>)
<span class="line-number">199</span><span class="uncovered">        <span class=<span class="string">"keyword"</span>>except</span> Exception <span class=<span class="string">"keyword"</span>>as</span> e:</span>
<span class="line-number">200</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>raise</span> ValueError(</span>
<span class="line-number">201</span>                f<span class="string">"Failed to save configuration to {config_file}: {e}"</span>
<span class="line-number">202</span>            ) <span class=<span class="string">"keyword"</span>>from</span> e
<span class="line-number">203</span>
<span class="line-number">204</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> has_filters(self) -> bool:
<span class="line-number">205</span>        <span class="string">""</span><span class="string">"Check <span class="</span>keyword<span class="string">">if</span> configuration has any filters defined"</span><span class="string">""</span>
</pre>
<h4>Line 260</h4>
<pre>
<span class="line-number">255</span>                filtered_model.enums, self.element_filters[<span class="string">"enums"</span>]
<span class="line-number">256</span>            )
<span class="line-number">257</span>
<span class="line-number">258</span>        <span class="comment"># Filter unions</span>
<span class="line-number">259</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"unions"</span> <span class=<span class="string">"keyword"</span>>in</span> self.element_filters:
<span class="line-number">260</span><span class="uncovered">            filtered_model.unions = self.<span class="function">_filter_dict</span>(</span>
<span class="line-number">261</span>                filtered_model.unions, self.element_filters[<span class="string">"unions"</span>]
<span class="line-number">262</span>            )
<span class="line-number">263</span>
<span class="line-number">264</span>        <span class="comment"># Filter functions</span>
<span class="line-number">265</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class="string">"functions"</span> <span class=<span class="string">"keyword"</span>>in</span> self.element_filters:
</pre>
<h4>Lines 361-362</h4>
<pre>
<span class="line-number">356</span>
<span class="line-number">357</span>            <span class="comment"># Check exclude patterns</span>
<span class="line-number">358</span>            should_exclude = <span class=<span class="string">"keyword"</span>>False</span>
<span class="line-number">359</span>            <span class=<span class="string">"keyword"</span>>for</span> pattern <span class=<span class="string">"keyword"</span>>in</span> exclude_patterns:
<span class="line-number">360</span>                <span class=<span class="string">"keyword"</span>>if</span> pattern.search(name):
<span class="line-number">361</span><span class="uncovered">                    should_exclude = <span class=<span class="string">"keyword"</span>>True</span></span>
<span class="line-number">362</span><span class="uncovered">                    <span class=<span class="string">"keyword"</span>>break</span></span>
<span class="line-number">363</span>            <span class=<span class="string">"keyword"</span>>if</span> should_exclude:
<span class="line-number">364</span>                <span class=<span class="string">"keyword"</span>>continue</span>
<span class="line-number">365</span>
<span class="line-number">366</span>            filtered_items.<span class="function">append</span>(item)
<span class="line-number">367</span>
</pre>
<h4>Line 364</h4>
<pre>
<span class="line-number">359</span>            <span class=<span class="string">"keyword"</span>>for</span> pattern <span class=<span class="string">"keyword"</span>>in</span> exclude_patterns:
<span class="line-number">360</span>                <span class=<span class="string">"keyword"</span>>if</span> pattern.search(name):
<span class="line-number">361</span>                    should_exclude = <span class=<span class="string">"keyword"</span>>True</span>
<span class="line-number">362</span>                    <span class=<span class="string">"keyword"</span>>break</span>
<span class="line-number">363</span>            <span class=<span class="string">"keyword"</span>>if</span> should_exclude:
<span class="line-number">364</span><span class="uncovered">                <span class=<span class="string">"keyword"</span>>continue</span></span>
<span class="line-number">365</span>
<span class="line-number">366</span>            filtered_items.<span class="function">append</span>(item)
<span class="line-number">367</span>
<span class="line-number">368</span>        <span class=<span class="string">"keyword"</span>>return</span> filtered_items
<span class="line-number">369</span>
</pre>
<h4>Line 386</h4>
<pre>
<span class="line-number">381</span>        }
<span class="line-number">382</span>
<span class="line-number">383</span>    <span <span class=<span class="string">"keyword"</span>>class</span>=<span class="string">"keyword"</span>>def</span> __eq__(self, other: Any) -> bool:
<span class="line-number">384</span>        <span class="string">""</span><span class="string">"Check <span class="</span>keyword<span class="string">">if</span> two configurations are equal"</span><span class="string">""</span>
<span class="line-number">385</span>        <span class=<span class="string">"keyword"</span>>if</span> <span class=<span class="string">"keyword"</span>>not</span> isinstance(other, Config):
<span class="line-number">386</span><span class="uncovered">            <span class=<span class="string">"keyword"</span>>return</span> <span class=<span class="string">"keyword"</span>>False</span></span>
<span class="line-number">387</span>
<span class="line-number">388</span>        <span class=<span class="string">"keyword"</span>>return</span> (
<span class="line-number">389</span>            self.project_name == other.project_name
<span class="line-number">390</span>            <span class=<span class="string">"keyword"</span>>and</span> self.source_folders == other.source_folders
<span class="line-number">391</span>            <span class=<span class="string">"keyword"</span>>and</span> self.output_dir == other.output_dir
</pre>
</div>

    <div class="footer">
        <p>Generated by Test Report System</p>
    </div>
</body>
</html>