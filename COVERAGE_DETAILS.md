# Combined Coverage Reports

This project includes comprehensive coverage reporting that combines both summary statistics and detailed per-file coverage analysis in a single, unified report generation process.

## Features

### 1. Per-File Coverage Reports
- **Line-by-line analysis**: See exactly which lines are covered (✓), missing (✗), or excluded (—)
- **Coverage statistics**: Get coverage percentage, total statements, covered lines, and missing lines for each file
- **Missing lines summary**: Grouped ranges of missing lines for easy identification

### 2. Combined Report Generation
All coverage reports are generated in a single step:
- **Summary Statistics**: Overall project coverage metrics
- **Detailed HTML Reports**: Beautiful, interactive reports with syntax highlighting
- **Standard Coverage Reports**: Traditional Python coverage HTML output
- **Export Formats**: XML and JSON for integration with other tools
- **Text Summary**: Plain text summary for quick terminal viewing

## Usage

### Automatic Generation
When you run the test suite with coverage using `./run_tests_with_coverage.sh`, all coverage reports are automatically generated in the `tests/reports/coverage/` directory. This includes:
- Combined index with overall statistics
- Detailed per-file coverage reports
- Standard HTML coverage report
- Text summary
- XML and JSON exports

### Manual Generation

#### Generate Combined Coverage Reports
```bash
python3 generate_combined_coverage.py --output-dir tests/reports/coverage
```

#### Generate with Test Execution
```bash
python3 generate_combined_coverage.py --run-tests --output-dir tests/reports/coverage
```

### Options
- `--output-dir`: Specify the output directory for reports (default: `tests/reports/coverage`)
- `--source-dir`: Specify the source directory to analyze (default: `c_to_plantuml`)
- `--run-tests`: Run tests with coverage before generating reports

## Report Structure

### Combined Coverage Directory (`tests/reports/coverage/`)
- `index.html`: Main dashboard with overall statistics and links to all detailed file reports
- `coverage_summary.txt`: Text-based summary of coverage statistics
- `coverage.xml`: XML format coverage data (for CI/CD integration)
- `coverage.json`: JSON format coverage data (for programmatic access)
- `<filename>.html`: Individual file coverage reports with syntax highlighting and line-by-line analysis
- `htmlcov/`: Standard Python coverage HTML report directory
  - `index.html`: Traditional coverage report interface

## Example Output

### HTML Report Features
- **Coverage Bar**: Visual representation of coverage percentage
- **File List**: Sortable and filterable list of all analyzed files
- **Coverage Filters**: Quick filters for low (<60%), medium (60-80%), and high (>80%) coverage
- **Line Status**: Color-coded lines showing covered (green), missing (red), and excluded (gray)

### Text Report Format
```
Coverage Report for: c_to_plantuml/utils.py
Generated: 2025-07-25 21:11:25
================================================================================

Summary:
  Total statements: 68
  Covered lines: 38
  Missing lines: 30
  Excluded lines: 0
  Coverage: 55.9%

Line-by-Line Analysis:
--------------------------------------------------------------------------------
Status | Line # | Code
--------------------------------------------------------------------------------
       |      1 | #!/usr/bin/env python3
✓ COV  |      2 | """
       |      3 | Utility functions for C to PlantUML converter
...
```

## Integration with CI/CD

The detailed coverage reports are automatically generated as part of the GitHub Actions workflow and can be accessed through the GitHub Pages deployment.

## Benefits

1. **Identify untested code**: Quickly see which specific lines need test coverage
2. **Track coverage improvements**: Monitor how coverage changes over time
3. **Code review assistance**: Use reports during code reviews to ensure new code is tested
4. **Test planning**: Identify areas that need more comprehensive testing
5. **Quality metrics**: Get detailed metrics for each module and the overall project

## Technical Details

The coverage report generators use the Python `coverage` module's JSON output to analyze which lines were executed during tests. The reports are generated by:

1. Running tests with coverage enabled
2. Exporting coverage data to JSON format
3. Parsing the JSON to extract line-level coverage information
4. Generating formatted reports with visual indicators

The HTML reports include basic syntax highlighting for Python code to improve readability.